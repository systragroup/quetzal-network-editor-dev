"use strict";(self.webpackChunkquetzal_network_editor=self.webpackChunkquetzal_network_editor||[]).push([[491],{76763:(t,e,n)=>{n.d(e,{Z:()=>l});var a=n(87537),i=n.n(a),s=n(23645),r=n.n(s)()(i());r.push([t.id,".card[data-v-a9a594d0]{height:90%;width:80%;padding:2.5rem 2rem 2.5rem 2rem;margin-right:3rem}.row[data-v-a9a594d0]{height:100%;justify-content:center}.col[data-v-a9a594d0]{max-height:100%;align-items:center}.card button[data-v-a9a594d0]{margin-top:0px}.title[data-v-a9a594d0]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:3.5em;color:#b5e0d6 !important;font-weight:bold}.subtitle[data-v-a9a594d0]{font-size:2em;color:var(--v-secondary-dark);font-weight:bold;margin:10px;margin-left:0px}.card button[data-v-a9a594d0]{margin-top:0px}.background[data-v-a9a594d0]{background-color:var(--v-background-base)}.params-row[data-v-a9a594d0]{display:flex;align-items:center;margin-right:1rem;padding-top:.5rem;justify-content:flex-start;gap:1rem}.list[data-v-a9a594d0]{height:80%;margin-top:1rem;overflow-y:auto;overflow-x:hidden;border-top:1px solid var(--v-background-lighten3)}.list-row[data-v-a9a594d0]{display:flex;padding-left:0;height:3rem;align-items:center;justify-content:flex-start;border-bottom:1px solid var(--v-background-lighten3)}.list ul[data-v-a9a594d0]{height:3rem;transition:background-color .3s}.list ul[data-v-a9a594d0]:hover{background-color:var(--v-background-lighten4)}.list-item-small[data-v-a9a594d0]{flex:0 0 8%;margin:4px}.list-item-medium[data-v-a9a594d0]{flex:0 0 18%;margin-right:2px}.list-item-large[data-v-a9a594d0]{flex:0 0 22%;margin:4px}","",{version:3,sources:["webpack://./src/components/microservices/GTFSZipImporter.vue"],names:[],mappings:"AAGA,uBACE,UAAA,CACA,SAAA,CACA,+BAAA,CACA,iBAAA,CAGF,sBACE,WAAA,CACA,sBAAA,CAEF,sBACE,eAAA,CACA,kBAAA,CAEF,8BACE,cAAA,CAEF,wBACE,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CACA,wBAAA,CACA,gBAAA,CAEF,2BACE,aAAA,CACA,6BAAA,CACA,gBAAA,CACA,WAAA,CACA,eAAA,CAEF,8BACE,cAAA,CAEF,6BACE,yCAAA,CAGF,6BAEE,YAAA,CACA,kBAAA,CACA,iBAAA,CACA,iBAAA,CACA,0BAAA,CACA,QAAA,CAGF,uBACE,UAAA,CAEA,eAAA,CACA,eAAA,CACA,iBAAA,CACA,iDAAA,CAGF,2BAEE,YAAA,CACA,cAAA,CACA,WAAA,CACA,kBAAA,CACA,0BAAA,CACA,oDAAA,CAGF,0BACE,WAAA,CACA,+BAAA,CAGF,gCACE,6CAAA,CAGF,kCAEE,WAAA,CACA,UAAA,CAGF,mCAEE,YAAA,CACA,gBAAA,CAGF,kCAEE,YAAA,CACA,UAAA",sourcesContent:['@import "@scss/variables.scss";\n\n\n.card {\n  height: 90%;\n  width: 80%;\n  padding: 2.5rem 2rem 2.5rem 2rem;\n  margin-right: 3rem;\n\n}\n.row {\n  height: 100%;\n  justify-content: center;\n}\n.col {\n  max-height: 100%;\n  align-items: center;\n}\n.card button {\n  margin-top: 0px;\n}\n.title {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 3.5em;\n  color: $primary !important;\n  font-weight: bold;\n}\n.subtitle {\n  font-size: 2em;\n  color:var(--v-secondary-dark);\n  font-weight: bold;\n  margin: 10px;\n  margin-left: 0px;\n}\n.card button {\n  margin-top: 0px;\n}\n.background {\n  background-color:var(--v-background-base);\n}\n\n.params-row {\n  /* Add individual list item styles here */\n  display: flex; /* Use flexbox layout for each list item */\n  align-items: center;\n  margin-right:1rem;\n  padding-top: 0.5rem;\n  justify-content:flex-start;\n  gap: 1rem;\n}\n\n.list {\n  height:80%;\n  //border: 1px solid red;\n  margin-top:1rem;\n  overflow-y: auto;\n  overflow-x: hidden;\n  border-top: 1px solid var(--v-background-lighten3);\n\n}\n.list-row {\n  /* Add individual list item styles here */\n  display: flex; /* Use flexbox layout for each list item */\n  padding-left:0;\n  height:3rem;\n  align-items: center;\n  justify-content:flex-start;\n  border-bottom: 1px solid var(--v-background-lighten3);\n}\n\n.list ul {\n  height: 3rem;\n  transition: background-color 0.3s; /* Add a smooth transition effect */\n}\n\n.list ul:hover {\n  background-color: var(--v-background-lighten4); /* Change the background color on hover */\n}\n\n.list-item-small {\n  /* Add individual list item styles here */\n  flex: 0 0 8%;\n  margin:4px;\n}\n\n.list-item-medium {\n  /* Add individual list item styles here */\n  flex: 0 0 18%;\n  margin-right:2px;\n}\n\n.list-item-large {\n  /* Add individual list item styles here */\n  flex: 0 0 22%;\n  margin:4px;\n}\n'],sourceRoot:""}]);const l=r},18491:(t,e,n)=>{n.r(e),n.d(e,{default:()=>w});var a=function(){var t=this,e=t._self._c;return e("v-row",{staticClass:"ma-0 pa-2 background"},[e("input",{ref:"zipInput",staticStyle:{display:"none"},attrs:{id:"zip-input",type:"file",accept:".zip",multiple:"multiple"},on:{change:t.readZip}}),t._v(" "),e("v-col",{staticClass:"d-flex flex-column"},[e("v-card",{staticClass:"card"},[e("v-card-title",{staticClass:"subtitle"},[t._v("\n        "+t._s(t.$gettext("Available GTFS"))+"\n      ")]),t._v(" "),e("v-card-subtitle",[t._v("\n        "+t._s(t.$gettext("import GTFS from local computer"))+"\n      ")]),t._v(" "),e("v-btn",{attrs:{disabled:t.running},on:{click:t.uploadGTFS}},[e("v-icon",{staticStyle:{"margin-right":"10px"},attrs:{small:""}},[t._v("\n          fa-solid fa-file-archive\n        ")]),t._v("\n        "+t._s(t.$gettext("GTFS"))+"\n      ")],1),t._v(" "),e("v-btn",{attrs:{loading:t.running,disabled:t.running||0==t.UploadedGTFS.length,color:"success"},on:{click:t.importGTFS}},[e("v-icon",{staticStyle:{"margin-right":"10px"},attrs:{small:""}},[t._v("\n          fa-solid fa-play\n        ")]),t._v("\n        "+t._s(t.$gettext("Download"))+"\n      ")],1),t._v(" "),e("v-card-subtitle",[t.error?e("v-alert",{attrs:{dense:"",outlined:"",text:"",type:"error"}},[t._v("\n          "+t._s(t.$gettext("There as been an error while importing OSM network.           Please try again. If the problem persist, contact us."))+"\n          "),t._l(Object.keys(t.errorMessage),(function(n){return e("p",{key:n},[e("b",[t._v(t._s(n)+": ")]),t._v(t._s(t.errorMessage[n])+"\n          ")])}))],2):t._e()],1),t._v(" "),e("div",{staticClass:"params-row"},t._l(t.parameters,(function(n,a){return e("div",{key:a},[void 0===n.items?e("v-text-field",{attrs:{type:n.type,label:t.$gettext(n.text),suffix:n.units,hint:t.showHint?t.$gettext(n.hint):"","persistent-hint":t.showHint,rules:n.rules.map((e=>t.rules[e])),required:""},on:{wheel:()=>{}},model:{value:n.value,callback:function(e){t.$set(n,"value",e)},expression:"item.value"}}):e("v-select",{attrs:{type:n.type,items:n.items,label:t.$gettext(n.text),suffix:n.units,hint:t.showHint?t.$gettext(n.hint):"","persistent-hint":t.showHint,rules:n.rules.map((e=>t.rules[e])),required:""},on:{wheel:()=>{}},model:{value:n.value,callback:function(e){t.$set(n,"value",e)},expression:"item.value"}})],1)})),0),t._v(" "),e("div",{staticClass:"list"},[e("li",{staticClass:"list-row bold"},[e("span",{staticClass:"list-item-small"}),t._v(" "),e("span",{staticClass:"list-item-large"},[t._v(t._s(t.$gettext("name"))+" ")]),t._v(" "),e("span",{staticClass:"list-item-medium"},[t._v(t._s(t.$gettext("from"))+" ")]),t._v(" "),e("span",{staticClass:"list-item-medium"},[t._v(t._s(t.$gettext("to"))+" ")]),t._v(" "),e("span",{staticClass:"list-item-medium"},[t._v(t._s(t.$gettext("selected date")))]),t._v(" "),e("span",{staticClass:"list-item-small"},[t._v(" "+t._s(t.$gettext("status")))])]),t._v(" "),t._l(t.UploadedGTFS,(function(n,a){return e("ul",{key:a,staticClass:"list-row"},[e("span",{staticClass:"list-item-small"},[t._v(t._s(a)+" ")]),t._v(" "),e("span",{staticClass:"list-item-large"},[t._v(t._s(n.name)+" ")]),t._v(" "),e("span",{staticClass:"list-item-medium"},[t._v(t._s(n.minDate)+" ")]),t._v(" "),e("span",{staticClass:"list-item-medium"},[t._v(t._s(n.maxDate)+" ")]),t._v(" "),e("span",{staticClass:"list-item-medium"},[e("DatePicker",{attrs:{from:n.minDate,to:n.maxDate},model:{value:n.date,callback:function(e){t.$set(n,"date",e)},expression:"item.date"}})],1),t._v(" "),e("span",{staticClass:"list-item-small"},[n.progress<100?e("v-progress-circular",{attrs:{absolute:"",color:"primary",value:n.progress}}):e("v-icon",[t._v("fas fa-check")])],1)])}))],2)],1)],1),t._v(" "),e("v-dialog",{attrs:{persistent:"","max-width":"500"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.applyOverwriteDialog.apply(null,arguments)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.showOverwriteDialog=!1}]},model:{value:t.showOverwriteDialog,callback:function(e){t.showOverwriteDialog=e},expression:"showOverwriteDialog"}},[e("v-card",[e("v-card-title",{staticClass:"text-h5"},[t._v("\n        "+t._s(t.$gettext("Overwrite current road network ?"))+"\n      ")]),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("v-btn",{attrs:{color:"regular"},on:{click:function(e){t.showOverwriteDialog=!t.showOverwriteDialog}}},[t._v("\n          "+t._s(t.$gettext("No"))+"\n        ")]),t._v(" "),e("v-btn",{attrs:{color:"primary"},on:{click:t.applyOverwriteDialog}},[t._v("\n          "+t._s(t.$gettext("Yes"))+"\n        ")])],1)],1)],1)],1)};a._withStripped=!0;var i=n(75997),s=n(34221),r=n(76955),l=function(){var t=this,e=t._self._c;return e("v-menu",{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function({on:n,attrs:a}){return[e("v-text-field",t._g(t._b({attrs:{value:t.isoDate,"persistent-hint":"",readonly:""}},"v-text-field",a,!1),n))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[t._v(" "),e("v-date-picker",{attrs:{max:t.dateMax,min:t.dateMin,"no-title":""},on:{input:function(e){t.menu=!1}},model:{value:t.isoDate,callback:function(e){t.isoDate=e},expression:"isoDate"}})],1)};l._withStripped=!0;const o={name:"DatePicker",components:{},model:{prop:"date",event:"update-date"},props:["date","from","to"],events:["update-date"],data:()=>({isoDate:null,dateMax:null,dateMin:null,menu:!1}),computed:{},watch:{isoDate(t){this.$emit("update-date",this.parseOutput(t))}},mounted(){this.isoDate=this.parseInput(String(this.date)),this.dateMin=this.parseInput(String(this.from)),this.dateMax=this.parseInput(String(this.to)),console.log(this.dateMin)},methods:{parseInput(t){if(t)return t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8)},parseOutput:t=>t.replaceAll("-","")}};var d=n(51900);const A={name:"GTFSWebImporter",components:{DatePicker:(0,d.Z)(o,l,[],!1,null,null,null).exports},data(){return{showOverwriteDialog:!1,poly:null,nodes:{},gtfsList:[],checkall:!1,showHint:!1,parameters:[{name:"start_time",text:"start time",value:"6:00:00",type:"String",units:"",hint:"Start Time to restrict the GTFS in a period",rules:["required","timeRule"]},{name:"end_time",text:"end time",value:"8:59:00",type:"String",units:"",hint:"End Time to restrict the GTFS in a period",rules:["required","timeRule"]}],re:/^(0?[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/,rules:{required:t=>!!t||"Required",timeRule:t=>this.re.test(t)||"invalid date time"}}},computed:{linksIsEmpty(){return this.$store.getters.linksIsEmpty},UploadedGTFS(){return this.$store.getters["runGTFS/UploadedGTFS"]},callID(){return this.$store.getters["runGTFS/callID"]},running(){return this.$store.getters["runGTFS/running"]},error(){return this.$store.getters["runGTFS/error"]},errorMessage(){return this.$store.getters["runGTFS/errorMessage"]}},methods:{uploadGTFS(){this.$refs.zipInput.click(),document.getElementById("zip-input").value=""},async readZip(t){try{this.$store.commit("changeLoading",!0);const e=t.target.files;if(!e.length)return void this.$store.commit("changeLoading",!1);for(const t of e){const e=await(0,r.sn)(t),n=e.reduce(((t,e)=>e.start_date<t?e.start_date:t),e[0].start_date),a=e.reduce(((t,e)=>e.end_date>t?e.end_date:t),e[0].end_date),i={content:t,info:{name:t.name,minDate:n,maxDate:a,date:n,progress:0}};await this.$store.dispatch("runGTFS/addGTFS",i)}this.$store.commit("changeLoading",!1)}catch(t){this.$store.commit("changeLoading",!1),this.$store.commit("changeAlert",t)}},importGTFS(){if(this.linksIsEmpty){const t={files:this.UploadedGTFS.map((t=>t.name)),dates:this.UploadedGTFS.map((t=>t.date))};this.parameters.forEach((e=>{t[e.name]=e.value})),this.$store.dispatch("runGTFS/startExecution",t)}else this.showOverwriteDialog=!0},applyOverwriteDialog(){this.$store.commit("loadLinks",i.Z),this.$store.commit("loadNodes",s.Z),this.showOverwriteDialog=!1,this.importGTFS()}}};var c=n(93379),m=n.n(c),u=n(7795),p=n.n(u),g=n(90569),v=n.n(g),h=n(3565),C=n.n(h),f=n(19216),x=n.n(f),_=n(44589),b=n.n(_),y=n(76763),k={};k.styleTagTransform=b(),k.setAttributes=C(),k.insert=v().bind(null,"head"),k.domAPI=p(),k.insertStyleElement=x(),m()(y.Z,k),y.Z&&y.Z.locals&&y.Z.locals;const w=(0,d.Z)(A,a,[],!1,null,"a9a594d0",null).exports}}]);
//# sourceMappingURL=491.build.js.map