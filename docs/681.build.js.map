{"version":3,"file":"681.build.js","mappings":"6JAAA,IAAIA,EAAS,WACX,IAAIC,EAAMC,KACRC,EAAKF,EAAIG,MAAMD,GACjB,OAAOA,EACL,UACA,CACEA,EACE,kBACAF,EAAII,GACF,CACEC,MAAO,CACL,YAAa,cACbC,OAAQ,CACNC,KAAM,UACNC,KAAMR,EAAIS,OAAOC,QAAQC,YACzBC,OAAQ,EACRC,UAAW,SAEb,WAAY,cACZC,MAAO,CACLP,KAAM,OACNQ,QAAS,EACTC,MAAO,CACL,aAAc,CACZ,OACA,CAAC,UAAWhB,EAAIiB,YAAY,GAC5B,UACA,WAEF,aAAc,CACZ,OACA,CAAC,UAAW,CAAC,gBAAiB,UAAU,GACxC,GACA,GAEF,YAAa,CACX,OACA,CAAC,UAAW,CAAC,gBAAiB,UAAU,GACxC,EACA,MAKRC,GAAI,CACFC,MAAOnB,EAAIoB,YACXC,UAAWrB,EAAIsB,SACfC,WAAYvB,EAAIwB,YAGpBxB,EAAIiB,WAAa,CAAC,EAAI,CAAEQ,YAAazB,EAAI0B,kBAG7C1B,EAAI2B,GAAG,KACPzB,EAAG,gBAAiB,CAClBG,MAAO,CACL,YAAa,cACbE,KAAM,SACND,OAAQ,cACR,WAAY,cACZQ,MAAO,CACLP,KAAM,SACNQ,QAAS,EACTa,OAAQ,CACN,mBAAoB,OACpB,iBAAkB,GAClB,yBAAyB,EACzB,aAAc,QACd,YAAa,GACb,cAAe,IAEjBZ,MAAO,CACL,aAAc,CACZ,OACA,CAAC,UAAWhB,EAAIiB,YAAY,GAC5B,UACA,gBAMVjB,EAAI2B,GAAG,KACPzB,EACE,kBACAF,EAAII,GACF,CACEC,MAAO,CACL,YAAa,cACbC,OAAQ,CACNC,KAAM,UACNC,KAAMR,EAAIS,OAAOC,QAAQmB,YACzBjB,OAAQ,EACRC,UAAW,SAEb,WAAY,cACZC,MAAO,CACLgB,aAAa,EACbvB,KAAM,SACNQ,QAAS,EACTC,MAAO,CACL,eAAgB,UAChB,gBAAiB,CACf,OACA,CAAC,UAAW,CAAC,gBAAiB,UAAU,GACxC,GACA,GAEF,cAAe,CACb,OACA,CAAC,UAAW,CAAC,gBAAiB,UAAU,GACxC,GACA,MAKRE,GAAI,CACFG,UAAWrB,EAAIsB,SACfC,WAAYvB,EAAIwB,UAChBO,UAAW/B,EAAIgC,WAGnBhC,EAAIiB,WACA,CAAC,EACD,CAAEE,MAAOnB,EAAIoB,YAAaK,YAAazB,EAAIiC,mBAGnDjC,EAAI2B,GAAG,KACPzB,EAAG,kBAAmB,CACpBG,MAAO,CACL,YAAa,cACbC,OAAQ,CACNC,KAAM,UACNC,KAAMR,EAAIkC,YACVtB,OAAQ,EACRC,UAAW,SAEb,WAAY,cACZC,MAAO,CACLgB,aAAa,EACbvB,KAAM,SACNQ,QAAS,EACTC,MAAO,CACL,eAAgB,UAChB,iBAAkB,GAClB,gBAAiB,CACf,OACA,CAAC,UAAW,CAAC,gBAAiB,UAAU,GACxC,GACA,GAEF,cAAe,CACb,OACA,CAAC,UAAW,CAAC,gBAAiB,UAAU,GACxC,GACA,GAEF,sBAAuB,UACvB,sBAAuB,KAI7BE,GAAI,CACFC,MAAOnB,EAAIoB,YACXC,UAAWrB,EAAIsB,SACfC,WAAYvB,EAAIwB,UAChBO,UAAW/B,EAAIgC,SACfP,YAAazB,EAAIiC,mBAGrBjC,EAAI2B,GAAG,KACPzB,EACE,WACA,CACEG,MAAO,CACL,gBAAgB,EAChB8B,OAAQnC,EAAIoC,YAAYD,OACxBE,YAAarC,EAAIoC,YAAYC,aAE/BnB,GAAI,CACFoB,MAAO,SAAUC,GACfvC,EAAIoC,YAAYD,QAAS,CAC3B,IAGJ,CACEjC,EAAG,OAAQ,CACTA,EAAG,KAAM,CAACF,EAAI2B,GAAG3B,EAAIwC,GAAGxC,EAAIoC,YAAYK,YACxCzC,EAAI2B,GAAG,KACPzB,EAAG,MACHF,EAAI2B,GACF,WACE3B,EAAIwC,GAC6B,eAA/BxC,EAAI0C,gBAAgBC,QAChB3C,EAAI4C,SAAS,4BACb5C,EAAI4C,SAAS,4BAEnB,YAEJ1C,EAAG,MACHF,EAAI2B,GACF,WACE3B,EAAIwC,GAC6B,eAA/BxC,EAAI0C,gBAAgBC,QAChB3C,EAAI4C,SAAS,kCACb5C,EAAI4C,SAAS,iCAEnB,cAKV5C,EAAI2B,GAAG,KACPzB,EACE,WACA,CACEG,MAAO,CACL,gBAAgB,EAChB8B,OAAQnC,EAAI6C,YAAYV,OACxBE,YAAarC,EAAI6C,YAAYR,aAE/BnB,GAAI,CACFoB,MAAO,SAAUC,GACfvC,EAAI6C,YAAYV,QAAS,CAC3B,IAGJ,CACEjC,EACE,OACA,CACEgB,GAAI,CACFK,WAAY,SAAUgB,GACpBvC,EAAI6C,YAAYV,QAAS,CAC3B,IAGJ,CACEjC,EACE,SACA,CAAEG,MAAO,CAAEyC,MAAO,GAAIC,KAAM,KAC5B,CACE7C,EACE,oBACAF,EAAIgD,GAAGhD,EAAI6C,YAAYI,SAAS,SAAUC,GACxC,OAAOhD,EACL,cACA,CAAEiD,IAAKD,EAAOE,IACd,CACElD,EACE,sBACA,CACEA,EACE,QACA,CACEG,MAAO,CAAEgD,SAAU,GAAIC,MAAO,IAC9BpC,GAAI,CACFC,MAAO,SAAUoB,GACf,OAAOvC,EAAIuD,YAAY,CACrBL,OAAQA,EACRM,QAASxD,EAAI6C,YAAYW,QACzBnB,YACErC,EAAI6C,YAAYR,aAEtB,IAGJ,CACErC,EAAI2B,GACF,qBACE3B,EAAIwC,GAAGxC,EAAI4C,SAASM,IACpB,uBAKV,IAGJ,EAEJ,IACA,IAGJ,IAGJ,MAKR,EAEJ,EAEAnD,EAAO0D,eAAgB,E,cCxSvB,MCF+H,EDI/H,CACEC,KAAM,cACNC,WAAY,CACVC,SAAQ,KACRC,cAAa,KACbC,gBAAe,MAEjBC,MAAO,CAAC,MAAO,cACfC,OAAQ,CAAC,eAAgB,UAAW,YACpCxD,KAAK,KACI,CACLyD,gBAAiB,KACjBvB,eAAgB,KAChBwB,cAAc,EACdC,cAAc,EACdC,UAAU,EACVhC,YAAa,CACXC,YAAa,CAAC,EAAG,GACjBF,QAAQ,EACRM,QAAS,MAEXI,YAAa,CACXR,YAAa,CAAC,EAAG,GACjBF,QAAQ,EACRc,QAAS,GACTO,QAAS,KACTjD,KAAM,QAIZ8D,SAAU,CACRnC,cAAiB,OAAOjC,KAAKgB,WAAahB,KAAKQ,OAAOC,QAAQwB,YAAcjC,KAAKQ,OAAOC,QAAQ4D,WAAY,GAG9GC,MAAO,CAEP,EACAC,UACA,EAEAC,QAAS,CACPrD,YAAasD,GACX,GAA4B,OAAxBzE,KAAKyC,eAAyB,CAEhC,MAAMiC,EAAW1E,KAAK2E,IAAIC,oBAAoB5E,KAAKyC,eAAeC,SAIlE,GAHA1C,KAAKgE,gBAAkBU,EAASG,QAAOC,GAAQA,EAAK3B,KAAOnD,KAAKyC,eAAeU,KAAI,GAGtD,OAAzBnD,KAAKgE,iBAC6B,gBAAhChE,KAAKyC,eAAeC,QAA2B,CACjD,MAAMO,EAASjD,KAAKgB,WAAa,oBAAsB,kBACjDE,EAAQ,CACZ8C,gBAAiBhE,KAAKgE,gBACtBf,OAAQA,EACR8B,OAAQN,EAAMO,YAAYD,QAE5B/E,KAAKiF,MAAM,eAAgB/D,EAC7B,CAEJ,CACF,EACAG,SAAUoD,GACoB,OAAxBzE,KAAKyC,gBAA2D,gBAAhCzC,KAAKyC,eAAeC,UACtD1C,KAAK2E,IAAIO,YAAYC,MAAMC,OAAS,UACR,OAAxBpF,KAAKyC,gBACPzC,KAAK2E,IAAIU,gBACP,CAAEhF,OAAQL,KAAKyC,eAAeC,QAASS,GAAInD,KAAKyC,eAAeU,IAC/D,CAAEmC,OAAO,IAGbtF,KAAKyC,eAAiB,CAAEC,QAAS+B,EAAM/B,QAASS,GAAIsB,EAAMO,YAAYN,SAAS,GAAGvB,IAClFnD,KAAK2E,IAAIU,gBACP,CAAEhF,OAAQL,KAAKyC,eAAeC,QAASS,GAAInD,KAAKyC,eAAeU,IAC/D,CAAEmC,OAAO,KAENtF,KAAKiE,cAAgBjE,KAAKgB,aAC7BhB,KAAKmC,YAAYC,YAAc,CAACqC,EAAMO,YAAYD,OAAOQ,IACvDd,EAAMO,YAAYD,OAAOS,KAE3BxF,KAAKmC,YAAYK,QAAUxC,KAAKyC,eAAeU,GAC/CnD,KAAKmC,YAAYD,QAAS,IAG9BlC,KAAKiF,MAAM,UAAW,CAAEQ,WAAYzF,KAAKyC,eAAeU,IAC1D,EACA5B,UAAWkD,GACmB,OAAxBzE,KAAKyC,iBAED,CAAC,cAAe,eAAeiD,SAAS1F,KAAKyC,eAAeC,UAA+B,gBAAnB+B,GAAO/B,UAE/E1C,KAAKkE,cACPlE,KAAKmE,UAAW,EAChBnE,KAAK4C,YAAYV,QAAS,IAG1BlC,KAAK2E,IAAIO,YAAYC,MAAMC,OAAS,GACpCpF,KAAKmC,YAAYD,QAAS,EAC1BlC,KAAK2E,IAAIU,gBACP,CAAEhF,OAAQL,KAAKyC,eAAeC,QAASS,GAAInD,KAAKyC,eAAeU,IAC/D,CAAEmC,OAAO,IAEXtF,KAAKyC,eAAiB,KACtBzC,KAAKiF,MAAM,WAAYR,KAI/B,EACAzC,gBAAiByC,GACf,GAAIzE,KAAKmC,YAAYD,QAA2C,gBAAjClC,KAAKyC,gBAAgBC,QAA2B,CAC7E1C,KAAK4C,YAAYR,YAAc,CAACqC,EAAMO,YAAYD,OAAOQ,IACvDd,EAAMO,YAAYD,OAAOS,KAE3BxF,KAAK4C,YAAYV,QAAS,EAE1BlC,KAAK4C,YAAYtC,KAAO,OACxB,MAAMoE,EAAW1E,KAAK2E,IAAIC,oBAAoB5E,KAAKyC,eAAeC,SAClE1C,KAAK4C,YAAYW,QAAUmB,EAASG,QAAOC,GAAQA,EAAK3B,KAAOnD,KAAKyC,eAAeU,KAAI,GAEvF,MAAMwC,EAAe3F,KAAK4C,YAAYW,QAAQqC,WAAWC,MAErDF,IAAiB3F,KAAKQ,OAAOC,QAAQqF,aAM9BH,IAAiB3F,KAAKQ,OAAOC,QAAQsF,WAL9C/F,KAAK4C,YAAYI,QACjB,CACW,iBACA,eASXhD,KAAK4C,YAAYI,QAChB,CACW,iBACA,kBACA,iBACA,cAGhB,MAAO,GAAqC,gBAAjChD,KAAKyC,gBAAgBC,QAA2B,CACzD,MAAMgC,EAAW1E,KAAK2E,IAAIC,oBAAoB5E,KAAKyC,eAAeC,SAClE1C,KAAKgE,gBAAkBU,EAASG,QAAOC,GAAQA,EAAK3B,KAAOnD,KAAKyC,eAAeU,KAC/E,MAAMjC,EAAQ,CACZ8C,gBAAiBhE,KAAKgE,gBAAgB,GACtCf,OAAQ,gBACR8B,OAAQ,MAEV/E,KAAKiF,MAAM,eAAgB/D,EAC7B,CACF,EAEAO,eAAgBgD,GACd,GAAoC,gBAAhCzE,KAAKyC,eAAeC,QAA2B,CACjD,MAAMgC,EAAW1E,KAAK2E,IAAIC,oBAAoB5E,KAAKyC,eAAeC,SAClE1C,KAAKgE,gBAAkBU,EAASG,QAAOC,GAAQA,EAAK3B,KAAOnD,KAAKyC,eAAeU,KAAI,GACnF,MAAMjC,EAAQ,CACZ8C,gBAAiBhE,KAAKgE,gBACtBf,OAAQ,iBACR8B,OAAQN,EAAMO,YAAYD,OAC1BiB,WAAW,GAEbhG,KAAKiF,MAAM,eAAgB/D,EAC7B,CACF,EAEAoC,YAAamB,GACX,MAAMvD,EAAQ,CACZ8C,gBAAiBS,EAAMlB,QACvBN,OAAQwB,EAAMxB,OACd8B,OAAQN,EAAMrC,aAEhBpC,KAAKiF,MAAM,eAAgB/D,GAE3BlB,KAAK4C,YAAYV,QAAS,EAC1BlC,KAAK4C,YAAYtC,KAAO,IAC1B,EAEAyB,SAAU0C,GACR,GAA+C,IAA3CA,EAAMO,YAAYiB,cAAcC,OACpC,CAAC,cAAe,eAAeR,SAAS1F,KAAKyC,eAAeC,SAAU,CACpE+B,EAAMO,YAAYmB,iBAClBnG,KAAK2E,IAAIO,YAAYC,MAAMC,OAAS,OAEpCpF,KAAKkE,cAAe,EAEpB,MAAMQ,EAAW1E,KAAK2E,IAAIC,oBAAoB5E,KAAKyC,eAAeC,SAClE1C,KAAKgE,gBAAkBU,EAASG,QAAOC,GAAQA,EAAK3B,KAAOnD,KAAKyC,eAAeU,KAAI,GAGnFnD,KAAKiE,cAAe,EACpBjE,KAAKmC,YAAYD,QAAS,EAE1BlC,KAAK2E,IAAI1D,GAAG,YAAajB,KAAKoG,QAC9BpG,KAAK2E,IAAI1D,GAAG,UAAWjB,KAAKqG,eAC9B,CACF,EACAD,OAAQ3B,GAGN,GAAIzE,KAAK2E,IAAI2B,UAAYtG,KAAKmE,UAAYnE,KAAKgE,gBAAiB,CAC9D,MAAM9C,EAAQ,CACZ8C,gBAAiBhE,KAAKgE,gBACtBf,OAAQ,KACR8B,OAAQwB,OAAOC,OAAO/B,EAAMM,SAEM,gBAAhC/E,KAAKyC,eAAeC,SACtBxB,EAAM+B,OAAS,cACfjD,KAAKiF,MAAM,eAAgB/D,KAE3BA,EAAM+B,OAAS,YACfjD,KAAKiF,MAAM,eAAgB/D,GAE/B,CACF,EAEAmF,eAAgB5B,GAEdzE,KAAK2E,IAAIO,YAAYC,MAAMC,OAAS,UACpCpF,KAAK2E,IAAI8B,IAAI,YAAazG,KAAKoG,QAE/BpG,KAAKkE,cAAe,EACpBlE,KAAKmE,UAAW,EAChBnE,KAAKiE,cAAe,EAEpBjE,KAAKuB,YACLvB,KAAK2E,IAAI8B,IAAI,UAAWzG,KAAKqG,eAG/B,IExNJ,GAXgB,E,QAAA,GACd,EACAvG,EHgSoB,IG9RpB,EACA,KACA,WACA,MAI8B,O","sources":["webpack://quetzal-network-editor/./src/components/EditorLinks.vue?aea1","webpack://quetzal-network-editor/src/components/EditorLinks.vue","webpack://quetzal-network-editor/./src/components/EditorLinks.vue?80e2","webpack://quetzal-network-editor/./src/components/EditorLinks.vue"],"sourcesContent":["var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\n    \"section\",\n    [\n      _c(\n        \"MglGeojsonLayer\",\n        _vm._g(\n          {\n            attrs: {\n              \"source-id\": \"editorLinks\",\n              source: {\n                type: \"geojson\",\n                data: _vm.$store.getters.editorLinks,\n                buffer: 0,\n                promoteId: \"index\",\n              },\n              \"layer-id\": \"editorLinks\",\n              layer: {\n                type: \"line\",\n                minzoom: 2,\n                paint: {\n                  \"line-color\": [\n                    \"case\",\n                    [\"boolean\", _vm.anchorMode, false],\n                    \"#B5E0D6\",\n                    \"#7EBAAC\",\n                  ],\n                  \"line-width\": [\n                    \"case\",\n                    [\"boolean\", [\"feature-state\", \"hover\"], false],\n                    12,\n                    5,\n                  ],\n                  \"line-blur\": [\n                    \"case\",\n                    [\"boolean\", [\"feature-state\", \"hover\"], false],\n                    6,\n                    0,\n                  ],\n                },\n              },\n            },\n            on: {\n              click: _vm.selectClick,\n              mouseover: _vm.onCursor,\n              mouseleave: _vm.offCursor,\n            },\n          },\n          _vm.anchorMode ? {} : { contextmenu: _vm.linkRightClick }\n        )\n      ),\n      _vm._v(\" \"),\n      _c(\"MglImageLayer\", {\n        attrs: {\n          \"source-id\": \"editorLinks\",\n          type: \"symbol\",\n          source: \"editorLinks\",\n          \"layer-id\": \"arrow-layer\",\n          layer: {\n            type: \"symbol\",\n            minzoom: 5,\n            layout: {\n              \"symbol-placement\": \"line\",\n              \"symbol-spacing\": 30,\n              \"icon-ignore-placement\": true,\n              \"icon-image\": \"arrow\",\n              \"icon-size\": 0.5,\n              \"icon-rotate\": 90,\n            },\n            paint: {\n              \"icon-color\": [\n                \"case\",\n                [\"boolean\", _vm.anchorMode, false],\n                \"#B5E0D6\",\n                \"#7EBAAC\",\n              ],\n            },\n          },\n        },\n      }),\n      _vm._v(\" \"),\n      _c(\n        \"MglGeojsonLayer\",\n        _vm._g(\n          {\n            attrs: {\n              \"source-id\": \"editorNodes\",\n              source: {\n                type: \"geojson\",\n                data: _vm.$store.getters.editorNodes,\n                buffer: 0,\n                promoteId: \"index\",\n              },\n              \"layer-id\": \"editorNodes\",\n              layer: {\n                interactive: true,\n                type: \"circle\",\n                minzoom: 2,\n                paint: {\n                  \"circle-color\": \"#2C3E4E\",\n                  \"circle-radius\": [\n                    \"case\",\n                    [\"boolean\", [\"feature-state\", \"hover\"], false],\n                    16,\n                    8,\n                  ],\n                  \"circle-blur\": [\n                    \"case\",\n                    [\"boolean\", [\"feature-state\", \"hover\"], false],\n                    0.3,\n                    0,\n                  ],\n                },\n              },\n            },\n            on: {\n              mouseover: _vm.onCursor,\n              mouseleave: _vm.offCursor,\n              mousedown: _vm.moveNode,\n            },\n          },\n          _vm.anchorMode\n            ? {}\n            : { click: _vm.selectClick, contextmenu: _vm.contextMenuNode }\n        )\n      ),\n      _vm._v(\" \"),\n      _c(\"MglGeojsonLayer\", {\n        attrs: {\n          \"source-id\": \"anchorNodes\",\n          source: {\n            type: \"geojson\",\n            data: _vm.anchorNodes,\n            buffer: 0,\n            promoteId: \"index\",\n          },\n          \"layer-id\": \"anchorNodes\",\n          layer: {\n            interactive: true,\n            type: \"circle\",\n            minzoom: 2,\n            paint: {\n              \"circle-color\": \"#ffffff\",\n              \"circle-opacity\": 0.5,\n              \"circle-radius\": [\n                \"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false],\n                10,\n                5,\n              ],\n              \"circle-blur\": [\n                \"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false],\n                0.3,\n                0,\n              ],\n              \"circle-stroke-color\": \"#2C3E4E\",\n              \"circle-stroke-width\": 2,\n            },\n          },\n        },\n        on: {\n          click: _vm.selectClick,\n          mouseover: _vm.onCursor,\n          mouseleave: _vm.offCursor,\n          mousedown: _vm.moveNode,\n          contextmenu: _vm.contextMenuNode,\n        },\n      }),\n      _vm._v(\" \"),\n      _c(\n        \"MglPopup\",\n        {\n          attrs: {\n            \"close-button\": false,\n            showed: _vm.popupEditor.showed,\n            coordinates: _vm.popupEditor.coordinates,\n          },\n          on: {\n            close: function ($event) {\n              _vm.popupEditor.showed = false\n            },\n          },\n        },\n        [\n          _c(\"span\", [\n            _c(\"h3\", [_vm._v(_vm._s(_vm.popupEditor.content))]),\n            _vm._v(\" \"),\n            _c(\"hr\"),\n            _vm._v(\n              \"\\n      \" +\n                _vm._s(\n                  _vm.hoveredStateId?.layerId == \"editorLinks\"\n                    ? _vm.$gettext(\"Left click to add a stop\")\n                    : _vm.$gettext(\"Hold left click to drag\")\n                ) +\n                \"\\n      \"\n            ),\n            _c(\"hr\"),\n            _vm._v(\n              \"\\n      \" +\n                _vm._s(\n                  _vm.hoveredStateId?.layerId == \"editorLinks\"\n                    ? _vm.$gettext(\"Right click to edit properties\")\n                    : _vm.$gettext(\"Right click for context menu\")\n                ) +\n                \"\\n    \"\n            ),\n          ]),\n        ]\n      ),\n      _vm._v(\" \"),\n      _c(\n        \"MglPopup\",\n        {\n          attrs: {\n            \"close-button\": false,\n            showed: _vm.contextMenu.showed,\n            coordinates: _vm.contextMenu.coordinates,\n          },\n          on: {\n            close: function ($event) {\n              _vm.contextMenu.showed = false\n            },\n          },\n        },\n        [\n          _c(\n            \"span\",\n            {\n              on: {\n                mouseleave: function ($event) {\n                  _vm.contextMenu.showed = false\n                },\n              },\n            },\n            [\n              _c(\n                \"v-list\",\n                { attrs: { dense: \"\", flat: \"\" } },\n                [\n                  _c(\n                    \"v-list-item-group\",\n                    _vm._l(_vm.contextMenu.actions, function (action) {\n                      return _c(\n                        \"v-list-item\",\n                        { key: action.id },\n                        [\n                          _c(\n                            \"v-list-item-content\",\n                            [\n                              _c(\n                                \"v-btn\",\n                                {\n                                  attrs: { outlined: \"\", small: \"\" },\n                                  on: {\n                                    click: function ($event) {\n                                      return _vm.actionClick({\n                                        action: action,\n                                        feature: _vm.contextMenu.feature,\n                                        coordinates:\n                                          _vm.contextMenu.coordinates,\n                                      })\n                                    },\n                                  },\n                                },\n                                [\n                                  _vm._v(\n                                    \"\\n                \" +\n                                      _vm._s(_vm.$gettext(action)) +\n                                      \"\\n              \"\n                                  ),\n                                ]\n                              ),\n                            ],\n                            1\n                          ),\n                        ],\n                        1\n                      )\n                    }),\n                    1\n                  ),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n        ]\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<script>\nimport { MglPopup, MglImageLayer, MglGeojsonLayer } from 'vue-mapbox'\nconst $gettext = s => s\n\nexport default {\n  name: 'EditorLinks',\n  components: {\n    MglPopup,\n    MglImageLayer,\n    MglGeojsonLayer,\n  },\n  props: ['map', 'anchorMode'],\n  events: ['clickFeature', 'onHover', 'offHover'],\n  data () {\n    return {\n      selectedFeature: null,\n      hoveredStateId: null,\n      disablePopup: false,\n      keepHovering: false,\n      dragNode: false,\n      popupEditor: {\n        coordinates: [0, 0],\n        showed: false,\n        content: null,\n      },\n      contextMenu: {\n        coordinates: [0, 0],\n        showed: false,\n        actions: [],\n        feature: null,\n        type: null, // link of node\n      },\n    }\n  },\n  computed: {\n    anchorNodes () { return this.anchorMode ? this.$store.getters.anchorNodes : this.$store.getters.nodesHeader },\n  },\n\n  watch: {\n\n  },\n  created () {\n  },\n\n  methods: {\n    selectClick (event) {\n      if (this.hoveredStateId !== null) {\n        // Get the highlighted feature\n        const features = this.map.querySourceFeatures(this.hoveredStateId.layerId)\n        this.selectedFeature = features.filter(item => item.id === this.hoveredStateId.id)[0]\n        // Emit a click base on layer type (node or link)\n\n        if (this.selectedFeature !== null) {\n          if (this.hoveredStateId.layerId === 'editorLinks') {\n            const action = this.anchorMode ? 'Add Anchor Inline' : 'Add Stop Inline'\n            const click = {\n              selectedFeature: this.selectedFeature,\n              action: action,\n              lngLat: event.mapboxEvent.lngLat,\n            }\n            this.$emit('clickFeature', click)\n          }\n        }\n      }\n    },\n    onCursor (event) {\n      if (this.hoveredStateId === null || this.hoveredStateId.layerId === 'editorLinks') {\n        this.map.getCanvas().style.cursor = 'pointer'\n        if (this.hoveredStateId !== null) {\n          this.map.setFeatureState(\n            { source: this.hoveredStateId.layerId, id: this.hoveredStateId.id },\n            { hover: false },\n          )\n        }\n        this.hoveredStateId = { layerId: event.layerId, id: event.mapboxEvent.features[0].id }\n        this.map.setFeatureState(\n          { source: this.hoveredStateId.layerId, id: this.hoveredStateId.id },\n          { hover: true },\n        )\n        if (!this.disablePopup & !this.anchorMode) {\n          this.popupEditor.coordinates = [event.mapboxEvent.lngLat.lng,\n            event.mapboxEvent.lngLat.lat,\n          ]\n          this.popupEditor.content = this.hoveredStateId.id\n          this.popupEditor.showed = true\n        }\n      }\n      this.$emit('onHover', { selectedId: this.hoveredStateId.id })\n    },\n    offCursor (event) {\n      if (this.hoveredStateId !== null) {\n        // eslint-disable-next-line max-len\n        if (!(['editorNodes', 'anchorNodes'].includes(this.hoveredStateId.layerId) && event?.layerId === 'editorLinks')) {\n          // when we drag a node, we want to start dragging when we leave the node, but we will stay in hovering mode.\n          if (this.keepHovering) {\n            this.dragNode = true\n            this.contextMenu.showed = false\n            // normal behaviours, hovering is false\n          } else {\n            this.map.getCanvas().style.cursor = ''\n            this.popupEditor.showed = false\n            this.map.setFeatureState(\n              { source: this.hoveredStateId.layerId, id: this.hoveredStateId.id },\n              { hover: false },\n            )\n            this.hoveredStateId = null\n            this.$emit('offHover', event)\n          }\n        }\n      }\n    },\n    contextMenuNode (event) {\n      if (this.popupEditor.showed && this.hoveredStateId?.layerId === 'editorNodes') {\n        this.contextMenu.coordinates = [event.mapboxEvent.lngLat.lng,\n          event.mapboxEvent.lngLat.lat,\n        ]\n        this.contextMenu.showed = true\n\n        this.contextMenu.type = 'node'\n        const features = this.map.querySourceFeatures(this.hoveredStateId.layerId)\n        this.contextMenu.feature = features.filter(item => item.id === this.hoveredStateId.id)[0]\n\n        const selectedNode = this.contextMenu.feature.properties.index\n\n        if (selectedNode === this.$store.getters.firstNodeId) {\n          this.contextMenu.actions =\n          [\n            $gettext('Edit Node Info'),\n            $gettext('Delete Stop'),\n          ]\n        } else if (selectedNode === this.$store.getters.lastNodeId) {\n          this.contextMenu.actions =\n          [\n            $gettext('Edit Node Info'),\n            $gettext('Delete Stop'),\n          ]\n        } else {\n          this.contextMenu.actions =\n           [\n             $gettext('Edit Node Info'),\n             $gettext('Cut Before Node'),\n             $gettext('Cut After Node'),\n             $gettext('Delete Stop'),\n           ]\n        }\n      } else if (this.hoveredStateId?.layerId === 'anchorNodes') {\n        const features = this.map.querySourceFeatures(this.hoveredStateId.layerId)\n        this.selectedFeature = features.filter(item => item.id === this.hoveredStateId.id)\n        const click = {\n          selectedFeature: this.selectedFeature[0],\n          action: 'Delete Anchor',\n          lngLat: null,\n        }\n        this.$emit('clickFeature', click)\n      }\n    },\n\n    linkRightClick (event) {\n      if (this.hoveredStateId.layerId === 'editorLinks') {\n        const features = this.map.querySourceFeatures(this.hoveredStateId.layerId)\n        this.selectedFeature = features.filter(item => item.id === this.hoveredStateId.id)[0]\n        const click = {\n          selectedFeature: this.selectedFeature,\n          action: 'Edit Link Info',\n          lngLat: event.mapboxEvent.lngLat,\n          lingering: true,\n        }\n        this.$emit('clickFeature', click)\n      }\n    },\n\n    actionClick (event) {\n      const click = {\n        selectedFeature: event.feature,\n        action: event.action,\n        lngLat: event.coordinates,\n      }\n      this.$emit('clickFeature', click)\n\n      this.contextMenu.showed = false\n      this.contextMenu.type = null\n    },\n\n    moveNode (event) {\n      if (event.mapboxEvent.originalEvent.button === 0 &\n      ['editorNodes', 'anchorNodes'].includes(this.hoveredStateId.layerId)) {\n        event.mapboxEvent.preventDefault() // prevent map control\n        this.map.getCanvas().style.cursor = 'grab'\n        // disable mouseLeave so we stay in hover state.\n        this.keepHovering = true\n        // get selected node\n        const features = this.map.querySourceFeatures(this.hoveredStateId.layerId)\n        this.selectedFeature = features.filter(item => item.id === this.hoveredStateId.id)[0]\n\n        // disable popup\n        this.disablePopup = true\n        this.popupEditor.showed = false\n        // get position\n        this.map.on('mousemove', this.onMove)\n        this.map.on('mouseup', this.stopMovingNode)\n      }\n    },\n    onMove (event) {\n      // get position and update node position\n      // only if dragmode is activated (we just leave the node hovering state.)\n      if (this.map.loaded() && this.dragNode && this.selectedFeature) {\n        const click = {\n          selectedFeature: this.selectedFeature,\n          action: null,\n          lngLat: Object.values(event.lngLat),\n        }\n        if (this.hoveredStateId.layerId === 'anchorNodes') {\n          click.action = 'Move Anchor'\n          this.$emit('clickFeature', click)\n        } else {\n          click.action = 'Move Node'\n          this.$emit('clickFeature', click)\n        }\n      }\n    },\n\n    stopMovingNode (event) {\n      // stop tracking position (moving node.)\n      this.map.getCanvas().style.cursor = 'pointer'\n      this.map.off('mousemove', this.onMove)\n      // enable popup and hovering off back. disable Dragmode\n      this.keepHovering = false\n      this.dragNode = false\n      this.disablePopup = false\n      // call offCursor event, if we drag too quickly, it will not be call and the node will stay in hovering mode.\n      this.offCursor()\n      this.map.off('mouseup', this.stopMovingNode)\n      // emit a clickNode with the selected node.\n      // this will work with lag as it is the selectedFeature and not the highlighted one.\n    },\n  },\n\n}\n</script>\n<template>\n  <section>\n    <MglGeojsonLayer\n      source-id=\"editorLinks\"\n      :source=\"{\n        type: 'geojson',\n        data: $store.getters.editorLinks,\n        buffer: 0,\n        promoteId: 'index',\n      }\"\n      layer-id=\"editorLinks\"\n      :layer=\"{\n        type: 'line',\n        minzoom: 2,\n        paint: {\n          'line-color': ['case', ['boolean', anchorMode, false], '#B5E0D6', '#7EBAAC'],\n          'line-width': ['case', ['boolean', ['feature-state', 'hover'], false], 12, 5],\n          'line-blur': ['case', ['boolean', ['feature-state', 'hover'], false], 6, 0]\n        }\n      }\"\n      v-on=\"anchorMode ? {} : {contextmenu: linkRightClick}\"\n      @click=\"selectClick\"\n      @mouseover=\"onCursor\"\n      @mouseleave=\"offCursor\"\n    />\n\n    <MglImageLayer\n      source-id=\"editorLinks\"\n      type=\"symbol\"\n      source=\"editorLinks\"\n      layer-id=\"arrow-layer\"\n      :layer=\"{\n        type: 'symbol',\n        minzoom: 5,\n        layout: {\n          'symbol-placement': 'line',\n          'symbol-spacing': 30,\n          'icon-ignore-placement': true,\n          'icon-image':'arrow',\n          'icon-size': 0.5,\n          'icon-rotate': 90\n        },\n        paint: {\n          'icon-color': ['case', ['boolean', anchorMode, false], '#B5E0D6', '#7EBAAC'],\n        }\n      }\"\n    />\n\n    <MglGeojsonLayer\n      source-id=\"editorNodes\"\n      :source=\"{\n        type: 'geojson',\n        data: $store.getters.editorNodes,\n        buffer: 0,\n        promoteId: 'index',\n      }\"\n      layer-id=\"editorNodes\"\n      :layer=\"{\n        interactive: true,\n        type: 'circle',\n        minzoom: 2,\n        paint: {\n          'circle-color': '#2C3E4E',\n          'circle-radius': ['case', ['boolean', ['feature-state', 'hover'], false], 16, 8],\n          'circle-blur': ['case', ['boolean', ['feature-state', 'hover'], false], 0.3, 0]\n        }\n      }\"\n      v-on=\"anchorMode ? {} : {click: selectClick, contextmenu: contextMenuNode}\"\n      @mouseover=\"onCursor\"\n      @mouseleave=\"offCursor\"\n      @mousedown=\"moveNode\"\n    />\n\n    <MglGeojsonLayer\n      source-id=\"anchorNodes\"\n      :source=\"{\n        type: 'geojson',\n        data: anchorNodes,\n        buffer: 0,\n        promoteId: 'index',\n      }\"\n      layer-id=\"anchorNodes\"\n      :layer=\"{\n        interactive: true,\n        type: 'circle',\n        minzoom: 2,\n        paint: {\n          'circle-color': '#ffffff',\n          'circle-opacity':0.5,\n          'circle-radius': ['case', ['boolean', ['feature-state', 'hover'], false], 10, 5],\n          'circle-blur': ['case', ['boolean', ['feature-state', 'hover'], false], 0.3, 0],\n          'circle-stroke-color': '#2C3E4E',\n          'circle-stroke-width': 2,\n        },\n      }\"\n      @click=\"selectClick\"\n      @mouseover=\"onCursor\"\n      @mouseleave=\"offCursor\"\n      @mousedown=\"moveNode\"\n      @contextmenu=\"contextMenuNode\"\n    />\n\n    <MglPopup\n      :close-button=\"false\"\n      :showed=\"popupEditor.showed\"\n      :coordinates=\"popupEditor.coordinates\"\n      @close=\"popupEditor.showed=false\"\n    >\n      <span>\n        <h3>{{ popupEditor.content }}</h3>\n        <hr>\n        {{ hoveredStateId?.layerId == 'editorLinks'?\n          $gettext(\"Left click to add a stop\"):\n          $gettext(\"Hold left click to drag\") }}\n        <hr>\n        {{ hoveredStateId?.layerId == 'editorLinks'?\n          $gettext(\"Right click to edit properties\"):\n          $gettext(\"Right click for context menu\") }}\n      </span>\n    </MglPopup>\n\n    <MglPopup\n      :close-button=\"false\"\n      :showed=\"contextMenu.showed\"\n      :coordinates=\"contextMenu.coordinates\"\n      @close=\"contextMenu.showed=false\"\n    >\n      <span\n        @mouseleave=\"contextMenu.showed=false\"\n      >\n        <v-list\n          dense\n          flat\n        >\n          <v-list-item-group>\n            <v-list-item\n              v-for=\"action in contextMenu.actions\"\n              :key=\"action.id\"\n            >\n              <v-list-item-content>\n                <v-btn\n                  outlined\n                  small\n                  @click=\"actionClick({action: action,\n                                       feature: contextMenu.feature,\n                                       coordinates: contextMenu.coordinates})\"\n                >\n                  {{ $gettext(action) }}\n                </v-btn>\n              </v-list-item-content>\n            </v-list-item>\n          </v-list-item-group>\n        </v-list>\n      </span>\n    </MglPopup>\n  </section>\n</template>\n<style lang=\"scss\" scoped>\n\n</style>\n","import mod from \"-!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditorLinks.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditorLinks.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EditorLinks.vue?vue&type=template&id=58974184&scoped=true&\"\nimport script from \"./EditorLinks.vue?vue&type=script&lang=js&\"\nexport * from \"./EditorLinks.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58974184\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_g","attrs","source","type","data","$store","getters","editorLinks","buffer","promoteId","layer","minzoom","paint","anchorMode","on","click","selectClick","mouseover","onCursor","mouseleave","offCursor","contextmenu","linkRightClick","_v","layout","editorNodes","interactive","mousedown","moveNode","contextMenuNode","anchorNodes","showed","popupEditor","coordinates","close","$event","_s","content","hoveredStateId","layerId","$gettext","contextMenu","dense","flat","_l","actions","action","key","id","outlined","small","actionClick","feature","_withStripped","name","components","MglPopup","MglImageLayer","MglGeojsonLayer","props","events","selectedFeature","disablePopup","keepHovering","dragNode","computed","nodesHeader","watch","created","methods","event","features","map","querySourceFeatures","filter","item","lngLat","mapboxEvent","$emit","getCanvas","style","cursor","setFeatureState","hover","lng","lat","selectedId","includes","selectedNode","properties","index","firstNodeId","lastNodeId","lingering","originalEvent","button","preventDefault","onMove","stopMovingNode","loaded","Object","values","off"],"sourceRoot":""}