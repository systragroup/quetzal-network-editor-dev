import{_ as U,r as s,aP as h,g as m,q as P,j as o,i as n,ab as R,x as f,y as w,ad as k,U as T,H as B,h as V,Z as _,l as g,G as E,R as $,L as z,aQ as q}from"./index-DDRYKHoP.js";const A={__name:"Signin",emits:["signin"],setup(D,{emit:I}){const a=l=>l,x=I,r=s(!1),v=s(""),p=s(""),d=s(""),y=s(""),b=s(""),c=s(!1),i=s(!1),N=/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&_])[A-Za-z\d@$!%*?&_]+$/,S=s(),t=s({required:l=>!!l||a("Required"),password:l=>N.test(l)||a("need at least: 1 lowercase, 1 uppercase, 1 number, and 1 symbol"),match:l=>l===d.value||a("password must match")});h(()=>{r.value="",v.value="",p.value="",d.value="",y.value="",b.value=""});async function C(l){if((await l).valid){i.value=!0;try{if(r.value){const e=await q.completeNewPassword(d.value);x("signin",e)}else{const e=await q.signin({username:v.value,password:p.value});e.nextStep.signInStep==="CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED"?(r.value=!0,i.value=!1,S.value.resetValidation()):x("signin",e)}}catch(e){c.value=!0,i.value=!1,b.value=e}}else c.value=!0,i.value=!1;setTimeout(()=>{c.value=!1},500)}return(l,u)=>(m(),P("section",null,[o(z,{class:$(["signin",{shake:c.value}])},{default:n(()=>[o(R,{class:"text-h4"},{default:n(()=>[f(w(r.value?a("New password"):a("Sign In")),1)]),_:1}),o(k,{class:"text-h8",style:{"padding-bottom":"0.5rem"}},{default:n(()=>[f(w(a("Sign in with username or email address.")),1)]),_:1}),o(T,{ref_key:"form",ref:S,class:"form",onSubmit:B(C,["prevent"])},{default:n(()=>[r.value?g("",!0):(m(),V(_,{key:0,modelValue:v.value,"onUpdate:modelValue":u[0]||(u[0]=e=>v.value=e),label:a("username"),required:"",rules:[t.value.required]},null,8,["modelValue","label","rules"])),r.value?g("",!0):(m(),V(_,{key:1,modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=e=>p.value=e),label:a("password"),required:"",rules:[t.value.required],type:"password"},null,8,["modelValue","label","rules"])),r.value?(m(),V(_,{key:2,modelValue:d.value,"onUpdate:modelValue":u[2]||(u[2]=e=>d.value=e),label:a("new password"),required:"",rules:[t.value.required,t.value.password],type:"password"},null,8,["modelValue","label","rules"])):g("",!0),r.value?(m(),V(_,{key:3,modelValue:y.value,"onUpdate:modelValue":u[3]||(u[3]=e=>y.value=e),label:a("confirm new password"),required:"",rules:[t.value.required,t.value.match],type:"password"},null,8,["modelValue","label","rules"])):g("",!0),o(k,{style:{color:"red"}},{default:n(()=>[f(w(b.value),1)]),_:1}),o(E,{block:"",type:"submit",color:"success",loading:i.value},{default:n(()=>[f(w(a("Sign in")),1)]),_:1},8,["loading"])]),_:1},512)]),_:1},8,["class"])]))}},M=U(A,[["__scopeId","data-v-23151032"]]);export{M as default};
