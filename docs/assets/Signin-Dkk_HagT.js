import{_ as g,aO as h,g as o,q as V,j as t,i as a,ab as P,x as n,y as i,ad as f,U as y,h as d,Z as u,l as w,G as b,R as k,a4 as U,L as c}from"./index-DXtDxCc4.js";const m=e=>e,I={name:"Signin",emits:["signin"],data(){return{newPasswordUI:!1,user:null,username:"",password:"",newPassword:"",newPasswordConfirm:"",error:"",shake:!1,loading:!1,re:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&_])[A-Za-z\d@$!%*?&_]+$/,rules:{required:e=>!!e||m("Required"),password:e=>this.re.test(e)||m("need at least: 1 lowercase, 1 uppercase, 1 number, and 1 symbol"),match:e=>e===this.newPassword||m("password must match")}}},beforeDestroy(){this.newPasswordUI="",this.username="",this.password="",this.newPassword="",this.newPasswordConfirm="",this.error=""},methods:{async signin(){if(this.$refs.form.validate()){this.loading=!0;try{if(this.newPasswordUI){const e=await h.completeNewPassword(this.user,this.newPassword);this.$emit("signin",e)}else{const e=await h.signin({username:this.username,password:this.password});e.challengeName==="NEW_PASSWORD_REQUIRED"?(this.user=e,this.newPasswordUI=!0,this.$refs.form.resetValidation()):this.$emit("signin",e)}}catch(e){this.shake=!0,this.loading=!1,this.error=e}}else this.shake=!0,this.loading=!1;setTimeout(()=>{this.shake=!1},500)}}};function q(e,r,x,C,s,p){return o(),V("section",null,[t(c,{class:k(["signin",{shake:s.shake}]),onKeydown:r[5]||(r[5]=U(l=>p.signin(),["enter"]))},{default:a(()=>[t(P,{class:"text-h4"},{default:a(()=>[n(i(s.newPasswordUI?e.$gettext("New password"):e.$gettext("Sign In")),1)]),_:1}),t(f,{class:"text-h8",style:{"{'padding-bottom'":"'0.5rem'}"}},{default:a(()=>[n(i(e.$gettext("Sign in with username or email address.")),1)]),_:1}),t(y,{ref:"form","lazy-validation":""},{default:a(()=>[s.newPasswordUI?w("",!0):(o(),d(u,{key:0,modelValue:s.username,"onUpdate:modelValue":r[0]||(r[0]=l=>s.username=l),label:e.$gettext("username"),required:"",rules:[s.rules.required]},null,8,["modelValue","label","rules"])),s.newPasswordUI?w("",!0):(o(),d(u,{key:1,modelValue:s.password,"onUpdate:modelValue":r[1]||(r[1]=l=>s.password=l),label:e.$gettext("password"),required:"",rules:[s.rules.required],type:"password"},null,8,["modelValue","label","rules"])),s.newPasswordUI?(o(),d(u,{key:2,modelValue:s.newPassword,"onUpdate:modelValue":r[2]||(r[2]=l=>s.newPassword=l),label:e.$gettext("new password"),required:"",rules:[s.rules.required,s.rules.password],type:"password"},null,8,["modelValue","label","rules"])):w("",!0),s.newPasswordUI?(o(),d(u,{key:3,modelValue:s.newPasswordConfirm,"onUpdate:modelValue":r[3]||(r[3]=l=>s.newPasswordConfirm=l),label:e.$gettext("confirm new password"),required:"",rules:[s.rules.required,s.rules.match],type:"password"},null,8,["modelValue","label","rules"])):w("",!0),t(f,{style:{color:"red"}},{default:a(()=>[n(i(s.error),1)]),_:1}),t(b,{block:"",color:"success",loading:s.loading,onClick:r[4]||(r[4]=l=>p.signin())},{default:a(()=>[n(i(e.$gettext("Sign in")),1)]),_:1},8,["loading"])]),_:1},512)]),_:1},8,["class"])])}const N=g(I,[["render",q],["__scopeId","data-v-b72c896e"]]);export{N as default};
