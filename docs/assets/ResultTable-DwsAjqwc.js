import{au as E,av as T,r as h,_ as W,u as F,ag as O,p as C,g as k,q as w,y as R,l as N,F as j,E as D,j as b,as as L,aw as I,i as S,ax as V,ay as G,x as B,a3 as M,az as P,aA as $,aa as A,aB as J}from"./index-Db1Zz-Gc.js";function q(t){return E()?(T(t),!0):!1}const z=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const K=z?window:void 0;function X(t){return u=>{const a=u.data[0];return Promise.resolve(t.apply(void 0,a)).then(o=>{postMessage(["SUCCESS",o])}).catch(o=>{postMessage(["ERROR",o])})}}function Y(t){return t.length===0?"":`importScripts(${t.map(a=>`'${a}'`).toString()})`}function H(t,u){const a=`${Y(u)}; onmessage=(${X})(${t})`,o=new Blob([a],{type:"text/javascript"});return URL.createObjectURL(o)}function Q(t,u={}){const{dependencies:a=[],timeout:o,window:d=K}=u,c=h(),l=h("PENDING"),f=h({}),v=h(),e=(n="PENDING")=>{c.value&&c.value._url&&d&&(c.value.terminate(),URL.revokeObjectURL(c.value._url),f.value={},c.value=void 0,d.clearTimeout(v.value),l.value=n)};e(),q(e);const p=()=>{const n=H(t,a),r=new Worker(n);return r._url=n,r.onmessage=m=>{const{resolve:g=()=>{},reject:x=()=>{}}=f.value,[y,_]=m.data;switch(y){case"SUCCESS":g(_),e(y);break;default:x(_),e("ERROR");break}},r.onerror=m=>{const{reject:g=()=>{}}=f.value;m.preventDefault(),g(m),e("ERROR")},o&&(v.value=setTimeout(()=>e("TIMEOUT_EXPIRED"),o)),r},i=(...n)=>new Promise((r,m)=>{f.value={resolve:r,reject:m},c.value&&c.value.postMessage([[...n]]),l.value="RUNNING"});return{workerFn:(...n)=>l.value==="RUNNING"?(console.error("[useWebWorkerFn] You can only run one instance of the worker at a time."),Promise.reject()):(c.value=p(),i(...n)),workerStatus:l,workerTerminate:e}}const U=t=>t,{workerFn:Z}=Q(J),ee={name:"ResultTable",setup(){const t=F(),u=O(),a=h([]),o=h(""),d=h(0),c=h(10);async function l(){const e=u.scenario+"/",i=t.otherFiles.filter(s=>s.extension==="csv");d.value=i.length;for(const s of i)s.content instanceof Uint8Array||(s.content=await L.readBytes(u.model,e+s.path));return i}C(async()=>{t.changeLoading(!0);try{const e=await l();for(const p of e){const i=p.path.slice(0,-4),s=await Z(p.content.buffer),n=[];Object.keys(s[0]).forEach(r=>n.push({title:r,key:r,width:"1%"})),a.value.push({headers:n,items:s.slice(0,c.value),data:s,name:i,totalItems:s.length}),d.value-=1}t.changeLoading(!1),a.value.length===0&&(o.value=U("Nothing to display"))}catch(e){console.error(e),t.changeLoading(!1),d.value=0,o.value=U("Nothing to display")}});function f(e,p,i,s){const n=(p-1)*i,r=n+i;if(s.length>0){const m=s[0].key,g=s[0].order;e=A.orderBy(e,m,g)}return e.slice(n,r)}async function v({key:e,page:p,itemsPerPage:i,sortBy:s}){const n=I(a.value[e].data),r=f(n,p,i,I(s));a.value[e].items=r}return{tables:a,message:o,numItems:c,loadItems:v,skeletons:d}}},te={class:"layout"},oe={key:0},se={key:1,class:"card elevation-3"};function ne(t,u,a,o,d,c){return k(),w("section",te,[o.tables.length===0?(k(),w("p",oe,R(t.$gettext(o.message)),1)):N("",!0),(k(!0),w(j,null,D(o.tables,(l,f)=>(k(),w("div",{key:f,class:"card elevation-3"},[b(P,{"items-per-page":o.numItems,headers:l.headers,height:l.items.length>=10?"36rem":"auto","items-length":l.totalItems,"fixed-header":"","fixed-footer":"",items:l.items,"onUpdate:options":v=>o.loadItems({key:f,...v})},{top:S(()=>[b(V,{class:"custom-title"},{default:S(()=>[b(G,null,{default:S(()=>[B(R(l.name),1)]),_:2},1024),b(M)]),_:2},1024)]),_:2},1032,["items-per-page","headers","height","items-length","items","onUpdate:options"])]))),128)),o.skeletons>0?(k(),w("div",se,[b($,{type:"heading,table-thead, table-tbody "})])):N("",!0)])}const re=W(ee,[["render",ne],["__scopeId","data-v-e2c5cdea"]]);export{re as default};
