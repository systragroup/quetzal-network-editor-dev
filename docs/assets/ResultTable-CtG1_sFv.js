import{aD as F,aE as T,r as g,_ as x,f as k,g as b,l as I,C as N,H as j,I as C,j as S,i as y,aF as O,aG as D,B as $,a9 as L,aH as V,aI as G,a as B,am as M,d as P,aB as J,aJ as U,aj as A,aK as H}from"./index-CQzvEvj4.js";function K(n){return F()?(T(n),!0):!1}const X=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Y=X?window:void 0;function q(n){return l=>{const r=l.data[0];return Promise.resolve(n.apply(void 0,r)).then(t=>{postMessage(["SUCCESS",t])}).catch(t=>{postMessage(["ERROR",t])})}}function z(n,l){if(n.length===0&&l.length===0)return"";const r=n.map(c=>`'${c}'`).toString(),t=l.filter(c=>typeof c=="function").map(c=>{const e=c.toString();return e.trim().startsWith("function")?e:`const ${c.name} = ${e}`}).join(";"),u=`importScripts(${r});`;return`${r.trim()===""?"":u} ${t}`}function Q(n,l,r){const t=`${z(l,r)}; onmessage=(${q})(${n})`,u=new Blob([t],{type:"text/javascript"});return URL.createObjectURL(u)}function Z(n,l={}){const{dependencies:r=[],localDependencies:t=[],timeout:u,window:c=Y}=l,e=g(),f=g("PENDING"),p=g({}),w=g(),o=(a="PENDING")=>{e.value&&e.value._url&&c&&(e.value.terminate(),URL.revokeObjectURL(e.value._url),p.value={},e.value=void 0,c.clearTimeout(w.value),f.value=a)};o(),K(o);const m=()=>{const a=Q(n,r,t),i=new Worker(a);return i._url=a,i.onmessage=h=>{const{resolve:v=()=>{},reject:W=()=>{}}=p.value,[_,R]=h.data;switch(_){case"SUCCESS":v(R),o(_);break;default:W(R),o("ERROR");break}},i.onerror=h=>{const{reject:v=()=>{}}=p.value;h.preventDefault(),v(h),o("ERROR")},u&&(w.value=setTimeout(()=>o("TIMEOUT_EXPIRED"),u)),i},d=(...a)=>new Promise((i,h)=>{p.value={resolve:i,reject:h},e.value&&e.value.postMessage([[...a]]),f.value="RUNNING"});return{workerFn:(...a)=>f.value==="RUNNING"?(console.error("[useWebWorkerFn] You can only run one instance of the worker at a time."),Promise.reject()):(e.value=m(),d(...a)),workerStatus:f,workerTerminate:o}}const E=n=>n,{workerFn:ee}=Z(H),te={name:"ResultTable",setup(){const n=B(),l=M(),r=g([]),t=g(""),u=g(0),c=g(10),e=40;async function f(){const o=l.scenario+"/",d=n.otherFiles.filter(s=>s.extension==="csv");u.value=d.length;for(const s of d)s.content instanceof Uint8Array||(s.content=await J.readBytes(l.model,o+s.path,e));return d}P(async()=>{n.changeLoading(!0);try{const o=await f();for(const m of o){const d=m.path.slice(0,-4),s=m.content!==null?await ee(m.content.buffer):[{too_large:`cannot display, more than ${e} mb`}],a=[];Object.keys(s[0]).forEach(i=>a.push({title:i,key:i,width:"1%"})),r.value.push({headers:a,items:s.slice(0,c.value),data:s,name:d,totalItems:s.length}),u.value-=1}n.changeLoading(!1),r.value.length===0&&(t.value=E("Nothing to display"))}catch(o){console.error(o),n.changeLoading(!1),u.value=0,t.value=E("Nothing to display")}});function p(o,m,d,s){const a=(m-1)*d,i=a+d;if(s.length>0){const h=s[0].key,v=s[0].order;o=A.orderBy(o,h,v)}return o.slice(a,i)}async function w({key:o,page:m,itemsPerPage:d,sortBy:s}){const a=U(r.value[o].data),i=p(a,m,d,U(s));r.value[o].items=i}return{tables:r,message:t,numItems:c,loadItems:w,skeletons:u}}},oe={class:"layout"},ne={key:0},se={key:1,class:"card elevation-3"};function ae(n,l,r,t,u,c){return b(),k("section",oe,[t.tables.length===0?(b(),k("p",ne,N(n.$gettext(t.message)),1)):I("",!0),(b(!0),k(j,null,C(t.tables,(e,f)=>(b(),k("div",{key:f,class:"card elevation-3"},[S(V,{"items-per-page":t.numItems,headers:e.headers,height:e.items.length>=10?"36rem":"auto","items-length":e.totalItems,"fixed-header":"","fixed-footer":"",items:e.items,"onUpdate:options":p=>t.loadItems({key:f,...p})},{top:y(()=>[S(O,{class:"custom-title"},{default:y(()=>[S(D,null,{default:y(()=>[$(N(e.name),1)]),_:2},1024),S(L)]),_:2},1024)]),_:2},1032,["items-per-page","headers","height","items-length","items","onUpdate:options"])]))),128)),t.skeletons>0?(b(),k("div",se,[S(G,{type:"heading,table-thead, table-tbody "})])):I("",!0)])}const ce=x(te,[["render",ae],["__scopeId","data-v-e4efd89a"]]);export{ce as default};
