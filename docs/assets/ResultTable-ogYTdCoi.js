import{ar as T,as as W,r as h,_ as F,u as C,ae as O,p as V,g as k,q as S,y as R,l as N,F as j,E as D,h as I,i as w,L as U,ap as L,at as x,j as b,au as G,av as B,x as M,a3 as P,aw as $,ax as A,a9 as J,ay as q}from"./index-sPZ3oNHq.js";function K(e){return T()?(W(e),!0):!1}const X=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Y=X?window:void 0;function z(e){return u=>{const n=u.data[0];return Promise.resolve(e.apply(void 0,n)).then(t=>{postMessage(["SUCCESS",t])}).catch(t=>{postMessage(["ERROR",t])})}}function H(e){return e.length===0?"":`importScripts(${e.map(n=>`'${n}'`).toString()})`}function Q(e,u){const n=`${H(u)}; onmessage=(${z})(${e})`,t=new Blob([n],{type:"text/javascript"});return URL.createObjectURL(t)}function Z(e,u={}){const{dependencies:n=[],timeout:t,window:p=Y}=u,c=h(),l=h("PENDING"),d=h({}),v=h(),o=(a="PENDING")=>{c.value&&c.value._url&&p&&(c.value.terminate(),URL.revokeObjectURL(c.value._url),d.value={},c.value=void 0,p.clearTimeout(v.value),l.value=a)};o(),K(o);const f=()=>{const a=Q(e,n),r=new Worker(a);return r._url=a,r.onmessage=m=>{const{resolve:g=()=>{},reject:E=()=>{}}=d.value,[y,_]=m.data;switch(y){case"SUCCESS":g(_),o(y);break;default:E(_),o("ERROR");break}},r.onerror=m=>{const{reject:g=()=>{}}=d.value;m.preventDefault(),g(m),o("ERROR")},t&&(v.value=setTimeout(()=>o("TIMEOUT_EXPIRED"),t)),r},i=(...a)=>new Promise((r,m)=>{d.value={resolve:r,reject:m},c.value&&c.value.postMessage([[...a]]),l.value="RUNNING"});return{workerFn:(...a)=>l.value==="RUNNING"?(console.error("[useWebWorkerFn] You can only run one instance of the worker at a time."),Promise.reject()):(c.value=f(),i(...a)),workerStatus:l,workerTerminate:o}}const ee=e=>e,{workerFn:te}=Z(q),oe={name:"ResultTable",setup(){const e=C(),u=O(),n=h([]),t=h(""),p=h(0),c=h(10);async function l(){const o=u.scenario+"/",i=e.otherFiles.filter(s=>s.extension==="csv");p.value=i.length;for(const s of i)s.content instanceof Uint8Array||(s.content=await L.readBytes(u.model,o+s.path));return i}V(async()=>{e.changeLoading(!0);const o=await l();for(const f of o){const i=f.path.slice(0,-4),s=await te(f.content),a=[];Object.keys(s[0]).forEach(r=>a.push({title:r,key:r,width:"1%"})),n.value.push({headers:a,items:s.slice(0,c.value),data:s,name:i,totalItems:s.length}),p.value-=1}e.changeLoading(!1),n.value.length===0&&(t.value=ee("Nothing to display"))});function d(o,f,i,s){const a=(f-1)*i,r=a+i;if(s.length>0){const m=s[0].key,g=s[0].order;o=J.orderBy(o,m,g)}return o.slice(a,r)}async function v({key:o,page:f,itemsPerPage:i,sortBy:s}){const a=x(n.value[o].data),r=d(a,f,i,x(s));n.value[o].items=r}return{tables:n,message:t,numItems:c,loadItems:v,skeletons:p}}},se={class:"layout"},ae={key:0};function ne(e,u,n,t,p,c){return k(),S("section",se,[t.tables.length===0?(k(),S("p",ae,R(e.$gettext(t.message)),1)):N("",!0),(k(!0),S(j,null,D(t.tables,(l,d)=>(k(),I(U,{key:d,class:"card elevation-3"},{default:w(()=>[b($,{"items-per-page":t.numItems,headers:l.headers,height:l.items.length>=10?"35rem":"auto","items-length":l.totalItems,"fixed-header":"","fixed-footer":"",items:l.items,"onUpdate:options":v=>t.loadItems({key:d,...v})},{top:w(()=>[b(G,{class:"custom-title"},{default:w(()=>[b(B,null,{default:w(()=>[M(R(l.name),1)]),_:2},1024),b(P)]),_:2},1024)]),_:2},1032,["items-per-page","headers","height","items-length","items","onUpdate:options"])]),_:2},1024))),128)),t.skeletons>0?(k(),I(U,{key:1,class:"card elevation-3"},{default:w(()=>[b(A,{type:"heading,table-thead, table-tbody "})]),_:1})):N("",!0)])}const ce=F(oe,[["render",ne],["__scopeId","data-v-1ad7a5fe"]]);export{ce as default};
