import{_ as B,u as T,r as s,b1 as U,f as v,g as $,j as n,i as d,ah as P,B as w,C as V,k as r,aj as q,$ as R,L as E,h as _,a2 as g,p as b,K as z,Y as A,Q as D,b2 as C}from"./index-BH1OIb0u.js";const F={__name:"Signin",emits:["signin"],setup(M,{emit:I}){const{$gettext:a}=T(),x=I,u=s(!1),p=s(""),c=s(""),i=s(""),y=s(""),k=s(""),f=s(!1),m=s(!1),N=/^(?!\s+)(?!.*\s+$)(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[$^*.[\]{}()?"!@#%&/\\,><':;|_~`=+\- ])[A-Za-z0-9$^*.[\]{}()?"!@#%&/\\,><':;|_~`=+\- ]{8,256}$/,S=s(),o=s({required:t=>!!t||a("Required"),password:t=>N.test(t)||a("need at least: 1 lowercase, 1 uppercase, 1 number, and 1 symbol"),match:t=>t===i.value||a("password must match")});U(()=>{u.value="",p.value="",c.value="",i.value="",y.value="",k.value=""});async function h(t){if((await t).valid){m.value=!0;try{if(u.value){const e=await C.completeNewPassword(i.value);x("signin",e)}else{const e=await C.signin({username:p.value,password:c.value});e.nextStep.signInStep==="CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED"?(u.value=!0,m.value=!1,S.value.resetValidation()):x("signin",e)}}catch(e){f.value=!0,m.value=!1,k.value=e}}else f.value=!0,m.value=!1;setTimeout(()=>{f.value=!1},500)}return(t,l)=>(v(),$("section",null,[n(D,{class:A(["signin",{shake:f.value}])},{default:d(()=>[n(P,{class:"text-h4"},{default:d(()=>[w(V(u.value?r(a)("New password"):r(a)("Sign In")),1)]),_:1}),n(q,{class:"text-h8",style:{"padding-bottom":"0.5rem"}},{default:d(()=>[w(V(r(a)("Sign in with username or email address.")),1)]),_:1}),n(R,{ref_key:"form",ref:S,class:"form",onSubmit:E(h,["prevent"])},{default:d(()=>[u.value?b("",!0):(v(),_(g,{key:0,modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=e=>p.value=e),label:r(a)("username"),required:"",rules:[o.value.required]},null,8,["modelValue","label","rules"])),u.value?b("",!0):(v(),_(g,{key:1,modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value=e),label:r(a)("password"),required:"",rules:[o.value.required],type:"password"},null,8,["modelValue","label","rules"])),u.value?(v(),_(g,{key:2,modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=e=>i.value=e),label:r(a)("new password"),required:"",rules:[o.value.required,o.value.password],type:"password"},null,8,["modelValue","label","rules"])):b("",!0),u.value?(v(),_(g,{key:3,modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=e=>y.value=e),label:r(a)("confirm new password"),required:"",rules:[o.value.required,o.value.match],type:"password"},null,8,["modelValue","label","rules"])):b("",!0),n(q,{style:{color:"red"}},{default:d(()=>[w(V(k.value),1)]),_:1}),n(z,{block:"",type:"submit",color:"success",loading:m.value},{default:d(()=>[w(V(r(a)("Sign in")),1)]),_:1},8,["loading"])]),_:1},512)]),_:1},8,["class"])]))}},j=B(F,[["__scopeId","data-v-5df7836b"]]);export{j as default};
