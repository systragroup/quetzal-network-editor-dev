import{_ as g,aN as h,g as a,q as V,j as n,i as t,aa as P,y as l,x as i,ac as f,U as y,Z as u,h as d,l as w,G as c,R as k,a4 as U,L as I}from"./index-46hvkFCB.js";const m=s=>s,q={name:"Signin",components:{},props:[],emits:["signin"],data(){return{newPasswordUI:!1,user:null,username:"",password:"",newPassword:"",newPasswordConfirm:"",error:"",shake:!1,re:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&_])[A-Za-z\d@$!%*?&_]+$/,rules:{required:s=>!!s||m("Required"),password:s=>this.re.test(s)||m("need at least: 1 lowercase, 1 uppercase, 1 number, and 1 symbol"),match:s=>s===this.newPassword||m("password must match")}}},beforeDestroy(){this.newPasswordUI="",this.username="",this.password="",this.newPassword="",this.newPasswordConfirm="",this.error=""},methods:{async signin(){if(this.$refs.form.validate())try{if(this.newPasswordUI){const s=await h.completeNewPassword(this.user,this.newPassword);this.$emit("signin",s)}else{const s=await h.signin({username:this.username,password:this.password});s.challengeName==="NEW_PASSWORD_REQUIRED"?(this.user=s,this.newPasswordUI=!0,this.$refs.form.resetValidation()):this.$emit("signin",s)}}catch(s){this.shake=!0,this.error=s}else this.shake=!0,setTimeout(()=>{this.shake=!1},500)}}};function x(s,r,C,b,e,p){return a(),V("section",null,[n(I,{class:k(["signin",{shake:e.shake}]),onKeydown:r[5]||(r[5]=U(o=>p.signin(),["enter"]))},{default:t(()=>[n(P,{class:"text-h4"},{default:t(()=>[i(l(e.newPasswordUI?s.$gettext("New password"):s.$gettext("Sign In")),1)]),_:1}),n(f,{class:"text-h8",style:{"{'padding-bottom'":"'0.5rem'}"}},{default:t(()=>[i(l(s.$gettext("Sign in with username or email address.")),1)]),_:1}),n(y,{ref:"form","lazy-validation":""},{default:t(()=>[e.newPasswordUI?w("",!0):(a(),d(u,{key:0,modelValue:e.username,"onUpdate:modelValue":r[0]||(r[0]=o=>e.username=o),label:"username",required:"",rules:[e.rules.required]},null,8,["modelValue","rules"])),e.newPasswordUI?w("",!0):(a(),d(u,{key:1,modelValue:e.password,"onUpdate:modelValue":r[1]||(r[1]=o=>e.password=o),label:"password",required:"",rules:[e.rules.required],type:"password"},null,8,["modelValue","rules"])),e.newPasswordUI?(a(),d(u,{key:2,modelValue:e.newPassword,"onUpdate:modelValue":r[2]||(r[2]=o=>e.newPassword=o),label:"new password",required:"",rules:[e.rules.required,e.rules.password],type:"password"},null,8,["modelValue","rules"])):w("",!0),e.newPasswordUI?(a(),d(u,{key:3,modelValue:e.newPasswordConfirm,"onUpdate:modelValue":r[3]||(r[3]=o=>e.newPasswordConfirm=o),label:"confirm new password",required:"",rules:[e.rules.required,e.rules.match],type:"password"},null,8,["modelValue","rules"])):w("",!0),n(f,{style:{color:"red"}},{default:t(()=>[i(l(e.error),1)]),_:1}),n(c,{block:"",color:"success",onClick:r[4]||(r[4]=o=>p.signin())},{default:t(()=>[i(l(s.$gettext("Sign in")),1)]),_:1})]),_:1},512)]),_:1},8,["class"])])}const S=g(q,[["render",x],["__scopeId","data-v-292e4749"]]);export{S as default};
