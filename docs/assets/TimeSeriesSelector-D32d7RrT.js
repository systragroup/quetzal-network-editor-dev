import{al as B,u as R,b6 as T,d as D,aj as v,r as f,w as M,h as d,g as u,i as E,f as b,H as $,I as j,A as z,D as V,l as I,L as h,W as y,j as x,a2 as o,m as r,$ as L,bX as k,_ as A}from"./index-8t7L7H7c.js";import{g as m}from"./form-B2uRhppC.js";const G={class:"params-row"},H=B({__name:"TimeSeriesSelector",props:{modelValue:{default:[]},modelModifiers:{}},emits:["update:modelValue"],setup(g,{expose:w}){const{$gettext:s}=R(),p=T(g,"modelValue");D(()=>{p.value.forEach(t=>{const a=v.cloneDeep(c);a.start_time.value=t.start_time,a.end_time.value=t.end_time,a.period.value=t.value,l.value.push(a)})});const c={start_time:{label:"start time",value:"",type:"time",rules:["required"]},end_time:{label:"end time",value:"",type:"time",rules:["required"]},period:{label:"period name",value:"",type:"string",rules:["required",N],disabled:!1}},l=f([]);function q(){const t=v.cloneDeep(c);l.value.push(t)}function F(t){l.value=l.value.filter((a,e)=>e!==t)}M(l,t=>{const a=t[0];t.length==1?(a.period.disabled=!0,a.period.value=""):a.period.disabled=!1,S()},{deep:!0});function S(){const t=l.value.map(a=>({start_time:a.start_time.value,end_time:a.end_time.value,value:a.period.value}));p.value=t}function C(t){return k(t.start_time.value)>k(t.end_time.value)?s("Start time must be smaller than end time"):!0}function N(t){return t!=null&&t.includes("#")?s("field cannot contain #"):l.value.map(e=>e.period.value).filter(e=>e===t).length>1?s("period name must be unique"):!0}const _=f();async function U(){return!!(await _.value.validate()).valid}return w({validate:U}),(t,a)=>(u(),d(L,{ref_key:"formRef",ref:_,"validate-on":"input"},{default:E(()=>[(u(!0),b($,null,j(l.value,(e,n)=>(u(),b("div",{key:n},[z("div",G,[n==0?(u(),d(h,{key:0,icon:"fas fa-plus",size:"x-small",color:"primary",onClick:q})):(u(),d(h,{key:1,icon:"fas fa-trash",size:"x-small",color:"error",onClick:i=>F(n)},null,8,["onClick"])),V(x(o,{modelValue:e.start_time.value,"onUpdate:modelValue":i=>e.start_time.value=i,class:"params",type:e.start_time.type,step:"1",variant:"outlined","validate-on":"input",label:r(s)(e.start_time.label),suffix:e.start_time.units,rules:r(m)(e.start_time.rules),"hide-details":"auto",required:""},null,8,["modelValue","onUpdate:modelValue","type","label","suffix","rules"]),[[y,!e.start_time.disabled]]),V(x(o,{modelValue:e.end_time.value,"onUpdate:modelValue":i=>e.end_time.value=i,class:"params",type:e.end_time.type,step:"1",variant:"outlined",label:r(s)(e.end_time.label),suffix:e.end_time.units,rules:[...r(m)(e.end_time.rules),C(e)],"hide-details":"auto",required:""},null,8,["modelValue","onUpdate:modelValue","type","label","suffix","rules"]),[[y,!e.end_time.disabled]]),e.period.disabled?I("",!0):(u(),d(o,{key:2,modelValue:e.period.value,"onUpdate:modelValue":i=>e.period.value=i,class:"params",type:e.period.type,step:"1",variant:"outlined",label:r(s)(e.period.label),suffix:e.period.units,rules:r(m)(e.period.rules),"hide-details":"auto",required:""},null,8,["modelValue","onUpdate:modelValue","type","label","suffix","rules"]))])]))),128))]),_:1},512))}}),J=A(H,[["__scopeId","data-v-1c0f10eb"]]);export{J as T};
