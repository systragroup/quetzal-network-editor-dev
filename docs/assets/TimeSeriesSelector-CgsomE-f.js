import{an as B,u as R,b8 as T,c as D,al as v,r as f,w as M,g as d,f as u,h as E,e as b,H as $,I as z,A,D as V,k as I,L as h,W as y,i as x,a1 as o,l as r,$ as L,cA as k,_ as G}from"./index-CVO2KWKY.js";import{g as p}from"./form-B2uRhppC.js";const H={class:"params-row"},W=B({__name:"TimeSeriesSelector",props:{modelValue:{default:[]},modelModifiers:{}},emits:["update:modelValue"],setup(g,{expose:w}){const{$gettext:s}=R(),m=T(g,"modelValue");D(()=>{m.value.forEach(t=>{const a=v.cloneDeep(c);a.start_time.value=t.start_time,a.end_time.value=t.end_time,a.period.value=t.value,l.value.push(a)})});const c={start_time:{label:"start time",value:"",type:"time",rules:["required"]},end_time:{label:"end time",value:"",type:"time",rules:["required"]},period:{label:"period name",value:"",type:"string",rules:["required",N],disabled:!1}},l=f([]);function q(){const t=v.cloneDeep(c);l.value.push(t)}function F(t){l.value=l.value.filter((a,e)=>e!==t)}M(l,t=>{const a=t[0];t.length==1?(a.period.disabled=!0,a.period.value=""):a.period.disabled=!1,S()},{deep:!0});function S(){const t=l.value.map(a=>({start_time:a.start_time.value,end_time:a.end_time.value,value:a.period.value}));m.value=t}function C(t){return k(t.start_time.value)>k(t.end_time.value)?s("Start time must be smaller than end time"):!0}function N(t){return t!=null&&t.includes("#")?s("field cannot contain #"):l.value.map(e=>e.period.value).filter(e=>e===t).length>1?s("period name must be unique"):!0}const _=f();async function U(){return!!(await _.value.validate()).valid}return w({validate:U}),(t,a)=>(u(),d(L,{ref_key:"formRef",ref:_,"validate-on":"input"},{default:E(()=>[(u(!0),b($,null,z(l.value,(e,n)=>(u(),b("div",{key:n},[A("div",H,[n==0?(u(),d(h,{key:0,icon:"fas fa-plus",size:"x-small",color:"primary",onClick:q})):(u(),d(h,{key:1,icon:"fas fa-trash",size:"x-small",color:"error",onClick:i=>F(n)},null,8,["onClick"])),V(x(o,{modelValue:e.start_time.value,"onUpdate:modelValue":i=>e.start_time.value=i,class:"params",type:e.start_time.type,step:"1",variant:"outlined","validate-on":"input",label:r(s)(e.start_time.label),suffix:e.start_time.units,rules:r(p)(e.start_time.rules),"hide-details":"auto",required:""},null,8,["modelValue","onUpdate:modelValue","type","label","suffix","rules"]),[[y,!e.start_time.disabled]]),V(x(o,{modelValue:e.end_time.value,"onUpdate:modelValue":i=>e.end_time.value=i,class:"params",type:e.end_time.type,step:"1",variant:"outlined",label:r(s)(e.end_time.label),suffix:e.end_time.units,rules:[...r(p)(e.end_time.rules),C(e)],"hide-details":"auto",required:""},null,8,["modelValue","onUpdate:modelValue","type","label","suffix","rules"]),[[y,!e.end_time.disabled]]),e.period.disabled?I("",!0):(u(),d(o,{key:2,modelValue:e.period.value,"onUpdate:modelValue":i=>e.period.value=i,class:"params",type:e.period.type,step:"1",variant:"outlined",label:r(s)(e.period.label),suffix:e.period.units,rules:r(p)(e.period.rules),"hide-details":"auto",required:""},null,8,["modelValue","onUpdate:modelValue","type","label","suffix","rules"]))])]))),128))]),_:1},512))}}),K=G(W,[["__scopeId","data-v-1c0f10eb"]]);export{K as T};
