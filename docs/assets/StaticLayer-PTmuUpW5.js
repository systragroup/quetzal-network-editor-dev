import{_ as kt,c as ne,f as he,l as Jt,g as pe,A as te,H as Qt,I as Vt,E as rt,C as le,b9 as en,ba as tn,r as B,aj as Ce,a as Ke,bb as nn,bc as Q,al as rn,bd as on,t as sn,aa as an,ab as cn,ac as fn,d as ln,o as un,j as dn,m as Ee}from"./index-JvMGzoLv.js";const bn={class:"gradient"},hn={class:"domain-title"},pn={class:"domain-min"},gn={class:"domain-med"},yn={class:"domain-max"},vn={__name:"MapLegend",props:{colorScale:{type:Array,default:()=>[]},displaySettings:{type:Object,default:()=>{}},order:{type:Number,default:()=>0}},setup(e){const t=e,n=ne(()=>50+180*t.order),r=ne(()=>!isNaN(t.displaySettings.minVal)&&!isNaN(t.displaySettings.minVal)),o=ne(()=>{const i=(t.displaySettings.maxVal+t.displaySettings.minVal)/2;return i.toFixed(i>=10?0:1)});return(i,c)=>r.value?(pe(),he("div",{key:0,class:"legend elevation-4",style:rt({left:`${n.value}px !important`})},[te("div",bn,[(pe(!0),he(Qt,null,Vt(e.colorScale,(a,s)=>(pe(),he("span",{key:s,class:"grad-step",style:rt({backgroundColor:a})},null,4))),128)),te("span",hn,le(e.displaySettings.selectedFeature),1),te("span",pn,le(Math.round(e.displaySettings.minVal)),1),te("span",gn,le(o.value),1),te("span",yn,le(Math.round(e.displaySettings.maxVal)),1)])],4)):Jt("",!0)}},mn=kt(vn,[["__scopeId","data-v-c92ed1eb"]]),re=(e,t=0,n=1)=>Ve(et(t,e),n),Qe=e=>{e._clipped=!1,e._unclipped=e.slice(0);for(let t=0;t<=3;t++)t<3?((e[t]<0||e[t]>255)&&(e._clipped=!0),e[t]=re(e[t],0,255)):t===3&&(e[t]=re(e[t],0,1));return e},St={};for(let e of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])St[`[object ${e}]`]=e.toLowerCase();function R(e){return St[Object.prototype.toString.call(e)]||"object"}const q=(e,t=null)=>e.length>=3?Array.prototype.slice.call(e):R(e[0])=="object"&&t?t.split("").filter(n=>e[0][n]!==void 0).map(n=>e[0][n]):e[0],Ne=e=>{if(e.length<2)return null;const t=e.length-1;return R(e[t])=="string"?e[t].toLowerCase():null},{PI:Le,min:Ve,max:et}=Math,U=Le*2,Re=Le/3,wn=Le/180,xn=180/Le,C={format:{},autodetect:[]};class y{constructor(...t){const n=this;if(R(t[0])==="object"&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];let r=Ne(t),o=!1;if(!r){o=!0,C.sorted||(C.autodetect=C.autodetect.sort((i,c)=>c.p-i.p),C.sorted=!0);for(let i of C.autodetect)if(r=i.test(...t),r)break}if(C.format[r]){const i=C.format[r].apply(null,o?t:t.slice(0,-1));n._rgb=Qe(i)}else throw new Error("unknown format: "+t);n._rgb.length===3&&n._rgb.push(1)}toString(){return R(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const _n="2.6.0",E=(...e)=>new E.Color(...e);E.Color=y;E.version=_n;const kn=(...e)=>{e=q(e,"cmyk");const[t,n,r,o]=e,i=e.length>4?e[4]:1;return o===1?[0,0,0,i]:[t>=1?0:255*(1-t)*(1-o),n>=1?0:255*(1-n)*(1-o),r>=1?0:255*(1-r)*(1-o),i]},{max:ot}=Math,Sn=(...e)=>{let[t,n,r]=q(e,"rgb");t=t/255,n=n/255,r=r/255;const o=1-ot(t,ot(n,r)),i=o<1?1/(1-o):0,c=(1-t-o)*i,a=(1-n-o)*i,s=(1-r-o)*i;return[c,a,s,o]};y.prototype.cmyk=function(){return Sn(this._rgb)};E.cmyk=(...e)=>new y(...e,"cmyk");C.format.cmyk=kn;C.autodetect.push({p:2,test:(...e)=>{if(e=q(e,"cmyk"),R(e)==="array"&&e.length===4)return"cmyk"}});const qe=e=>Math.round(e*100)/100,$n=(...e)=>{const t=q(e,"hsla");let n=Ne(e)||"lsa";return t[0]=qe(t[0]||0),t[1]=qe(t[1]*100)+"%",t[2]=qe(t[2]*100)+"%",n==="hsla"||t.length>3&&t[3]<1?(t[3]=t.length>3?t[3]:1,n="hsla"):t.length=3,`${n}(${t.join(",")})`},$t=(...e)=>{e=q(e,"rgba");let[t,n,r]=e;t/=255,n/=255,r/=255;const o=Ve(t,n,r),i=et(t,n,r),c=(i+o)/2;let a,s;return i===o?(a=0,s=Number.NaN):a=c<.5?(i-o)/(i+o):(i-o)/(2-i-o),t==i?s=(n-r)/(i-o):n==i?s=2+(r-t)/(i-o):r==i&&(s=4+(t-n)/(i-o)),s*=60,s<0&&(s+=360),e.length>3&&e[3]!==void 0?[s,a,c,e[3]]:[s,a,c]},{round:je}=Math,Nn=(...e)=>{const t=q(e,"rgba");let n=Ne(e)||"rgb";return n.substr(0,3)=="hsl"?$n($t(t),n):(t[0]=je(t[0]),t[1]=je(t[1]),t[2]=je(t[2]),(n==="rgba"||t.length>3&&t[3]<1)&&(t[3]=t.length>3?t[3]:1,n="rgba"),`${n}(${t.slice(0,n==="rgb"?3:4).join(",")})`)},{round:ze}=Math,Je=(...e)=>{e=q(e,"hsl");const[t,n,r]=e;let o,i,c;if(n===0)o=i=c=r*255;else{const a=[0,0,0],s=[0,0,0],l=r<.5?r*(1+n):r+n-r*n,d=2*r-l,f=t/360;a[0]=f+1/3,a[1]=f,a[2]=f-1/3;for(let u=0;u<3;u++)a[u]<0&&(a[u]+=1),a[u]>1&&(a[u]-=1),6*a[u]<1?s[u]=d+(l-d)*6*a[u]:2*a[u]<1?s[u]=l:3*a[u]<2?s[u]=d+(l-d)*(2/3-a[u])*6:s[u]=d;[o,i,c]=[ze(s[0]*255),ze(s[1]*255),ze(s[2]*255)]}return e.length>3?[o,i,c,e[3]]:[o,i,c,1]},Nt=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,Lt=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,Mt=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,At=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Ct=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Et=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,{round:st}=Math,tt=e=>{e=e.toLowerCase().trim();let t;if(C.format.named)try{return C.format.named(e)}catch{}if(t=e.match(Nt)){const n=t.slice(1,4);for(let r=0;r<3;r++)n[r]=+n[r];return n[3]=1,n}if(t=e.match(Lt)){const n=t.slice(1,5);for(let r=0;r<4;r++)n[r]=+n[r];return n}if(t=e.match(Mt)){const n=t.slice(1,4);for(let r=0;r<3;r++)n[r]=st(n[r]*2.55);return n[3]=1,n}if(t=e.match(At)){const n=t.slice(1,5);for(let r=0;r<3;r++)n[r]=st(n[r]*2.55);return n[3]=+n[3],n}if(t=e.match(Ct)){const n=t.slice(1,4);n[1]*=.01,n[2]*=.01;const r=Je(n);return r[3]=1,r}if(t=e.match(Et)){const n=t.slice(1,4);n[1]*=.01,n[2]*=.01;const r=Je(n);return r[3]=+t[4],r}};tt.test=e=>Nt.test(e)||Lt.test(e)||Mt.test(e)||At.test(e)||Ct.test(e)||Et.test(e);y.prototype.css=function(e){return Nn(this._rgb,e)};E.css=(...e)=>new y(...e,"css");C.format.css=tt;C.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&R(e)==="string"&&tt.test(e))return"css"}});C.format.gl=(...e)=>{const t=q(e,"rgba");return t[0]*=255,t[1]*=255,t[2]*=255,t};E.gl=(...e)=>new y(...e,"gl");y.prototype.gl=function(){const e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};const{floor:Ln}=Math,Mn=(...e)=>{e=q(e,"hcg");let[t,n,r]=e,o,i,c;r=r*255;const a=n*255;if(n===0)o=i=c=r;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const s=Ln(t),l=t-s,d=r*(1-n),f=d+a*(1-l),u=d+a*l,b=d+a;switch(s){case 0:[o,i,c]=[b,u,d];break;case 1:[o,i,c]=[f,b,d];break;case 2:[o,i,c]=[d,b,u];break;case 3:[o,i,c]=[d,f,b];break;case 4:[o,i,c]=[u,d,b];break;case 5:[o,i,c]=[b,d,f];break}}return[o,i,c,e.length>3?e[3]:1]},An=(...e)=>{const[t,n,r]=q(e,"rgb"),o=Ve(t,n,r),i=et(t,n,r),c=i-o,a=c*100/255,s=o/(255-c)*100;let l;return c===0?l=Number.NaN:(t===i&&(l=(n-r)/c),n===i&&(l=2+(r-t)/c),r===i&&(l=4+(t-n)/c),l*=60,l<0&&(l+=360)),[l,a,s]};y.prototype.hcg=function(){return An(this._rgb)};E.hcg=(...e)=>new y(...e,"hcg");C.format.hcg=Mn;C.autodetect.push({p:1,test:(...e)=>{if(e=q(e,"hcg"),R(e)==="array"&&e.length===3)return"hcg"}});const Cn=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,En=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Rt=e=>{if(e.match(Cn)){(e.length===4||e.length===7)&&(e=e.substr(1)),e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16),n=t>>16,r=t>>8&255,o=t&255;return[n,r,o,1]}if(e.match(En)){(e.length===5||e.length===9)&&(e=e.substr(1)),e.length===4&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const t=parseInt(e,16),n=t>>24&255,r=t>>16&255,o=t>>8&255,i=Math.round((t&255)/255*100)/100;return[n,r,o,i]}throw new Error(`unknown hex color: ${e}`)},{round:ue}=Math,qt=(...e)=>{let[t,n,r,o]=q(e,"rgba"),i=Ne(e)||"auto";o===void 0&&(o=1),i==="auto"&&(i=o<1?"rgba":"rgb"),t=ue(t),n=ue(n),r=ue(r);let a="000000"+(t<<16|n<<8|r).toString(16);a=a.substr(a.length-6);let s="0"+ue(o*255).toString(16);switch(s=s.substr(s.length-2),i.toLowerCase()){case"rgba":return`#${a}${s}`;case"argb":return`#${s}${a}`;default:return`#${a}`}};y.prototype.hex=function(e){return qt(this._rgb,e)};E.hex=(...e)=>new y(...e,"hex");C.format.hex=Rt;C.autodetect.push({p:4,test:(e,...t)=>{if(!t.length&&R(e)==="string"&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});const{cos:V}=Math,Rn=(...e)=>{e=q(e,"hsi");let[t,n,r]=e,o,i,c;return isNaN(t)&&(t=0),isNaN(n)&&(n=0),t>360&&(t-=360),t<0&&(t+=360),t/=360,t<1/3?(c=(1-n)/3,o=(1+n*V(U*t)/V(Re-U*t))/3,i=1-(c+o)):t<2/3?(t-=1/3,o=(1-n)/3,i=(1+n*V(U*t)/V(Re-U*t))/3,c=1-(o+i)):(t-=2/3,i=(1-n)/3,c=(1+n*V(U*t)/V(Re-U*t))/3,o=1-(i+c)),o=re(r*o*3),i=re(r*i*3),c=re(r*c*3),[o*255,i*255,c*255,e.length>3?e[3]:1]},{min:qn,sqrt:jn,acos:zn}=Math,On=(...e)=>{let[t,n,r]=q(e,"rgb");t/=255,n/=255,r/=255;let o;const i=qn(t,n,r),c=(t+n+r)/3,a=c>0?1-i/c:0;return a===0?o=NaN:(o=(t-n+(t-r))/2,o/=jn((t-n)*(t-n)+(t-r)*(n-r)),o=zn(o),r>n&&(o=U-o),o/=U),[o*360,a,c]};y.prototype.hsi=function(){return On(this._rgb)};E.hsi=(...e)=>new y(...e,"hsi");C.format.hsi=Rn;C.autodetect.push({p:2,test:(...e)=>{if(e=q(e,"hsi"),R(e)==="array"&&e.length===3)return"hsi"}});y.prototype.hsl=function(){return $t(this._rgb)};E.hsl=(...e)=>new y(...e,"hsl");C.format.hsl=Je;C.autodetect.push({p:2,test:(...e)=>{if(e=q(e,"hsl"),R(e)==="array"&&e.length===3)return"hsl"}});const{floor:Pn}=Math,In=(...e)=>{e=q(e,"hsv");let[t,n,r]=e,o,i,c;if(r*=255,n===0)o=i=c=r;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const a=Pn(t),s=t-a,l=r*(1-n),d=r*(1-n*s),f=r*(1-n*(1-s));switch(a){case 0:[o,i,c]=[r,f,l];break;case 1:[o,i,c]=[d,r,l];break;case 2:[o,i,c]=[l,r,f];break;case 3:[o,i,c]=[l,d,r];break;case 4:[o,i,c]=[f,l,r];break;case 5:[o,i,c]=[r,l,d];break}}return[o,i,c,e.length>3?e[3]:1]},{min:Xn,max:Fn}=Math,Gn=(...e)=>{e=q(e,"rgb");let[t,n,r]=e;const o=Xn(t,n,r),i=Fn(t,n,r),c=i-o;let a,s,l;return l=i/255,i===0?(a=Number.NaN,s=0):(s=c/i,t===i&&(a=(n-r)/c),n===i&&(a=2+(r-t)/c),r===i&&(a=4+(t-n)/c),a*=60,a<0&&(a+=360)),[a,s,l]};y.prototype.hsv=function(){return Gn(this._rgb)};E.hsv=(...e)=>new y(...e,"hsv");C.format.hsv=In;C.autodetect.push({p:2,test:(...e)=>{if(e=q(e,"hsv"),R(e)==="array"&&e.length===3)return"hsv"}});const G={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},{pow:Bn}=Math,jt=(...e)=>{e=q(e,"lab");const[t,n,r]=e;let o,i,c,a,s,l;return i=(t+16)/116,o=isNaN(n)?i:i+n/500,c=isNaN(r)?i:i-r/200,i=G.Yn*Pe(i),o=G.Xn*Pe(o),c=G.Zn*Pe(c),a=Oe(3.2404542*o-1.5371385*i-.4985314*c),s=Oe(-.969266*o+1.8760108*i+.041556*c),l=Oe(.0556434*o-.2040259*i+1.0572252*c),[a,s,l,e.length>3?e[3]:1]},Oe=e=>255*(e<=.00304?12.92*e:1.055*Bn(e,1/2.4)-.055),Pe=e=>e>G.t1?e*e*e:G.t2*(e-G.t0),{pow:zt}=Math,Ot=(...e)=>{const[t,n,r]=q(e,"rgb"),[o,i,c]=Tn(t,n,r),a=116*i-16;return[a<0?0:a,500*(o-i),200*(i-c)]},Ie=e=>(e/=255)<=.04045?e/12.92:zt((e+.055)/1.055,2.4),Xe=e=>e>G.t3?zt(e,1/3):e/G.t2+G.t0,Tn=(e,t,n)=>{e=Ie(e),t=Ie(t),n=Ie(n);const r=Xe((.4124564*e+.3575761*t+.1804375*n)/G.Xn),o=Xe((.2126729*e+.7151522*t+.072175*n)/G.Yn),i=Xe((.0193339*e+.119192*t+.9503041*n)/G.Zn);return[r,o,i]};y.prototype.lab=function(){return Ot(this._rgb)};E.lab=(...e)=>new y(...e,"lab");C.format.lab=jt;C.autodetect.push({p:2,test:(...e)=>{if(e=q(e,"lab"),R(e)==="array"&&e.length===3)return"lab"}});const{sin:Dn,cos:Yn}=Math,Pt=(...e)=>{let[t,n,r]=q(e,"lch");return isNaN(r)&&(r=0),r=r*wn,[t,Yn(r)*n,Dn(r)*n]},It=(...e)=>{e=q(e,"lch");const[t,n,r]=e,[o,i,c]=Pt(t,n,r),[a,s,l]=jt(o,i,c);return[a,s,l,e.length>3?e[3]:1]},Hn=(...e)=>{const t=q(e,"hcl").reverse();return It(...t)},{sqrt:Wn,atan2:Un,round:Zn}=Math,Xt=(...e)=>{const[t,n,r]=q(e,"lab"),o=Wn(n*n+r*r);let i=(Un(r,n)*xn+360)%360;return Zn(o*1e4)===0&&(i=Number.NaN),[t,o,i]},Ft=(...e)=>{const[t,n,r]=q(e,"rgb"),[o,i,c]=Ot(t,n,r);return Xt(o,i,c)};y.prototype.lch=function(){return Ft(this._rgb)};y.prototype.hcl=function(){return Ft(this._rgb).reverse()};E.lch=(...e)=>new y(...e,"lch");E.hcl=(...e)=>new y(...e,"hcl");C.format.lch=It;C.format.hcl=Hn;["lch","hcl"].forEach(e=>C.autodetect.push({p:2,test:(...t)=>{if(t=q(t,e),R(t)==="array"&&t.length===3)return e}}));const oe={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};y.prototype.name=function(){const e=qt(this._rgb,"rgb");for(let t of Object.keys(oe))if(oe[t]===e)return t.toLowerCase();return e};C.format.named=e=>{if(e=e.toLowerCase(),oe[e])return Rt(oe[e]);throw new Error("unknown color name: "+e)};C.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&R(e)==="string"&&oe[e.toLowerCase()])return"named"}});const Kn=e=>{if(R(e)=="number"&&e>=0&&e<=16777215){const t=e>>16,n=e>>8&255,r=e&255;return[t,n,r,1]}throw new Error("unknown num color: "+e)},Jn=(...e)=>{const[t,n,r]=q(e,"rgb");return(t<<16)+(n<<8)+r};y.prototype.num=function(){return Jn(this._rgb)};E.num=(...e)=>new y(...e,"num");C.format.num=Kn;C.autodetect.push({p:5,test:(...e)=>{if(e.length===1&&R(e[0])==="number"&&e[0]>=0&&e[0]<=16777215)return"num"}});const{round:Gt}=Math;y.prototype.rgb=function(e=!0){return e===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Gt)};y.prototype.rgba=function(e=!0){return this._rgb.slice(0,4).map((t,n)=>n<3?e===!1?t:Gt(t):t)};E.rgb=(...e)=>new y(...e,"rgb");C.format.rgb=(...e)=>{const t=q(e,"rgba");return t[3]===void 0&&(t[3]=1),t};C.autodetect.push({p:3,test:(...e)=>{if(e=q(e,"rgba"),R(e)==="array"&&(e.length===3||e.length===4&&R(e[3])=="number"&&e[3]>=0&&e[3]<=1))return"rgb"}});const{log:de}=Math,Bt=e=>{const t=e/100;let n,r,o;return t<66?(n=255,r=t<6?0:-155.25485562709179-.44596950469579133*(r=t-2)+104.49216199393888*de(r),o=t<20?0:-254.76935184120902+.8274096064007395*(o=t-10)+115.67994401066147*de(o)):(n=351.97690566805693+.114206453784165*(n=t-55)-40.25366309332127*de(n),r=325.4494125711974+.07943456536662342*(r=t-50)-28.0852963507957*de(r),o=255),[n,r,o,1]},{round:Qn}=Math,Vn=(...e)=>{const t=q(e,"rgb"),n=t[0],r=t[2];let o=1e3,i=4e4;const c=.4;let a;for(;i-o>c;){a=(i+o)*.5;const s=Bt(a);s[2]/s[0]>=r/n?i=a:o=a}return Qn(a)};y.prototype.temp=y.prototype.kelvin=y.prototype.temperature=function(){return Vn(this._rgb)};E.temp=E.kelvin=E.temperature=(...e)=>new y(...e,"temp");C.format.temp=C.format.kelvin=C.format.temperature=Bt;const{pow:ge,sign:er}=Math,Tt=(...e)=>{e=q(e,"lab");const[t,n,r]=e,o=ge(t+.3963377774*n+.2158037573*r,3),i=ge(t-.1055613458*n-.0638541728*r,3),c=ge(t-.0894841775*n-1.291485548*r,3);return[255*Fe(4.0767416621*o-3.3077115913*i+.2309699292*c),255*Fe(-1.2684380046*o+2.6097574011*i-.3413193965*c),255*Fe(-.0041960863*o-.7034186147*i+1.707614701*c),e.length>3?e[3]:1]};function Fe(e){const t=Math.abs(e);return t>.0031308?(er(e)||1)*(1.055*ge(t,1/2.4)-.055):e*12.92}const{cbrt:Ge,pow:tr,sign:nr}=Math,Dt=(...e)=>{const[t,n,r]=q(e,"rgb"),[o,i,c]=[Be(t/255),Be(n/255),Be(r/255)],a=Ge(.4122214708*o+.5363325363*i+.0514459929*c),s=Ge(.2119034982*o+.6806995451*i+.1073969566*c),l=Ge(.0883024619*o+.2817188376*i+.6299787005*c);return[.2104542553*a+.793617785*s-.0040720468*l,1.9779984951*a-2.428592205*s+.4505937099*l,.0259040371*a+.7827717662*s-.808675766*l]};function Be(e){const t=Math.abs(e);return t<.04045?e/12.92:(nr(e)||1)*tr((t+.055)/1.055,2.4)}y.prototype.oklab=function(){return Dt(this._rgb)};E.oklab=(...e)=>new y(...e,"oklab");C.format.oklab=Tt;C.autodetect.push({p:3,test:(...e)=>{if(e=q(e,"oklab"),R(e)==="array"&&e.length===3)return"oklab"}});const rr=(...e)=>{e=q(e,"lch");const[t,n,r]=e,[o,i,c]=Pt(t,n,r),[a,s,l]=Tt(o,i,c);return[a,s,l,e.length>3?e[3]:1]},or=(...e)=>{const[t,n,r]=q(e,"rgb"),[o,i,c]=Dt(t,n,r);return Xt(o,i,c)};y.prototype.oklch=function(){return or(this._rgb)};E.oklch=(...e)=>new y(...e,"oklch");C.format.oklch=rr;C.autodetect.push({p:3,test:(...e)=>{if(e=q(e,"oklch"),R(e)==="array"&&e.length===3)return"oklch"}});y.prototype.alpha=function(e,t=!1){return e!==void 0&&R(e)==="number"?t?(this._rgb[3]=e,this):new y([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]};y.prototype.clipped=function(){return this._rgb._clipped||!1};y.prototype.darken=function(e=1){const t=this,n=t.lab();return n[0]-=G.Kn*e,new y(n,"lab").alpha(t.alpha(),!0)};y.prototype.brighten=function(e=1){return this.darken(-e)};y.prototype.darker=y.prototype.darken;y.prototype.brighter=y.prototype.brighten;y.prototype.get=function(e){const[t,n]=e.split("."),r=this[t]();if(n){const o=t.indexOf(n)-(t.substr(0,2)==="ok"?2:0);if(o>-1)return r[o];throw new Error(`unknown channel ${n} in mode ${t}`)}else return r};const{pow:sr}=Math,ar=1e-7,cr=20;y.prototype.luminance=function(e,t="rgb"){if(e!==void 0&&R(e)==="number"){if(e===0)return new y([0,0,0,this._rgb[3]],"rgb");if(e===1)return new y([255,255,255,this._rgb[3]],"rgb");let n=this.luminance(),r=cr;const o=(c,a)=>{const s=c.interpolate(a,.5,t),l=s.luminance();return Math.abs(e-l)<ar||!r--?s:l>e?o(c,s):o(s,a)},i=(n>e?o(new y([0,0,0]),this):o(this,new y([255,255,255]))).rgb();return new y([...i,this._rgb[3]])}return ir(...this._rgb.slice(0,3))};const ir=(e,t,n)=>(e=Te(e),t=Te(t),n=Te(n),.2126*e+.7152*t+.0722*n),Te=e=>(e/=255,e<=.03928?e/12.92:sr((e+.055)/1.055,2.4)),F={},ie=(e,t,n=.5,...r)=>{let o=r[0]||"lrgb";if(!F[o]&&!r.length&&(o=Object.keys(F)[0]),!F[o])throw new Error(`interpolation mode ${o} is not defined`);return R(e)!=="object"&&(e=new y(e)),R(t)!=="object"&&(t=new y(t)),F[o](e,t,n).alpha(e.alpha()+n*(t.alpha()-e.alpha()))};y.prototype.mix=y.prototype.interpolate=function(e,t=.5,...n){return ie(this,e,t,...n)};y.prototype.premultiply=function(e=!1){const t=this._rgb,n=t[3];return e?(this._rgb=[t[0]*n,t[1]*n,t[2]*n,n],this):new y([t[0]*n,t[1]*n,t[2]*n,n],"rgb")};y.prototype.saturate=function(e=1){const t=this,n=t.lch();return n[1]+=G.Kn*e,n[1]<0&&(n[1]=0),new y(n,"lch").alpha(t.alpha(),!0)};y.prototype.desaturate=function(e=1){return this.saturate(-e)};y.prototype.set=function(e,t,n=!1){const[r,o]=e.split("."),i=this[r]();if(o){const c=r.indexOf(o)-(r.substr(0,2)==="ok"?2:0);if(c>-1){if(R(t)=="string")switch(t.charAt(0)){case"+":i[c]+=+t;break;case"-":i[c]+=+t;break;case"*":i[c]*=+t.substr(1);break;case"/":i[c]/=+t.substr(1);break;default:i[c]=+t}else if(R(t)==="number")i[c]=t;else throw new Error("unsupported value for Color.set");const a=new y(i,r);return n?(this._rgb=a._rgb,this):a}throw new Error(`unknown channel ${o} in mode ${r}`)}else return i};y.prototype.tint=function(e=.5,...t){return ie(this,"white",e,...t)};y.prototype.shade=function(e=.5,...t){return ie(this,"black",e,...t)};const fr=(e,t,n)=>{const r=e._rgb,o=t._rgb;return new y(r[0]+n*(o[0]-r[0]),r[1]+n*(o[1]-r[1]),r[2]+n*(o[2]-r[2]),"rgb")};F.rgb=fr;const{sqrt:De,pow:ee}=Math,lr=(e,t,n)=>{const[r,o,i]=e._rgb,[c,a,s]=t._rgb;return new y(De(ee(r,2)*(1-n)+ee(c,2)*n),De(ee(o,2)*(1-n)+ee(a,2)*n),De(ee(i,2)*(1-n)+ee(s,2)*n),"rgb")};F.lrgb=lr;const ur=(e,t,n)=>{const r=e.lab(),o=t.lab();return new y(r[0]+n*(o[0]-r[0]),r[1]+n*(o[1]-r[1]),r[2]+n*(o[2]-r[2]),"lab")};F.lab=ur;const se=(e,t,n,r)=>{let o,i;r==="hsl"?(o=e.hsl(),i=t.hsl()):r==="hsv"?(o=e.hsv(),i=t.hsv()):r==="hcg"?(o=e.hcg(),i=t.hcg()):r==="hsi"?(o=e.hsi(),i=t.hsi()):r==="lch"||r==="hcl"?(r="hcl",o=e.hcl(),i=t.hcl()):r==="oklch"&&(o=e.oklch().reverse(),i=t.oklch().reverse());let c,a,s,l,d,f;(r.substr(0,1)==="h"||r==="oklch")&&([c,s,d]=o,[a,l,f]=i);let u,b,v,L;return!isNaN(c)&&!isNaN(a)?(a>c&&a-c>180?L=a-(c+360):a<c&&c-a>180?L=a+360-c:L=a-c,b=c+n*L):isNaN(c)?isNaN(a)?b=Number.NaN:(b=a,(d==1||d==0)&&r!="hsv"&&(u=l)):(b=c,(f==1||f==0)&&r!="hsv"&&(u=s)),u===void 0&&(u=s+n*(l-s)),v=d+n*(f-d),r==="oklch"?new y([v,u,b],r):new y([b,u,v],r)},Yt=(e,t,n)=>se(e,t,n,"lch");F.lch=Yt;F.hcl=Yt;const dr=(e,t,n)=>{const r=e.num(),o=t.num();return new y(r+n*(o-r),"num")};F.num=dr;const br=(e,t,n)=>se(e,t,n,"hcg");F.hcg=br;const hr=(e,t,n)=>se(e,t,n,"hsi");F.hsi=hr;const pr=(e,t,n)=>se(e,t,n,"hsl");F.hsl=pr;const gr=(e,t,n)=>se(e,t,n,"hsv");F.hsv=gr;const yr=(e,t,n)=>{const r=e.oklab(),o=t.oklab();return new y(r[0]+n*(o[0]-r[0]),r[1]+n*(o[1]-r[1]),r[2]+n*(o[2]-r[2]),"oklab")};F.oklab=yr;const vr=(e,t,n)=>se(e,t,n,"oklch");F.oklch=vr;const{pow:Ye,sqrt:He,PI:We,cos:at,sin:ct,atan2:mr}=Math,wr=(e,t="lrgb",n=null)=>{const r=e.length;n||(n=Array.from(new Array(r)).map(()=>1));const o=r/n.reduce(function(f,u){return f+u});if(n.forEach((f,u)=>{n[u]*=o}),e=e.map(f=>new y(f)),t==="lrgb")return xr(e,n);const i=e.shift(),c=i.get(t),a=[];let s=0,l=0;for(let f=0;f<c.length;f++)if(c[f]=(c[f]||0)*n[0],a.push(isNaN(c[f])?0:n[0]),t.charAt(f)==="h"&&!isNaN(c[f])){const u=c[f]/180*We;s+=at(u)*n[0],l+=ct(u)*n[0]}let d=i.alpha()*n[0];e.forEach((f,u)=>{const b=f.get(t);d+=f.alpha()*n[u+1];for(let v=0;v<c.length;v++)if(!isNaN(b[v]))if(a[v]+=n[u+1],t.charAt(v)==="h"){const L=b[v]/180*We;s+=at(L)*n[u+1],l+=ct(L)*n[u+1]}else c[v]+=b[v]*n[u+1]});for(let f=0;f<c.length;f++)if(t.charAt(f)==="h"){let u=mr(l/a[f],s/a[f])/We*180;for(;u<0;)u+=360;for(;u>=360;)u-=360;c[f]=u}else c[f]=c[f]/a[f];return d/=r,new y(c,t).alpha(d>.99999?1:d,!0)},xr=(e,t)=>{const n=e.length,r=[0,0,0,0];for(let o=0;o<e.length;o++){const i=e[o],c=t[o]/n,a=i._rgb;r[0]+=Ye(a[0],2)*c,r[1]+=Ye(a[1],2)*c,r[2]+=Ye(a[2],2)*c,r[3]+=a[3]*c}return r[0]=He(r[0]),r[1]=He(r[1]),r[2]=He(r[2]),r[3]>.9999999&&(r[3]=1),new y(Qe(r))},{pow:_r}=Math;function $e(e){let t="rgb",n=E("#ccc"),r=0,o=[0,1],i=[],c=[0,0],a=!1,s=[],l=!1,d=0,f=1,u=!1,b={},v=!0,L=1;const $=function(h){if(h=h||["#fff","#000"],h&&R(h)==="string"&&E.brewer&&E.brewer[h.toLowerCase()]&&(h=E.brewer[h.toLowerCase()]),R(h)==="array"){h.length===1&&(h=[h[0],h[0]]),h=h.slice(0);for(let m=0;m<h.length;m++)h[m]=E(h[m]);i.length=0;for(let m=0;m<h.length;m++)i.push(m/(h.length-1))}return A(),s=h},_=function(h){if(a!=null){const m=a.length-1;let S=0;for(;S<m&&h>=a[S];)S++;return S-1}return 0};let O=h=>h,I=h=>h;const M=function(h,m){let S,x;if(m==null&&(m=!1),isNaN(h)||h===null)return n;m?x=h:a&&a.length>2?x=_(h)/(a.length-2):f!==d?x=(h-d)/(f-d):x=1,x=I(x),m||(x=O(x)),L!==1&&(x=_r(x,L)),x=c[0]+x*(1-c[0]-c[1]),x=re(x,0,1);const N=Math.floor(x*1e4);if(v&&b[N])S=b[N];else{if(R(s)==="array")for(let g=0;g<i.length;g++){const p=i[g];if(x<=p){S=s[g];break}if(x>=p&&g===i.length-1){S=s[g];break}if(x>p&&x<i[g+1]){x=(x-p)/(i[g+1]-p),S=E.interpolate(s[g],s[g+1],x,t);break}}else R(s)==="function"&&(S=s(x));v&&(b[N]=S)}return S};var A=()=>b={};$(e);const k=function(h){const m=E(M(h));return l&&m[l]?m[l]():m};return k.classes=function(h){if(h!=null){if(R(h)==="array")a=h,o=[h[0],h[h.length-1]];else{const m=E.analyze(o);h===0?a=[m.min,m.max]:a=E.limits(m,"e",h)}return k}return a},k.domain=function(h){if(!arguments.length)return o;d=h[0],f=h[h.length-1],i=[];const m=s.length;if(h.length===m&&d!==f)for(let S of Array.from(h))i.push((S-d)/(f-d));else{for(let S=0;S<m;S++)i.push(S/(m-1));if(h.length>2){const S=h.map((N,g)=>g/(h.length-1)),x=h.map(N=>(N-d)/(f-d));x.every((N,g)=>S[g]===N)||(I=N=>{if(N<=0||N>=1)return N;let g=0;for(;N>=x[g+1];)g++;const p=(N-x[g])/(x[g+1]-x[g]);return S[g]+p*(S[g+1]-S[g])})}}return o=[d,f],k},k.mode=function(h){return arguments.length?(t=h,A(),k):t},k.range=function(h,m){return $(h),k},k.out=function(h){return l=h,k},k.spread=function(h){return arguments.length?(r=h,k):r},k.correctLightness=function(h){return h==null&&(h=!0),u=h,A(),u?O=function(m){const S=M(0,!0).lab()[0],x=M(1,!0).lab()[0],N=S>x;let g=M(m,!0).lab()[0];const p=S+(x-S)*m;let w=g-p,j=0,z=1,D=20;for(;Math.abs(w)>.01&&D-- >0;)(function(){return N&&(w*=-1),w<0?(j=m,m+=(z-m)*.5):(z=m,m+=(j-m)*.5),g=M(m,!0).lab()[0],w=g-p})();return m}:O=m=>m,k},k.padding=function(h){return h!=null?(R(h)==="number"&&(h=[h,h]),c=h,k):c},k.colors=function(h,m){arguments.length<2&&(m="hex");let S=[];if(arguments.length===0)S=s.slice(0);else if(h===1)S=[k(.5)];else if(h>1){const x=o[0],N=o[1]-x;S=kr(0,h).map(g=>k(x+g/(h-1)*N))}else{e=[];let x=[];if(a&&a.length>2)for(let N=1,g=a.length,p=1<=g;p?N<g:N>g;p?N++:N--)x.push((a[N-1]+a[N])*.5);else x=o;S=x.map(N=>k(N))}return E[m]&&(S=S.map(x=>x[m]())),S},k.cache=function(h){return h!=null?(v=h,k):v},k.gamma=function(h){return h!=null?(L=h,k):L},k.nodata=function(h){return h!=null?(n=E(h),k):n},k}function kr(e,t,n){let r=[],o=e<t,i=t;for(let c=e;o?c<i:c>i;o?c++:c--)r.push(c);return r}const Sr=function(e){let t=[1,1];for(let n=1;n<e;n++){let r=[1];for(let o=1;o<=t.length;o++)r[o]=(t[o]||0)+t[o-1];t=r}return t},$r=function(e){let t,n,r,o;if(e=e.map(i=>new y(i)),e.length===2)[n,r]=e.map(i=>i.lab()),t=function(i){const c=[0,1,2].map(a=>n[a]+i*(r[a]-n[a]));return new y(c,"lab")};else if(e.length===3)[n,r,o]=e.map(i=>i.lab()),t=function(i){const c=[0,1,2].map(a=>(1-i)*(1-i)*n[a]+2*(1-i)*i*r[a]+i*i*o[a]);return new y(c,"lab")};else if(e.length===4){let i;[n,r,o,i]=e.map(c=>c.lab()),t=function(c){const a=[0,1,2].map(s=>(1-c)*(1-c)*(1-c)*n[s]+3*(1-c)*(1-c)*c*r[s]+3*(1-c)*c*c*o[s]+c*c*c*i[s]);return new y(a,"lab")}}else if(e.length>=5){let i,c,a;i=e.map(s=>s.lab()),a=e.length-1,c=Sr(a),t=function(s){const l=1-s,d=[0,1,2].map(f=>i.reduce((u,b,v)=>u+c[v]*l**(a-v)*s**v*b[f],0));return new y(d,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return t},Nr=e=>{const t=$r(e);return t.scale=()=>$e(t),t},T=(e,t,n)=>{if(!T[n])throw new Error("unknown blend mode "+n);return T[n](e,t)},Z=e=>(t,n)=>{const r=E(n).rgb(),o=E(t).rgb();return E.rgb(e(r,o))},K=e=>(t,n)=>{const r=[];return r[0]=e(t[0],n[0]),r[1]=e(t[1],n[1]),r[2]=e(t[2],n[2]),r},Lr=e=>e,Mr=(e,t)=>e*t/255,Ar=(e,t)=>e>t?t:e,Cr=(e,t)=>e>t?e:t,Er=(e,t)=>255*(1-(1-e/255)*(1-t/255)),Rr=(e,t)=>t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255)),qr=(e,t)=>255*(1-(1-t/255)/(e/255)),jr=(e,t)=>e===255?255:(e=255*(t/255)/(1-e/255),e>255?255:e);T.normal=Z(K(Lr));T.multiply=Z(K(Mr));T.screen=Z(K(Er));T.overlay=Z(K(Rr));T.darken=Z(K(Ar));T.lighten=Z(K(Cr));T.dodge=Z(K(jr));T.burn=Z(K(qr));const{pow:zr,sin:Or,cos:Pr}=Math;function Ir(e=300,t=-1.5,n=1,r=1,o=[0,1]){let i=0,c;R(o)==="array"?c=o[1]-o[0]:(c=0,o=[o,o]);const a=function(s){const l=U*((e+120)/360+t*s),d=zr(o[0]+c*s,r),u=(i!==0?n[0]+s*i:n)*d*(1-d)/2,b=Pr(l),v=Or(l),L=d+u*(-.14861*b+1.78277*v),$=d+u*(-.29227*b-.90649*v),_=d+u*(1.97294*b);return E(Qe([L*255,$*255,_*255,1]))};return a.start=function(s){return s==null?e:(e=s,a)},a.rotations=function(s){return s==null?t:(t=s,a)},a.gamma=function(s){return s==null?r:(r=s,a)},a.hue=function(s){return s==null?n:(n=s,R(n)==="array"?(i=n[1]-n[0],i===0&&(n=n[1])):i=0,a)},a.lightness=function(s){return s==null?o:(R(s)==="array"?(o=s,c=s[1]-s[0]):(o=[s,s],c=0),a)},a.scale=()=>E.scale(a),a.hue(n),a}const Xr="0123456789abcdef",{floor:Fr,random:Gr}=Math,Br=()=>{let e="#";for(let t=0;t<6;t++)e+=Xr.charAt(Fr(Gr()*16));return new y(e,"hex")},{log:it,pow:Tr,floor:Dr,abs:Yr}=Math;function Ht(e,t=null){const n={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return R(e)==="object"&&(e=Object.values(e)),e.forEach(r=>{t&&R(r)==="object"&&(r=r[t]),r!=null&&!isNaN(r)&&(n.values.push(r),n.sum+=r,r<n.min&&(n.min=r),r>n.max&&(n.max=r),n.count+=1)}),n.domain=[n.min,n.max],n.limits=(r,o)=>Wt(n,r,o),n}function Wt(e,t="equal",n=7){R(e)=="array"&&(e=Ht(e));const{min:r,max:o}=e,i=e.values.sort((a,s)=>a-s);if(n===1)return[r,o];const c=[];if(t.substr(0,1)==="c"&&(c.push(r),c.push(o)),t.substr(0,1)==="e"){c.push(r);for(let a=1;a<n;a++)c.push(r+a/n*(o-r));c.push(o)}else if(t.substr(0,1)==="l"){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");const a=Math.LOG10E*it(r),s=Math.LOG10E*it(o);c.push(r);for(let l=1;l<n;l++)c.push(Tr(10,a+l/n*(s-a)));c.push(o)}else if(t.substr(0,1)==="q"){c.push(r);for(let a=1;a<n;a++){const s=(i.length-1)*a/n,l=Dr(s);if(l===s)c.push(i[l]);else{const d=s-l;c.push(i[l]*(1-d)+i[l+1]*d)}}c.push(o)}else if(t.substr(0,1)==="k"){let a;const s=i.length,l=new Array(s),d=new Array(n);let f=!0,u=0,b=null;b=[],b.push(r);for(let $=1;$<n;$++)b.push(r+$/n*(o-r));for(b.push(o);f;){for(let _=0;_<n;_++)d[_]=0;for(let _=0;_<s;_++){const O=i[_];let I=Number.MAX_VALUE,M;for(let A=0;A<n;A++){const k=Yr(b[A]-O);k<I&&(I=k,M=A),d[M]++,l[_]=M}}const $=new Array(n);for(let _=0;_<n;_++)$[_]=null;for(let _=0;_<s;_++)a=l[_],$[a]===null?$[a]=i[_]:$[a]+=i[_];for(let _=0;_<n;_++)$[_]*=1/d[_];f=!1;for(let _=0;_<n;_++)if($[_]!==b[_]){f=!0;break}b=$,u++,u>200&&(f=!1)}const v={};for(let $=0;$<n;$++)v[$]=[];for(let $=0;$<s;$++)a=l[$],v[a].push(i[$]);let L=[];for(let $=0;$<n;$++)L.push(v[$][0]),L.push(v[$][v[$].length-1]);L=L.sort(($,_)=>$-_),c.push(L[0]);for(let $=1;$<L.length;$+=2){const _=L[$];!isNaN(_)&&c.indexOf(_)===-1&&c.push(_)}}return c}const Hr=(e,t)=>{e=new y(e),t=new y(t);const n=e.luminance(),r=t.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},{sqrt:W,pow:P,min:Wr,max:Ur,atan2:ft,abs:lt,cos:be,sin:ut,exp:Zr,PI:dt}=Math;function Kr(e,t,n=1,r=1,o=1){var i=function(ae){return 360*ae/(2*dt)},c=function(ae){return 2*dt*ae/360};e=new y(e),t=new y(t);const[a,s,l]=Array.from(e.lab()),[d,f,u]=Array.from(t.lab()),b=(a+d)/2,v=W(P(s,2)+P(l,2)),L=W(P(f,2)+P(u,2)),$=(v+L)/2,_=.5*(1-W(P($,7)/(P($,7)+P(25,7)))),O=s*(1+_),I=f*(1+_),M=W(P(O,2)+P(l,2)),A=W(P(I,2)+P(u,2)),k=(M+A)/2,h=i(ft(l,O)),m=i(ft(u,I)),S=h>=0?h:h+360,x=m>=0?m:m+360,N=lt(S-x)>180?(S+x+360)/2:(S+x)/2,g=1-.17*be(c(N-30))+.24*be(c(2*N))+.32*be(c(3*N+6))-.2*be(c(4*N-63));let p=x-S;p=lt(p)<=180?p:x<=S?p+360:p-360,p=2*W(M*A)*ut(c(p)/2);const w=d-a,j=A-M,z=1+.015*P(b-50,2)/W(20+P(b-50,2)),D=1+.045*k,Y=1+.015*k*g,fe=30*Zr(-P((N-275)/25,2)),Ae=-(2*W(P(k,7)/(P(k,7)+P(25,7))))*ut(2*c(fe)),J=W(P(w/(n*z),2)+P(j/(r*D),2)+P(p/(o*Y),2)+Ae*(j/(r*D))*(p/(o*Y)));return Ur(0,Wr(100,J))}function Jr(e,t,n="lab"){e=new y(e),t=new y(t);const r=e.get(n),o=t.get(n);let i=0;for(let c in r){const a=(r[c]||0)-(o[c]||0);i+=a*a}return Math.sqrt(i)}const Qr=(...e)=>{try{return new y(...e),!0}catch{return!1}},Vr={cool(){return $e([E.hsl(180,1,.9),E.hsl(250,.7,.4)])},hot(){return $e(["#000","#f00","#ff0","#fff"]).mode("rgb")}},ye={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};for(let e of Object.keys(ye))ye[e.toLowerCase()]=ye[e];Object.assign(E,{average:wr,bezier:Nr,blend:T,cubehelix:Ir,mix:ie,interpolate:ie,random:Br,scale:$e,analyze:Ht,contrast:Hr,deltaE:Kr,distance:Jr,limits:Wt,valid:Qr,scales:Vr,input:C,colors:oe,brewer:ye});var ve={exports:{}},eo=ve.exports,bt;function to(){return bt||(bt=1,function(e){(function(t,n,r){function o(s){var l=this,d=a();l.next=function(){var f=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=f|0)},l.c=1,l.s0=d(" "),l.s1=d(" "),l.s2=d(" "),l.s0-=d(s),l.s0<0&&(l.s0+=1),l.s1-=d(s),l.s1<0&&(l.s1+=1),l.s2-=d(s),l.s2<0&&(l.s2+=1),d=null}function i(s,l){return l.c=s.c,l.s0=s.s0,l.s1=s.s1,l.s2=s.s2,l}function c(s,l){var d=new o(s),f=l&&l.state,u=d.next;return u.int32=function(){return d.next()*4294967296|0},u.double=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.quick=u,f&&(typeof f=="object"&&i(f,d),u.state=function(){return i(d,{})}),u}function a(){var s=4022871197,l=function(d){d=String(d);for(var f=0;f<d.length;f++){s+=d.charCodeAt(f);var u=.02519603282416938*s;s=u>>>0,u-=s,u*=s,s=u>>>0,u-=s,s+=u*4294967296}return(s>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=c:this.alea=c})(eo,e)}(ve)),ve.exports}var me={exports:{}},no=me.exports,ht;function ro(){return ht||(ht=1,function(e){(function(t,n,r){function o(a){var s=this,l="";s.x=0,s.y=0,s.z=0,s.w=0,s.next=function(){var f=s.x^s.x<<11;return s.x=s.y,s.y=s.z,s.z=s.w,s.w^=s.w>>>19^f^f>>>8},a===(a|0)?s.x=a:l+=a;for(var d=0;d<l.length+64;d++)s.x^=l.charCodeAt(d)|0,s.next()}function i(a,s){return s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w,s}function c(a,s){var l=new o(a),d=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var u=l.next()>>>11,b=(l.next()>>>0)/4294967296,v=(u+b)/(1<<21);while(v===0);return v},f.int32=l.next,f.quick=f,d&&(typeof d=="object"&&i(d,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=c:this.xor128=c})(no,e)}(me)),me.exports}var we={exports:{}},oo=we.exports,pt;function so(){return pt||(pt=1,function(e){(function(t,n,r){function o(a){var s=this,l="";s.next=function(){var f=s.x^s.x>>>2;return s.x=s.y,s.y=s.z,s.z=s.w,s.w=s.v,(s.d=s.d+362437|0)+(s.v=s.v^s.v<<4^(f^f<<1))|0},s.x=0,s.y=0,s.z=0,s.w=0,s.v=0,a===(a|0)?s.x=a:l+=a;for(var d=0;d<l.length+64;d++)s.x^=l.charCodeAt(d)|0,d==l.length&&(s.d=s.x<<10^s.x>>>4),s.next()}function i(a,s){return s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w,s.v=a.v,s.d=a.d,s}function c(a,s){var l=new o(a),d=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var u=l.next()>>>11,b=(l.next()>>>0)/4294967296,v=(u+b)/(1<<21);while(v===0);return v},f.int32=l.next,f.quick=f,d&&(typeof d=="object"&&i(d,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=c:this.xorwow=c})(oo,e)}(we)),we.exports}var xe={exports:{}},ao=xe.exports,gt;function co(){return gt||(gt=1,function(e){(function(t,n,r){function o(a){var s=this;s.next=function(){var d=s.x,f=s.i,u,b;return u=d[f],u^=u>>>7,b=u^u<<24,u=d[f+1&7],b^=u^u>>>10,u=d[f+3&7],b^=u^u>>>3,u=d[f+4&7],b^=u^u<<7,u=d[f+7&7],u=u^u<<13,b^=u^u<<9,d[f]=b,s.i=f+1&7,b};function l(d,f){var u,b=[];if(f===(f|0))b[0]=f;else for(f=""+f,u=0;u<f.length;++u)b[u&7]=b[u&7]<<15^f.charCodeAt(u)+b[u+1&7]<<13;for(;b.length<8;)b.push(0);for(u=0;u<8&&b[u]===0;++u);for(u==8?b[7]=-1:b[u],d.x=b,d.i=0,u=256;u>0;--u)d.next()}l(s,a)}function i(a,s){return s.x=a.x.slice(),s.i=a.i,s}function c(a,s){a==null&&(a=+new Date);var l=new o(a),d=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var u=l.next()>>>11,b=(l.next()>>>0)/4294967296,v=(u+b)/(1<<21);while(v===0);return v},f.int32=l.next,f.quick=f,d&&(d.x&&i(d,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=c:this.xorshift7=c})(ao,e)}(xe)),xe.exports}var _e={exports:{}},io=_e.exports,yt;function fo(){return yt||(yt=1,function(e){(function(t,n,r){function o(a){var s=this;s.next=function(){var d=s.w,f=s.X,u=s.i,b,v;return s.w=d=d+1640531527|0,v=f[u+34&127],b=f[u=u+1&127],v^=v<<13,b^=b<<17,v^=v>>>15,b^=b>>>12,v=f[u]=v^b,s.i=u,v+(d^d>>>16)|0};function l(d,f){var u,b,v,L,$,_=[],O=128;for(f===(f|0)?(b=f,f=null):(f=f+"\0",b=0,O=Math.max(O,f.length)),v=0,L=-32;L<O;++L)f&&(b^=f.charCodeAt((L+32)%f.length)),L===0&&($=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,L>=0&&($=$+1640531527|0,u=_[L&127]^=b+$,v=u==0?v+1:0);for(v>=128&&(_[(f&&f.length||0)&127]=-1),v=127,L=4*128;L>0;--L)b=_[v+34&127],u=_[v=v+1&127],b^=b<<13,u^=u<<17,b^=b>>>15,u^=u>>>12,_[v]=b^u;d.w=$,d.X=_,d.i=v}l(s,a)}function i(a,s){return s.i=a.i,s.w=a.w,s.X=a.X.slice(),s}function c(a,s){a==null&&(a=+new Date);var l=new o(a),d=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var u=l.next()>>>11,b=(l.next()>>>0)/4294967296,v=(u+b)/(1<<21);while(v===0);return v},f.int32=l.next,f.quick=f,d&&(d.X&&i(d,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=c:this.xor4096=c})(io,e)}(_e)),_e.exports}var ke={exports:{}},lo=ke.exports,vt;function uo(){return vt||(vt=1,function(e){(function(t,n,r){function o(a){var s=this,l="";s.next=function(){var f=s.b,u=s.c,b=s.d,v=s.a;return f=f<<25^f>>>7^u,u=u-b|0,b=b<<24^b>>>8^v,v=v-f|0,s.b=f=f<<20^f>>>12^u,s.c=u=u-b|0,s.d=b<<16^u>>>16^v,s.a=v-f|0},s.a=0,s.b=0,s.c=-1640531527,s.d=1367130551,a===Math.floor(a)?(s.a=a/4294967296|0,s.b=a|0):l+=a;for(var d=0;d<l.length+20;d++)s.b^=l.charCodeAt(d)|0,s.next()}function i(a,s){return s.a=a.a,s.b=a.b,s.c=a.c,s.d=a.d,s}function c(a,s){var l=new o(a),d=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var u=l.next()>>>11,b=(l.next()>>>0)/4294967296,v=(u+b)/(1<<21);while(v===0);return v},f.int32=l.next,f.quick=f,d&&(typeof d=="object"&&i(d,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=c:this.tychei=c})(lo,e)}(ke)),ke.exports}var Se={exports:{}},bo=Se.exports,mt;function ho(){return mt||(mt=1,function(e){(function(t,n,r){var o=256,i=6,c=52,a="random",s=r.pow(o,i),l=r.pow(2,c),d=l*2,f=o-1,u;function b(M,A,k){var h=[];A=A==!0?{entropy:!0}:A||{};var m=_($(A.entropy?[M,I(n)]:M??O(),3),h),S=new v(h),x=function(){for(var N=S.g(i),g=s,p=0;N<l;)N=(N+p)*o,g*=o,p=S.g(1);for(;N>=d;)N/=2,g/=2,p>>>=1;return(N+p)/g};return x.int32=function(){return S.g(4)|0},x.quick=function(){return S.g(4)/4294967296},x.double=x,_(I(S.S),n),(A.pass||k||function(N,g,p,w){return w&&(w.S&&L(w,S),N.state=function(){return L(S,{})}),p?(r[a]=N,g):N})(x,m,"global"in A?A.global:this==r,A.state)}function v(M){var A,k=M.length,h=this,m=0,S=h.i=h.j=0,x=h.S=[];for(k||(M=[k++]);m<o;)x[m]=m++;for(m=0;m<o;m++)x[m]=x[S=f&S+M[m%k]+(A=x[m])],x[S]=A;(h.g=function(N){for(var g,p=0,w=h.i,j=h.j,z=h.S;N--;)g=z[w=f&w+1],p=p*o+z[f&(z[w]=z[j=f&j+g])+(z[j]=g)];return h.i=w,h.j=j,p})(o)}function L(M,A){return A.i=M.i,A.j=M.j,A.S=M.S.slice(),A}function $(M,A){var k=[],h=typeof M,m;if(A&&h=="object")for(m in M)try{k.push($(M[m],A-1))}catch{}return k.length?k:h=="string"?M:M+"\0"}function _(M,A){for(var k=M+"",h,m=0;m<k.length;)A[f&m]=f&(h^=A[f&m]*19)+k.charCodeAt(m++);return I(A)}function O(){try{var M;return u&&(M=u.randomBytes)?M=M(o):(M=new Uint8Array(o),(t.crypto||t.msCrypto).getRandomValues(M)),I(M)}catch{var A=t.navigator,k=A&&A.plugins;return[+new Date,t,k,t.screen,I(n)]}}function I(M){return String.fromCharCode.apply(0,M)}if(_(r.random(),n),e.exports){e.exports=b;try{u=en}catch{}}else r["seed"+a]=b})(typeof self<"u"?self:bo,[],Math)}(Se)),Se.exports}var Ue,wt;function po(){if(wt)return Ue;wt=1;var e=to(),t=ro(),n=so(),r=co(),o=fo(),i=uo(),c=ho();return c.alea=e,c.xor128=t,c.xorwow=n,c.xorshift7=r,c.xor4096=o,c.tychei=i,Ue=c,Ue}var go=po();const yo=tn(go),xt=e=>e,_t={selectedFeature:"",maxWidth:10,minWidth:1,numStep:100,scale:"linear",fixScale:!1,minVal:0,maxVal:1,cmap:"OrRd",opacity:100,offset:!1,showNaN:!0,reverseColor:!1,extrusion:!1,padding:[0,100],labels:""};function vo(e){return/^#([0-9A-Fa-f]{3}){1,2}$/i.test(e)}function Ze(e,t,n,r,o,i){if(typeof e=="string")return i?0:yo(e)();if(i){if(e<t?e=t:e>n&&(e=n),e=Math.abs(e),t<0&&n>0)n=Math.max(Math.abs(t),Math.abs(n)),t=0;else if(t<0&&n<=0){const a=Math.abs(n);n=Math.max(Math.abs(t),a),t=Math.min(Math.abs(t),a)}}else{if(e<t)return r?1:0;if(e>n)return r?0:1;t<0&&(e=e-t,n=n-t,t=0)}let c=e;return o==="log"?(t<1&&(n+=1,e+=1,t+=1),t=t>0?Math.log10(t):0,n=n>0?Math.log10(n):0,c=e>0?Math.log10(e):0):o==="sqrt"?(t=Math.sqrt(t),n=Math.sqrt(n),c=Math.sqrt(e)):o==="exp"?(t=t/n,e=e/n,n=1,t=10**t,n=10**n,c=10**e):o==="quad"&&(t=t**2,n=n**2,c=e**2),r?c=(-c+n)/(n-t):c=(c-t)/(n-t),c}function mo(){const e=B(Q()),t=B(Q()),n=B(Q()),r=B("LineString"),o=B(Ce.cloneDeep(_t)),i=B([]),c=B(""),a=B([]),s=B(!1),l=B({}),d=B({}),f=B("");function u(){e.value=Q(),t.value=Q(),n.value=Q(),r.value="LineString",o.value=Ce.cloneDeep(_t),i.value=[],c.value="",a.value=[],s.value=!1,l.value={},d.value={},f.value=""}function b(g,p,w=null){var z;u(),e.value=g,r.value=(z=e.value.features[0])==null?void 0:z.geometry.type,r.value=r.value==="MultiPolygon"?"Polygon":r.value,r.value!=="Polygon"&&(o.value.extrusion=!1),s.value=typeof p=="object"&&p!==null,s.value&&$(p),h(),w!=null&&w.selectedFilter&&i.value.includes(w.selectedFilter)&&(m(w.selectedFilter),w!=null&&w.selectedCategory&&(a.value=w.selectedCategory));const j=w==null?void 0:w.displaySettings;j&&v(j),A(),k(),nn(e.value)||Ke().changeNotification({text:xt("invalid or missing CRS. use CRS84 / EPSG:4326"),autoClose:!0,color:"warning"})}function v(g){const p=Object.keys(g);for(const w of p)o.value[w]=g[w]}const L=ne(()=>Object.keys(l.value));function $(g){Object.keys(g).forEach(p=>{l.value[`${p} (Interactive)`]=g[p]}),e.value.features.forEach(p=>p.properties.index=String(p.properties.index)),L.value.forEach(p=>{d.value[p]=Object.keys(l.value[p]),e.value.features.forEach(w=>w.properties[p]=null)})}function _(g){const p=o.value.selectedFeature;return p&&L.value.includes(p)?d.value[p].includes(g):!1}function O(g){const p=o.value.selectedFeature;if(p&&L.value.includes(p)&&s.value){f.value=g;const w=l.value[p][f.value];e.value.features.forEach(j=>j.properties[p]=w?w[j.properties.index]:null)}A(),k()}function I(){const g=o.value.selectedFeature,p=o.value.labels;t.value.features=t.value.features.map(w=>{var j;return{type:"Feature",geometry:w.geometry,properties:{[g]:w.properties[g],[p]:w.properties[p],index:(j=w.properties)==null?void 0:j.index}}})}function M(){if(o.value.showNaN)n.value=Q();else{const g=o.value.selectedFeature;n.value.features=t.value.features.filter(w=>!w.properties[g]),e.value.features.filter(w=>w.properties[g]).length===0&&s.value&&Object.keys(d.value).includes(g)||(t.value.features=t.value.features.filter(w=>w.properties[g]))}}function A(){const g=new Set(a.value),p=c.value;t.value.features=e.value.features.filter(w=>g.has(w.properties[p])),I(),r.value==="Polygon"&&M()}function k(){const g=o.value.selectedFeature,p=o.value.maxWidth,w=o.value.minWidth,j=o.value.scale,z=o.value.numStep,D=o.value.cmap,Y=t.value.features.filter(X=>X.properties[g]).map(X=>X.properties[g]);if(!o.value.fixScale){const X=Ut=>Ut.reduce(([Zt,Kt],nt)=>[Math.min(Zt,nt),Math.max(Kt,nt)],[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]),[H,ce]=X(Y);o.value.minVal=Math.round(H*100)/100,o.value.maxVal=Math.round(ce*100)/100}const fe=o.value.minVal,Me=o.value.maxVal,Ae=o.value.reverseColor;t.value.features.forEach(X=>{let H=X.properties[g];H=Ze(H,fe,Me,!1,j,!0),X.properties.display_width=(p-w)*H+w});let J=Ce.cloneDeep(o.value.padding);J=[J[0]/100,1-J[1]/100],o.value.reverseColor&&J.reverse();const ae=E.scale(D).padding(J).domain([0,1],0,j).classes(z);if(t.value.features.forEach(X=>{const H=X.properties[g];vo(H)?X.properties.display_color=H:X.properties.display_color=ae(Ze(H,fe,Me,Ae,j,!1)).hex()}),e.value.features.filter(X=>X.properties[g]).length===0&&s.value&&Object.keys(d.value).includes(g)){const X=new Set(d.value[g]);t.value.features.forEach(ce=>{X.has(ce.properties.index)&&(ce.properties.display_width=10,ce.properties.display_color="#4CAF50")}),Ke().changeNotification({text:xt("Clickable element in green"),autoClose:!0,color:"success"})}}function h(){const g=new Set([]);e.value.features.forEach(p=>{Object.keys(p.properties).forEach(w=>g.add(w))}),i.value=Array.from(g),i.value=i.value.filter(p=>!["display_width","display_color"].includes(p)),c.value=g.has("route_type")?"route_type":g.has("highway")?"highway":i.value[0],a.value=Array.from(new Set(e.value.features.map(p=>p.properties[c.value])))}function m(g){c.value=g,a.value=Array.from(new Set(e.value.features.map(p=>p.properties[c.value])))}function S(g){a.value=g}const x=ne(()=>{let g=Array.from(new Set(e.value.features.map(p=>p.properties[c.value])));return g=g.sort((p,w)=>p-w),g}),N=ne(()=>{const g=[];let p=o.value.padding;p=[p[0]/100,1-p[1]/100],o.value.reverseColor&&p.reverse();const w=E.scale(o.value.cmap).padding(p).domain([0,1]).classes(o.value.numStep);for(let j=0;j<100;j++)g.push(w(Ze(j,0,100,o.value.reverseColor,o.value.scale,!1)));return g});return{layer:e,type:r,attributes:i,visibleLayer:t,nanLayer:n,displaySettings:o,selectedFilter:c,selectedCategory:a,hasOD:s,attributesWithOD:L,matAvailableIndex:d,matSelectedIndex:f,changeOD:O,isIndexAvailable:_,loadLayer:b,getLayerProperties:h,refreshVisibleLinks:A,updateSelectedFeature:k,changeSelectedFilter:m,changeSelectedCategory:S,applySettings:v,filteredCategory:x,colorScale:N}}const wo={class:"map-legend"},xo=rn({__name:"StaticLayer",props:{preset:{},map:{},order:{},visibleRasters:{}},setup(e){const t=on(),n=e,{preset:r,map:o,order:i,visibleRasters:c}=sn(n),a=an(),s=cn(),l=fn(),d=Ke(),f=r.value.name,u=f+"-source",b=f+"-layer",v=f+"-labels",{visibleLayer:L,type:$,loadLayer:_,displaySettings:O,colorScale:I,isIndexAvailable:M,changeOD:A}=mo(),k=r.value.displaySettings.opacity,h=r.value.displaySettings.offset?-1:1,m=r.value.displaySettings.labels;async function S(p,w=null){switch(p){case"links":_(a.links,null,w);break;case"rlinks":_(s.rlinks,null,w);break;case"nodes":_(a.nodes,null,w);break;case"rnodes":_(s.rnodes,null,w);break;case"od":_(l.layer,null,w);break;default:const j=await d.getOtherFile(p,"geojson"),z=await d.getOtherFile(p,"json");_(j,z,w);break}}ln(async()=>{var p;await S(r.value.layer,r.value),(p=r.value)!=null&&p.selectedIndex&&M(r.value.selectedIndex)&&(A(r.value.selectedIndex),d.changeNotification({text:""})),L.value.features=L.value.features.map(w=>({type:"Feature",geometry:w.geometry,properties:{display_color:w.properties.display_color,display_width:w.properties.display_width,label:w.properties[m]}})),x(),N()});function x(){o.value.addSource(u,{type:"geojson",data:L.value}),$.value==="LineString"?o.value.addLayer({id:b,type:"line",minzoom:5,source:u,layout:{"line-sort-key":["to-number",["get","display_width"]],"line-cap":"round"},paint:{"line-color":["get","display_color"],"line-opacity":k/100,"line-offset":["*",h*.5,["to-number",["get","display_width"]]],"line-width":["get","display_width"]}}):$.value==="Point"?o.value.addLayer({id:b,type:"circle",minzoom:5,source:u,layout:{"circle-sort-key":["to-number",["get","display_width"]]},paint:{"circle-color":["get","display_color"],"circle-radius":["get","display_width"],"circle-opacity":k/100}}):["MultiPolygon","Polygon"].includes($.value)&&!O.value.extrusion?o.value.addLayer({id:b,type:"fill",minzoom:5,source:u,paint:{"fill-color":["get","display_color"],"fill-opacity":k/100}}):["MultiPolygon","Polygon"].includes($.value)&&O.value.extrusion&&o.value.addLayer({id:b,type:"fill-extrusion",minzoom:5,source:u,paint:{"fill-extrusion-color":["get","display_color"],"fill-extrusion-opacity":k/100,"fill-extrusion-height":["*",1e3,["to-number",["get","display_width"]]]}}),m!==null&&o.value.addLayer({id:v,source:u,type:"symbol",layout:{"text-field":["get","label"],"text-variable-anchor":["top"],"text-radial-offset":.6,"text-justify":"auto"},paint:{"text-color":t.current.value.colors.black}})}function N(){const p=o.value.getStyle();if(!p)return;const w=p.layers.map(Y=>Y.id),j=c.value.indexOf(f);let z=c.value.map(Y=>Y+"-layer").splice(0,j);z=z.filter(Y=>w.includes(Y));const D=z.slice(-1)[0];D?o.value.moveLayer(b,D):g()}function g(){o.value.getLayer("results")?o.value.moveLayer(b,"results"):o.value.getLayer("rlinks")?o.value.moveLayer(b,"rlinks"):o.value.getLayer("links")&&o.value.moveLayer(b,"links")}return un(()=>{o.value.getLayer(v)&&o.value.removeLayer(v),o.value.getLayer(b)&&(o.value.removeLayer(b),o.value.removeSource(u))}),(p,w)=>(pe(),he("section",null,[te("div",wo,[dn(mn,{"color-scale":Ee(I),"display-settings":Ee(O),order:Ee(i)},null,8,["color-scale","display-settings","order"])])]))}}),_o=kt(xo,[["__scopeId","data-v-348167da"]]),$o=Object.freeze(Object.defineProperty({__proto__:null,default:_o},Symbol.toStringTag,{value:"Module"}));export{mn as M,_o as S,$o as a,E as c,mo as u};
