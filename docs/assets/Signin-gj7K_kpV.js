import{_ as g,aO as f,g as a,q as V,j as l,i as o,ab as P,y as n,x as i,ad as h,U as y,Z as u,h as d,l as w,G as k,R as U,a4 as b,L as c}from"./index-8UKB7t9v.js";const m=e=>e,I={name:"Signin",components:{},props:[],emits:["signin"],data(){return{newPasswordUI:!1,user:null,username:"",password:"",newPassword:"",newPasswordConfirm:"",error:"",shake:!1,re:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&_])[A-Za-z\d@$!%*?&_]+$/,rules:{required:e=>!!e||m("Required"),password:e=>this.re.test(e)||m("need at least: 1 lowercase, 1 uppercase, 1 number, and 1 symbol"),match:e=>e===this.newPassword||m("password must match")}}},beforeDestroy(){this.newPasswordUI="",this.username="",this.password="",this.newPassword="",this.newPasswordConfirm="",this.error=""},methods:{async signin(){if(this.$refs.form.validate())try{if(this.newPasswordUI){const e=await f.completeNewPassword(this.user,this.newPassword);this.$emit("signin",e)}else{const e=await f.signin({username:this.username,password:this.password});e.challengeName==="NEW_PASSWORD_REQUIRED"?(this.user=e,this.newPasswordUI=!0,this.$refs.form.resetValidation()):this.$emit("signin",e)}}catch(e){this.shake=!0,this.error=e}else this.shake=!0,setTimeout(()=>{this.shake=!1},500)}}};function q(e,r,x,C,s,p){return a(),V("section",null,[l(c,{class:U(["signin",{shake:s.shake}]),onKeydown:r[5]||(r[5]=b(t=>p.signin(),["enter"]))},{default:o(()=>[l(P,{class:"text-h4"},{default:o(()=>[i(n(s.newPasswordUI?e.$gettext("New password"):e.$gettext("Sign In")),1)]),_:1}),l(h,{class:"text-h8",style:{"{'padding-bottom'":"'0.5rem'}"}},{default:o(()=>[i(n(e.$gettext("Sign in with username or email address.")),1)]),_:1}),l(y,{ref:"form","lazy-validation":""},{default:o(()=>[s.newPasswordUI?w("",!0):(a(),d(u,{key:0,modelValue:s.username,"onUpdate:modelValue":r[0]||(r[0]=t=>s.username=t),label:e.$gettext("username"),required:"",rules:[s.rules.required]},null,8,["modelValue","label","rules"])),s.newPasswordUI?w("",!0):(a(),d(u,{key:1,modelValue:s.password,"onUpdate:modelValue":r[1]||(r[1]=t=>s.password=t),label:e.$gettext("password"),required:"",rules:[s.rules.required],type:"password"},null,8,["modelValue","label","rules"])),s.newPasswordUI?(a(),d(u,{key:2,modelValue:s.newPassword,"onUpdate:modelValue":r[2]||(r[2]=t=>s.newPassword=t),label:e.$gettext("new password"),required:"",rules:[s.rules.required,s.rules.password],type:"password"},null,8,["modelValue","label","rules"])):w("",!0),s.newPasswordUI?(a(),d(u,{key:3,modelValue:s.newPasswordConfirm,"onUpdate:modelValue":r[3]||(r[3]=t=>s.newPasswordConfirm=t),label:e.$gettext("confirm new password"),required:"",rules:[s.rules.required,s.rules.match],type:"password"},null,8,["modelValue","label","rules"])):w("",!0),l(h,{style:{color:"red"}},{default:o(()=>[i(n(s.error),1)]),_:1}),l(k,{block:"",color:"success",onClick:r[4]||(r[4]=t=>p.signin())},{default:o(()=>[i(n(e.$gettext("Sign in")),1)]),_:1})]),_:1},512)]),_:1},8,["class"])])}const N=g(I,[["render",q],["__scopeId","data-v-c2200f9d"]]);export{N as default};
