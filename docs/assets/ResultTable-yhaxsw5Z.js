import{as as W,at as F,r as h,_ as C,u as O,af as L,p as V,g as k,q as S,y as R,l as N,F as j,E as D,h as I,i as b,L as U,aq as G,au as x,j as w,av as B,aw as M,x as P,a3 as $,ax as q,ay as A,aa as J,az as z}from"./index-v0Xi2WRv.js";function K(t){return W()?(F(t),!0):!1}const X=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Y=X?window:void 0;function H(t){return u=>{const n=u.data[0];return Promise.resolve(t.apply(void 0,n)).then(o=>{postMessage(["SUCCESS",o])}).catch(o=>{postMessage(["ERROR",o])})}}function Q(t){return t.length===0?"":`importScripts(${t.map(n=>`'${n}'`).toString()})`}function Z(t,u){const n=`${Q(u)}; onmessage=(${H})(${t})`,o=new Blob([n],{type:"text/javascript"});return URL.createObjectURL(o)}function ee(t,u={}){const{dependencies:n=[],timeout:o,window:d=Y}=u,c=h(),l=h("PENDING"),f=h({}),g=h(),e=(a="PENDING")=>{c.value&&c.value._url&&d&&(c.value.terminate(),URL.revokeObjectURL(c.value._url),f.value={},c.value=void 0,d.clearTimeout(g.value),l.value=a)};e(),K(e);const p=()=>{const a=Z(t,n),r=new Worker(a);return r._url=a,r.onmessage=m=>{const{resolve:v=()=>{},reject:T=()=>{}}=f.value,[y,_]=m.data;switch(y){case"SUCCESS":v(_),e(y);break;default:T(_),e("ERROR");break}},r.onerror=m=>{const{reject:v=()=>{}}=f.value;m.preventDefault(),v(m),e("ERROR")},o&&(g.value=setTimeout(()=>e("TIMEOUT_EXPIRED"),o)),r},i=(...a)=>new Promise((r,m)=>{f.value={resolve:r,reject:m},c.value&&c.value.postMessage([[...a]]),l.value="RUNNING"});return{workerFn:(...a)=>l.value==="RUNNING"?(console.error("[useWebWorkerFn] You can only run one instance of the worker at a time."),Promise.reject()):(c.value=p(),i(...a)),workerStatus:l,workerTerminate:e}}const E=t=>t,{workerFn:te}=ee(z),oe={name:"ResultTable",setup(){const t=O(),u=L(),n=h([]),o=h(""),d=h(0),c=h(10);async function l(){const e=u.scenario+"/",i=t.otherFiles.filter(s=>s.extension==="csv");d.value=i.length;for(const s of i)s.content instanceof Uint8Array||(s.content=await G.readBytes(u.model,e+s.path));return i}V(async()=>{t.changeLoading(!0);try{const e=await l();for(const p of e){const i=p.path.slice(0,-4),s=await te(p.content.buffer),a=[];Object.keys(s[0]).forEach(r=>a.push({title:r,key:r,width:"1%"})),n.value.push({headers:a,items:s.slice(0,c.value),data:s,name:i,totalItems:s.length}),d.value-=1}t.changeLoading(!1),n.value.length===0&&(o.value=E("Nothing to display"))}catch(e){console.error(e),t.changeLoading(!1),d.value=0,o.value=E("Nothing to display")}});function f(e,p,i,s){const a=(p-1)*i,r=a+i;if(s.length>0){const m=s[0].key,v=s[0].order;e=J.orderBy(e,m,v)}return e.slice(a,r)}async function g({key:e,page:p,itemsPerPage:i,sortBy:s}){const a=x(n.value[e].data),r=f(a,p,i,x(s));n.value[e].items=r}return{tables:n,message:o,numItems:c,loadItems:g,skeletons:d}}},se={class:"layout"},ae={key:0};function ne(t,u,n,o,d,c){return k(),S("section",se,[o.tables.length===0?(k(),S("p",ae,R(t.$gettext(o.message)),1)):N("",!0),(k(!0),S(j,null,D(o.tables,(l,f)=>(k(),I(U,{key:f,class:"card elevation-3"},{default:b(()=>[w(q,{"items-per-page":o.numItems,headers:l.headers,height:l.items.length>=10?"35rem":"auto","items-length":l.totalItems,"fixed-header":"","fixed-footer":"",items:l.items,"onUpdate:options":g=>o.loadItems({key:f,...g})},{top:b(()=>[w(B,{class:"custom-title"},{default:b(()=>[w(M,null,{default:b(()=>[P(R(l.name),1)]),_:2},1024),w($)]),_:2},1024)]),_:2},1032,["items-per-page","headers","height","items-length","items","onUpdate:options"])]),_:2},1024))),128)),o.skeletons>0?(k(),I(U,{key:1,class:"card elevation-3"},{default:b(()=>[w(A,{type:"heading,table-thead, table-tbody "})]),_:1})):N("",!0)])}const ce=C(oe,[["render",ne],["__scopeId","data-v-1b99a932"]]);export{ce as default};
