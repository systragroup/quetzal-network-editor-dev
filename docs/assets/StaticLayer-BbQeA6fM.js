import{_ as ht,a as Te,c as ie,b as ye,x as ve,y as ae,G as Tt,H as Yt,W as nt,A as be,k as Ht,bc as te,bd as Wt,be as Ut,r as H,aS as re,ai as ee,bf as Zt,u as Kt,bg as Jt,t as Qt,a8 as Vt,a9 as en,aa as tn,v as nn,o as rn,f as on,g as Ne}from"./index-DGOf5lRm.js";const sn={class:"gradient"},an={class:"domain-title"},cn={class:"domain-min"},ln={class:"domain-med"},fn={class:"domain-max"},un={__name:"MapLegend",props:{colorScale:{type:Array,default:()=>[]},displaySettings:{type:Object,default:()=>{}},baseOffset:{type:Number,default:()=>300},order:{type:Number,default:()=>0}},setup(e){const t=e,n=Te(),r=ie(()=>n.showLeftPanel?50+180*t.order+t.baseOffset:50+180*t.order),s=ie(()=>!isNaN(t.displaySettings.minVal)&&!isNaN(t.displaySettings.minVal)),c=ie(()=>{const a=(t.displaySettings.maxVal+t.displaySettings.minVal)/2;return a.toFixed(a>=10?0:1)});return(a,l)=>s.value?(ye(),ve("div",{key:0,class:"legend elevation-4",style:nt({left:`${r.value}px !important`})},[ae("div",sn,[(ye(!0),ve(Tt,null,Yt(e.colorScale,(o,f)=>(ye(),ve("span",{key:f,class:"grad-step",style:nt({backgroundColor:o})},null,4))),128)),ae("span",an,be(e.displaySettings.selectedFeature),1),ae("span",cn,be(Math.round(e.displaySettings.minVal)),1),ae("span",ln,be(c.value),1),ae("span",fn,be(Math.round(e.displaySettings.maxVal)),1)])],4)):Ht("",!0)}},dn=ht(un,[["__scopeId","data-v-b6bfceaa"]]),ce=(e,t=0,n=1)=>He(We(t,e),n),Ye=e=>{e._clipped=!1,e._unclipped=e.slice(0);for(let t=0;t<=3;t++)t<3?((e[t]<0||e[t]>255)&&(e._clipped=!0),e[t]=ce(e[t],0,255)):t===3&&(e[t]=ce(e[t],0,1));return e},pt={};for(let e of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])pt[`[object ${e}]`]=e.toLowerCase();function j(e){return pt[Object.prototype.toString.call(e)]||"object"}const O=(e,t=null)=>e.length>=3?Array.prototype.slice.call(e):j(e[0])=="object"&&t?t.split("").filter(n=>e[0][n]!==void 0).map(n=>e[0][n]):e[0],_e=e=>{if(e.length<2)return null;const t=e.length-1;return j(e[t])=="string"?e[t].toLowerCase():null},{PI:ke,min:He,max:We}=Math,K=ke*2,$e=ke/3,bn=ke/180,hn=180/ke,C={format:{},autodetect:[]};class g{constructor(...t){const n=this;if(j(t[0])==="object"&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];let r=_e(t),s=!1;if(!r){s=!0,C.sorted||(C.autodetect=C.autodetect.sort((c,a)=>a.p-c.p),C.sorted=!0);for(let c of C.autodetect)if(r=c.test(...t),r)break}if(C.format[r]){const c=C.format[r].apply(null,s?t:t.slice(0,-1));n._rgb=Ye(c)}else throw new Error("unknown format: "+t);n._rgb.length===3&&n._rgb.push(1)}toString(){return j(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const pn="2.6.0",A=(...e)=>new A.Color(...e);A.Color=g;A.version=pn;const gn=(...e)=>{e=O(e,"cmyk");const[t,n,r,s]=e,c=e.length>4?e[4]:1;return s===1?[0,0,0,c]:[t>=1?0:255*(1-t)*(1-s),n>=1?0:255*(1-n)*(1-s),r>=1?0:255*(1-r)*(1-s),c]},{max:rt}=Math,yn=(...e)=>{let[t,n,r]=O(e,"rgb");t=t/255,n=n/255,r=r/255;const s=1-rt(t,rt(n,r)),c=s<1?1/(1-s):0,a=(1-t-s)*c,l=(1-n-s)*c,o=(1-r-s)*c;return[a,l,o,s]};g.prototype.cmyk=function(){return yn(this._rgb)};A.cmyk=(...e)=>new g(...e,"cmyk");C.format.cmyk=gn;C.autodetect.push({p:2,test:(...e)=>{if(e=O(e,"cmyk"),j(e)==="array"&&e.length===4)return"cmyk"}});const Le=e=>Math.round(e*100)/100,vn=(...e)=>{const t=O(e,"hsla");let n=_e(e)||"lsa";return t[0]=Le(t[0]||0),t[1]=Le(t[1]*100)+"%",t[2]=Le(t[2]*100)+"%",n==="hsla"||t.length>3&&t[3]<1?(t[3]=t.length>3?t[3]:1,n="hsla"):t.length=3,`${n}(${t.join(",")})`},gt=(...e)=>{e=O(e,"rgba");let[t,n,r]=e;t/=255,n/=255,r/=255;const s=He(t,n,r),c=We(t,n,r),a=(c+s)/2;let l,o;return c===s?(l=0,o=Number.NaN):l=a<.5?(c-s)/(c+s):(c-s)/(2-c-s),t==c?o=(n-r)/(c-s):n==c?o=2+(r-t)/(c-s):r==c&&(o=4+(t-n)/(c-s)),o*=60,o<0&&(o+=360),e.length>3&&e[3]!==void 0?[o,l,a,e[3]]:[o,l,a]},{round:Me}=Math,mn=(...e)=>{const t=O(e,"rgba");let n=_e(e)||"rgb";return n.substr(0,3)=="hsl"?vn(gt(t),n):(t[0]=Me(t[0]),t[1]=Me(t[1]),t[2]=Me(t[2]),(n==="rgba"||t.length>3&&t[3]<1)&&(t[3]=t.length>3?t[3]:1,n="rgba"),`${n}(${t.slice(0,n==="rgb"?3:4).join(",")})`)},{round:Ce}=Math,Xe=(...e)=>{e=O(e,"hsl");const[t,n,r]=e;let s,c,a;if(n===0)s=c=a=r*255;else{const l=[0,0,0],o=[0,0,0],f=r<.5?r*(1+n):r+n-r*n,d=2*r-f,i=t/360;l[0]=i+1/3,l[1]=i,l[2]=i-1/3;for(let u=0;u<3;u++)l[u]<0&&(l[u]+=1),l[u]>1&&(l[u]-=1),6*l[u]<1?o[u]=d+(f-d)*6*l[u]:2*l[u]<1?o[u]=f:3*l[u]<2?o[u]=d+(f-d)*(2/3-l[u])*6:o[u]=d;[s,c,a]=[Ce(o[0]*255),Ce(o[1]*255),Ce(o[2]*255)]}return e.length>3?[s,c,a,e[3]]:[s,c,a,1]},yt=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,vt=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,mt=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,wt=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,xt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,_t=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,{round:ot}=Math,Ue=e=>{e=e.toLowerCase().trim();let t;if(C.format.named)try{return C.format.named(e)}catch{}if(t=e.match(yt)){const n=t.slice(1,4);for(let r=0;r<3;r++)n[r]=+n[r];return n[3]=1,n}if(t=e.match(vt)){const n=t.slice(1,5);for(let r=0;r<4;r++)n[r]=+n[r];return n}if(t=e.match(mt)){const n=t.slice(1,4);for(let r=0;r<3;r++)n[r]=ot(n[r]*2.55);return n[3]=1,n}if(t=e.match(wt)){const n=t.slice(1,5);for(let r=0;r<3;r++)n[r]=ot(n[r]*2.55);return n[3]=+n[3],n}if(t=e.match(xt)){const n=t.slice(1,4);n[1]*=.01,n[2]*=.01;const r=Xe(n);return r[3]=1,r}if(t=e.match(_t)){const n=t.slice(1,4);n[1]*=.01,n[2]*=.01;const r=Xe(n);return r[3]=+t[4],r}};Ue.test=e=>yt.test(e)||vt.test(e)||mt.test(e)||wt.test(e)||xt.test(e)||_t.test(e);g.prototype.css=function(e){return mn(this._rgb,e)};A.css=(...e)=>new g(...e,"css");C.format.css=Ue;C.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&j(e)==="string"&&Ue.test(e))return"css"}});C.format.gl=(...e)=>{const t=O(e,"rgba");return t[0]*=255,t[1]*=255,t[2]*=255,t};A.gl=(...e)=>new g(...e,"gl");g.prototype.gl=function(){const e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};const{floor:wn}=Math,xn=(...e)=>{e=O(e,"hcg");let[t,n,r]=e,s,c,a;r=r*255;const l=n*255;if(n===0)s=c=a=r;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const o=wn(t),f=t-o,d=r*(1-n),i=d+l*(1-f),u=d+l*f,b=d+l;switch(o){case 0:[s,c,a]=[b,u,d];break;case 1:[s,c,a]=[i,b,d];break;case 2:[s,c,a]=[d,b,u];break;case 3:[s,c,a]=[d,i,b];break;case 4:[s,c,a]=[u,d,b];break;case 5:[s,c,a]=[b,d,i];break}}return[s,c,a,e.length>3?e[3]:1]},_n=(...e)=>{const[t,n,r]=O(e,"rgb"),s=He(t,n,r),c=We(t,n,r),a=c-s,l=a*100/255,o=s/(255-a)*100;let f;return a===0?f=Number.NaN:(t===c&&(f=(n-r)/a),n===c&&(f=2+(r-t)/a),r===c&&(f=4+(t-n)/a),f*=60,f<0&&(f+=360)),[f,l,o]};g.prototype.hcg=function(){return _n(this._rgb)};A.hcg=(...e)=>new g(...e,"hcg");C.format.hcg=xn;C.autodetect.push({p:1,test:(...e)=>{if(e=O(e,"hcg"),j(e)==="array"&&e.length===3)return"hcg"}});const kn=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Sn=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,kt=e=>{if(e.match(kn)){(e.length===4||e.length===7)&&(e=e.substr(1)),e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16),n=t>>16,r=t>>8&255,s=t&255;return[n,r,s,1]}if(e.match(Sn)){(e.length===5||e.length===9)&&(e=e.substr(1)),e.length===4&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const t=parseInt(e,16),n=t>>24&255,r=t>>16&255,s=t>>8&255,c=Math.round((t&255)/255*100)/100;return[n,r,s,c]}throw new Error(`unknown hex color: ${e}`)},{round:he}=Math,St=(...e)=>{let[t,n,r,s]=O(e,"rgba"),c=_e(e)||"auto";s===void 0&&(s=1),c==="auto"&&(c=s<1?"rgba":"rgb"),t=he(t),n=he(n),r=he(r);let l="000000"+(t<<16|n<<8|r).toString(16);l=l.substr(l.length-6);let o="0"+he(s*255).toString(16);switch(o=o.substr(o.length-2),c.toLowerCase()){case"rgba":return`#${l}${o}`;case"argb":return`#${o}${l}`;default:return`#${l}`}};g.prototype.hex=function(e){return St(this._rgb,e)};A.hex=(...e)=>new g(...e,"hex");C.format.hex=kt;C.autodetect.push({p:4,test:(e,...t)=>{if(!t.length&&j(e)==="string"&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});const{cos:oe}=Math,Nn=(...e)=>{e=O(e,"hsi");let[t,n,r]=e,s,c,a;return isNaN(t)&&(t=0),isNaN(n)&&(n=0),t>360&&(t-=360),t<0&&(t+=360),t/=360,t<1/3?(a=(1-n)/3,s=(1+n*oe(K*t)/oe($e-K*t))/3,c=1-(a+s)):t<2/3?(t-=1/3,s=(1-n)/3,c=(1+n*oe(K*t)/oe($e-K*t))/3,a=1-(s+c)):(t-=2/3,c=(1-n)/3,a=(1+n*oe(K*t)/oe($e-K*t))/3,s=1-(c+a)),s=ce(r*s*3),c=ce(r*c*3),a=ce(r*a*3),[s*255,c*255,a*255,e.length>3?e[3]:1]},{min:$n,sqrt:Ln,acos:Mn}=Math,Cn=(...e)=>{let[t,n,r]=O(e,"rgb");t/=255,n/=255,r/=255;let s;const c=$n(t,n,r),a=(t+n+r)/3,l=a>0?1-c/a:0;return l===0?s=NaN:(s=(t-n+(t-r))/2,s/=Ln((t-n)*(t-n)+(t-r)*(n-r)),s=Mn(s),r>n&&(s=K-s),s/=K),[s*360,l,a]};g.prototype.hsi=function(){return Cn(this._rgb)};A.hsi=(...e)=>new g(...e,"hsi");C.format.hsi=Nn;C.autodetect.push({p:2,test:(...e)=>{if(e=O(e,"hsi"),j(e)==="array"&&e.length===3)return"hsi"}});g.prototype.hsl=function(){return gt(this._rgb)};A.hsl=(...e)=>new g(...e,"hsl");C.format.hsl=Xe;C.autodetect.push({p:2,test:(...e)=>{if(e=O(e,"hsl"),j(e)==="array"&&e.length===3)return"hsl"}});const{floor:An}=Math,En=(...e)=>{e=O(e,"hsv");let[t,n,r]=e,s,c,a;if(r*=255,n===0)s=c=a=r;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const l=An(t),o=t-l,f=r*(1-n),d=r*(1-n*o),i=r*(1-n*(1-o));switch(l){case 0:[s,c,a]=[r,i,f];break;case 1:[s,c,a]=[d,r,f];break;case 2:[s,c,a]=[f,r,i];break;case 3:[s,c,a]=[f,d,r];break;case 4:[s,c,a]=[i,f,r];break;case 5:[s,c,a]=[r,f,d];break}}return[s,c,a,e.length>3?e[3]:1]},{min:jn,max:On}=Math,Rn=(...e)=>{e=O(e,"rgb");let[t,n,r]=e;const s=jn(t,n,r),c=On(t,n,r),a=c-s;let l,o,f;return f=c/255,c===0?(l=Number.NaN,o=0):(o=a/c,t===c&&(l=(n-r)/a),n===c&&(l=2+(r-t)/a),r===c&&(l=4+(t-n)/a),l*=60,l<0&&(l+=360)),[l,o,f]};g.prototype.hsv=function(){return Rn(this._rgb)};A.hsv=(...e)=>new g(...e,"hsv");C.format.hsv=En;C.autodetect.push({p:2,test:(...e)=>{if(e=O(e,"hsv"),j(e)==="array"&&e.length===3)return"hsv"}});const T={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},{pow:zn}=Math,Nt=(...e)=>{e=O(e,"lab");const[t,n,r]=e;let s,c,a,l,o,f;return c=(t+16)/116,s=isNaN(n)?c:c+n/500,a=isNaN(r)?c:c-r/200,c=T.Yn*Ee(c),s=T.Xn*Ee(s),a=T.Zn*Ee(a),l=Ae(3.2404542*s-1.5371385*c-.4985314*a),o=Ae(-.969266*s+1.8760108*c+.041556*a),f=Ae(.0556434*s-.2040259*c+1.0572252*a),[l,o,f,e.length>3?e[3]:1]},Ae=e=>255*(e<=.00304?12.92*e:1.055*zn(e,1/2.4)-.055),Ee=e=>e>T.t1?e*e*e:T.t2*(e-T.t0),{pow:$t}=Math,Lt=(...e)=>{const[t,n,r]=O(e,"rgb"),[s,c,a]=qn(t,n,r),l=116*c-16;return[l<0?0:l,500*(s-c),200*(c-a)]},je=e=>(e/=255)<=.04045?e/12.92:$t((e+.055)/1.055,2.4),Oe=e=>e>T.t3?$t(e,1/3):e/T.t2+T.t0,qn=(e,t,n)=>{e=je(e),t=je(t),n=je(n);const r=Oe((.4124564*e+.3575761*t+.1804375*n)/T.Xn),s=Oe((.2126729*e+.7151522*t+.072175*n)/T.Yn),c=Oe((.0193339*e+.119192*t+.9503041*n)/T.Zn);return[r,s,c]};g.prototype.lab=function(){return Lt(this._rgb)};A.lab=(...e)=>new g(...e,"lab");C.format.lab=Nt;C.autodetect.push({p:2,test:(...e)=>{if(e=O(e,"lab"),j(e)==="array"&&e.length===3)return"lab"}});const{sin:Pn,cos:In}=Math,Mt=(...e)=>{let[t,n,r]=O(e,"lch");return isNaN(r)&&(r=0),r=r*bn,[t,In(r)*n,Pn(r)*n]},Ct=(...e)=>{e=O(e,"lch");const[t,n,r]=e,[s,c,a]=Mt(t,n,r),[l,o,f]=Nt(s,c,a);return[l,o,f,e.length>3?e[3]:1]},Fn=(...e)=>{const t=O(e,"hcl").reverse();return Ct(...t)},{sqrt:Gn,atan2:Bn,round:Dn}=Math,At=(...e)=>{const[t,n,r]=O(e,"lab"),s=Gn(n*n+r*r);let c=(Bn(r,n)*hn+360)%360;return Dn(s*1e4)===0&&(c=Number.NaN),[t,s,c]},Et=(...e)=>{const[t,n,r]=O(e,"rgb"),[s,c,a]=Lt(t,n,r);return At(s,c,a)};g.prototype.lch=function(){return Et(this._rgb)};g.prototype.hcl=function(){return Et(this._rgb).reverse()};A.lch=(...e)=>new g(...e,"lch");A.hcl=(...e)=>new g(...e,"hcl");C.format.lch=Ct;C.format.hcl=Fn;["lch","hcl"].forEach(e=>C.autodetect.push({p:2,test:(...t)=>{if(t=O(t,e),j(t)==="array"&&t.length===3)return e}}));const le={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};g.prototype.name=function(){const e=St(this._rgb,"rgb");for(let t of Object.keys(le))if(le[t]===e)return t.toLowerCase();return e};C.format.named=e=>{if(e=e.toLowerCase(),le[e])return kt(le[e]);throw new Error("unknown color name: "+e)};C.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&j(e)==="string"&&le[e.toLowerCase()])return"named"}});const Xn=e=>{if(j(e)=="number"&&e>=0&&e<=16777215){const t=e>>16,n=e>>8&255,r=e&255;return[t,n,r,1]}throw new Error("unknown num color: "+e)},Tn=(...e)=>{const[t,n,r]=O(e,"rgb");return(t<<16)+(n<<8)+r};g.prototype.num=function(){return Tn(this._rgb)};A.num=(...e)=>new g(...e,"num");C.format.num=Xn;C.autodetect.push({p:5,test:(...e)=>{if(e.length===1&&j(e[0])==="number"&&e[0]>=0&&e[0]<=16777215)return"num"}});const{round:jt}=Math;g.prototype.rgb=function(e=!0){return e===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(jt)};g.prototype.rgba=function(e=!0){return this._rgb.slice(0,4).map((t,n)=>n<3?e===!1?t:jt(t):t)};A.rgb=(...e)=>new g(...e,"rgb");C.format.rgb=(...e)=>{const t=O(e,"rgba");return t[3]===void 0&&(t[3]=1),t};C.autodetect.push({p:3,test:(...e)=>{if(e=O(e,"rgba"),j(e)==="array"&&(e.length===3||e.length===4&&j(e[3])=="number"&&e[3]>=0&&e[3]<=1))return"rgb"}});const{log:pe}=Math,Ot=e=>{const t=e/100;let n,r,s;return t<66?(n=255,r=t<6?0:-155.25485562709179-.44596950469579133*(r=t-2)+104.49216199393888*pe(r),s=t<20?0:-254.76935184120902+.8274096064007395*(s=t-10)+115.67994401066147*pe(s)):(n=351.97690566805693+.114206453784165*(n=t-55)-40.25366309332127*pe(n),r=325.4494125711974+.07943456536662342*(r=t-50)-28.0852963507957*pe(r),s=255),[n,r,s,1]},{round:Yn}=Math,Hn=(...e)=>{const t=O(e,"rgb"),n=t[0],r=t[2];let s=1e3,c=4e4;const a=.4;let l;for(;c-s>a;){l=(c+s)*.5;const o=Ot(l);o[2]/o[0]>=r/n?c=l:s=l}return Yn(l)};g.prototype.temp=g.prototype.kelvin=g.prototype.temperature=function(){return Hn(this._rgb)};A.temp=A.kelvin=A.temperature=(...e)=>new g(...e,"temp");C.format.temp=C.format.kelvin=C.format.temperature=Ot;const{pow:me,sign:Wn}=Math,Rt=(...e)=>{e=O(e,"lab");const[t,n,r]=e,s=me(t+.3963377774*n+.2158037573*r,3),c=me(t-.1055613458*n-.0638541728*r,3),a=me(t-.0894841775*n-1.291485548*r,3);return[255*Re(4.0767416621*s-3.3077115913*c+.2309699292*a),255*Re(-1.2684380046*s+2.6097574011*c-.3413193965*a),255*Re(-.0041960863*s-.7034186147*c+1.707614701*a),e.length>3?e[3]:1]};function Re(e){const t=Math.abs(e);return t>.0031308?(Wn(e)||1)*(1.055*me(t,1/2.4)-.055):e*12.92}const{cbrt:ze,pow:Un,sign:Zn}=Math,zt=(...e)=>{const[t,n,r]=O(e,"rgb"),[s,c,a]=[qe(t/255),qe(n/255),qe(r/255)],l=ze(.4122214708*s+.5363325363*c+.0514459929*a),o=ze(.2119034982*s+.6806995451*c+.1073969566*a),f=ze(.0883024619*s+.2817188376*c+.6299787005*a);return[.2104542553*l+.793617785*o-.0040720468*f,1.9779984951*l-2.428592205*o+.4505937099*f,.0259040371*l+.7827717662*o-.808675766*f]};function qe(e){const t=Math.abs(e);return t<.04045?e/12.92:(Zn(e)||1)*Un((t+.055)/1.055,2.4)}g.prototype.oklab=function(){return zt(this._rgb)};A.oklab=(...e)=>new g(...e,"oklab");C.format.oklab=Rt;C.autodetect.push({p:3,test:(...e)=>{if(e=O(e,"oklab"),j(e)==="array"&&e.length===3)return"oklab"}});const Kn=(...e)=>{e=O(e,"lch");const[t,n,r]=e,[s,c,a]=Mt(t,n,r),[l,o,f]=Rt(s,c,a);return[l,o,f,e.length>3?e[3]:1]},Jn=(...e)=>{const[t,n,r]=O(e,"rgb"),[s,c,a]=zt(t,n,r);return At(s,c,a)};g.prototype.oklch=function(){return Jn(this._rgb)};A.oklch=(...e)=>new g(...e,"oklch");C.format.oklch=Kn;C.autodetect.push({p:3,test:(...e)=>{if(e=O(e,"oklch"),j(e)==="array"&&e.length===3)return"oklch"}});g.prototype.alpha=function(e,t=!1){return e!==void 0&&j(e)==="number"?t?(this._rgb[3]=e,this):new g([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]};g.prototype.clipped=function(){return this._rgb._clipped||!1};g.prototype.darken=function(e=1){const t=this,n=t.lab();return n[0]-=T.Kn*e,new g(n,"lab").alpha(t.alpha(),!0)};g.prototype.brighten=function(e=1){return this.darken(-e)};g.prototype.darker=g.prototype.darken;g.prototype.brighter=g.prototype.brighten;g.prototype.get=function(e){const[t,n]=e.split("."),r=this[t]();if(n){const s=t.indexOf(n)-(t.substr(0,2)==="ok"?2:0);if(s>-1)return r[s];throw new Error(`unknown channel ${n} in mode ${t}`)}else return r};const{pow:Qn}=Math,Vn=1e-7,er=20;g.prototype.luminance=function(e,t="rgb"){if(e!==void 0&&j(e)==="number"){if(e===0)return new g([0,0,0,this._rgb[3]],"rgb");if(e===1)return new g([255,255,255,this._rgb[3]],"rgb");let n=this.luminance(),r=er;const s=(a,l)=>{const o=a.interpolate(l,.5,t),f=o.luminance();return Math.abs(e-f)<Vn||!r--?o:f>e?s(a,o):s(o,l)},c=(n>e?s(new g([0,0,0]),this):s(this,new g([255,255,255]))).rgb();return new g([...c,this._rgb[3]])}return tr(...this._rgb.slice(0,3))};const tr=(e,t,n)=>(e=Pe(e),t=Pe(t),n=Pe(n),.2126*e+.7152*t+.0722*n),Pe=e=>(e/=255,e<=.03928?e/12.92:Qn((e+.055)/1.055,2.4)),B={},ue=(e,t,n=.5,...r)=>{let s=r[0]||"lrgb";if(!B[s]&&!r.length&&(s=Object.keys(B)[0]),!B[s])throw new Error(`interpolation mode ${s} is not defined`);return j(e)!=="object"&&(e=new g(e)),j(t)!=="object"&&(t=new g(t)),B[s](e,t,n).alpha(e.alpha()+n*(t.alpha()-e.alpha()))};g.prototype.mix=g.prototype.interpolate=function(e,t=.5,...n){return ue(this,e,t,...n)};g.prototype.premultiply=function(e=!1){const t=this._rgb,n=t[3];return e?(this._rgb=[t[0]*n,t[1]*n,t[2]*n,n],this):new g([t[0]*n,t[1]*n,t[2]*n,n],"rgb")};g.prototype.saturate=function(e=1){const t=this,n=t.lch();return n[1]+=T.Kn*e,n[1]<0&&(n[1]=0),new g(n,"lch").alpha(t.alpha(),!0)};g.prototype.desaturate=function(e=1){return this.saturate(-e)};g.prototype.set=function(e,t,n=!1){const[r,s]=e.split("."),c=this[r]();if(s){const a=r.indexOf(s)-(r.substr(0,2)==="ok"?2:0);if(a>-1){if(j(t)=="string")switch(t.charAt(0)){case"+":c[a]+=+t;break;case"-":c[a]+=+t;break;case"*":c[a]*=+t.substr(1);break;case"/":c[a]/=+t.substr(1);break;default:c[a]=+t}else if(j(t)==="number")c[a]=t;else throw new Error("unsupported value for Color.set");const l=new g(c,r);return n?(this._rgb=l._rgb,this):l}throw new Error(`unknown channel ${s} in mode ${r}`)}else return c};g.prototype.tint=function(e=.5,...t){return ue(this,"white",e,...t)};g.prototype.shade=function(e=.5,...t){return ue(this,"black",e,...t)};const nr=(e,t,n)=>{const r=e._rgb,s=t._rgb;return new g(r[0]+n*(s[0]-r[0]),r[1]+n*(s[1]-r[1]),r[2]+n*(s[2]-r[2]),"rgb")};B.rgb=nr;const{sqrt:Ie,pow:se}=Math,rr=(e,t,n)=>{const[r,s,c]=e._rgb,[a,l,o]=t._rgb;return new g(Ie(se(r,2)*(1-n)+se(a,2)*n),Ie(se(s,2)*(1-n)+se(l,2)*n),Ie(se(c,2)*(1-n)+se(o,2)*n),"rgb")};B.lrgb=rr;const or=(e,t,n)=>{const r=e.lab(),s=t.lab();return new g(r[0]+n*(s[0]-r[0]),r[1]+n*(s[1]-r[1]),r[2]+n*(s[2]-r[2]),"lab")};B.lab=or;const fe=(e,t,n,r)=>{let s,c;r==="hsl"?(s=e.hsl(),c=t.hsl()):r==="hsv"?(s=e.hsv(),c=t.hsv()):r==="hcg"?(s=e.hcg(),c=t.hcg()):r==="hsi"?(s=e.hsi(),c=t.hsi()):r==="lch"||r==="hcl"?(r="hcl",s=e.hcl(),c=t.hcl()):r==="oklch"&&(s=e.oklch().reverse(),c=t.oklch().reverse());let a,l,o,f,d,i;(r.substr(0,1)==="h"||r==="oklch")&&([a,o,d]=s,[l,f,i]=c);let u,b,y,M;return!isNaN(a)&&!isNaN(l)?(l>a&&l-a>180?M=l-(a+360):l<a&&a-l>180?M=l+360-a:M=l-a,b=a+n*M):isNaN(a)?isNaN(l)?b=Number.NaN:(b=l,(d==1||d==0)&&r!="hsv"&&(u=f)):(b=a,(i==1||i==0)&&r!="hsv"&&(u=o)),u===void 0&&(u=o+n*(f-o)),y=d+n*(i-d),r==="oklch"?new g([y,u,b],r):new g([b,u,y],r)},qt=(e,t,n)=>fe(e,t,n,"lch");B.lch=qt;B.hcl=qt;const sr=(e,t,n)=>{const r=e.num(),s=t.num();return new g(r+n*(s-r),"num")};B.num=sr;const ar=(e,t,n)=>fe(e,t,n,"hcg");B.hcg=ar;const cr=(e,t,n)=>fe(e,t,n,"hsi");B.hsi=cr;const lr=(e,t,n)=>fe(e,t,n,"hsl");B.hsl=lr;const fr=(e,t,n)=>fe(e,t,n,"hsv");B.hsv=fr;const ir=(e,t,n)=>{const r=e.oklab(),s=t.oklab();return new g(r[0]+n*(s[0]-r[0]),r[1]+n*(s[1]-r[1]),r[2]+n*(s[2]-r[2]),"oklab")};B.oklab=ir;const ur=(e,t,n)=>fe(e,t,n,"oklch");B.oklch=ur;const{pow:Fe,sqrt:Ge,PI:Be,cos:st,sin:at,atan2:dr}=Math,br=(e,t="lrgb",n=null)=>{const r=e.length;n||(n=Array.from(new Array(r)).map(()=>1));const s=r/n.reduce(function(i,u){return i+u});if(n.forEach((i,u)=>{n[u]*=s}),e=e.map(i=>new g(i)),t==="lrgb")return hr(e,n);const c=e.shift(),a=c.get(t),l=[];let o=0,f=0;for(let i=0;i<a.length;i++)if(a[i]=(a[i]||0)*n[0],l.push(isNaN(a[i])?0:n[0]),t.charAt(i)==="h"&&!isNaN(a[i])){const u=a[i]/180*Be;o+=st(u)*n[0],f+=at(u)*n[0]}let d=c.alpha()*n[0];e.forEach((i,u)=>{const b=i.get(t);d+=i.alpha()*n[u+1];for(let y=0;y<a.length;y++)if(!isNaN(b[y]))if(l[y]+=n[u+1],t.charAt(y)==="h"){const M=b[y]/180*Be;o+=st(M)*n[u+1],f+=at(M)*n[u+1]}else a[y]+=b[y]*n[u+1]});for(let i=0;i<a.length;i++)if(t.charAt(i)==="h"){let u=dr(f/l[i],o/l[i])/Be*180;for(;u<0;)u+=360;for(;u>=360;)u-=360;a[i]=u}else a[i]=a[i]/l[i];return d/=r,new g(a,t).alpha(d>.99999?1:d,!0)},hr=(e,t)=>{const n=e.length,r=[0,0,0,0];for(let s=0;s<e.length;s++){const c=e[s],a=t[s]/n,l=c._rgb;r[0]+=Fe(l[0],2)*a,r[1]+=Fe(l[1],2)*a,r[2]+=Fe(l[2],2)*a,r[3]+=l[3]*a}return r[0]=Ge(r[0]),r[1]=Ge(r[1]),r[2]=Ge(r[2]),r[3]>.9999999&&(r[3]=1),new g(Ye(r))},{pow:pr}=Math;function xe(e){let t="rgb",n=A("#ccc"),r=0,s=[0,1],c=[],a=[0,0],l=!1,o=[],f=!1,d=0,i=1,u=!1,b={},y=!0,M=1;const S=function(h){if(h=h||["#fff","#000"],h&&j(h)==="string"&&A.brewer&&A.brewer[h.toLowerCase()]&&(h=A.brewer[h.toLowerCase()]),j(h)==="array"){h.length===1&&(h=[h[0],h[0]]),h=h.slice(0);for(let m=0;m<h.length;m++)h[m]=A(h[m]);c.length=0;for(let m=0;m<h.length;m++)c.push(m/(h.length-1))}return L(),o=h},_=function(h){if(l!=null){const m=l.length-1;let k=0;for(;k<m&&h>=l[k];)k++;return k-1}return 0};let R=h=>h,z=h=>h;const $=function(h,m){let k,w;if(m==null&&(m=!1),isNaN(h)||h===null)return n;m?w=h:l&&l.length>2?w=_(h)/(l.length-2):i!==d?w=(h-d)/(i-d):w=1,w=z(w),m||(w=R(w)),M!==1&&(w=pr(w,M)),w=a[0]+w*(1-a[0]-a[1]),w=ce(w,0,1);const v=Math.floor(w*1e4);if(y&&b[v])k=b[v];else{if(j(o)==="array")for(let p=0;p<c.length;p++){const x=c[p];if(w<=x){k=o[p];break}if(w>=x&&p===c.length-1){k=o[p];break}if(w>x&&w<c[p+1]){w=(w-x)/(c[p+1]-x),k=A.interpolate(o[p],o[p+1],w,t);break}}else j(o)==="function"&&(k=o(w));y&&(b[v]=k)}return k};var L=()=>b={};S(e);const N=function(h){const m=A($(h));return f&&m[f]?m[f]():m};return N.classes=function(h){if(h!=null){if(j(h)==="array")l=h,s=[h[0],h[h.length-1]];else{const m=A.analyze(s);h===0?l=[m.min,m.max]:l=A.limits(m,"e",h)}return N}return l},N.domain=function(h){if(!arguments.length)return s;d=h[0],i=h[h.length-1],c=[];const m=o.length;if(h.length===m&&d!==i)for(let k of Array.from(h))c.push((k-d)/(i-d));else{for(let k=0;k<m;k++)c.push(k/(m-1));if(h.length>2){const k=h.map((v,p)=>p/(h.length-1)),w=h.map(v=>(v-d)/(i-d));w.every((v,p)=>k[p]===v)||(z=v=>{if(v<=0||v>=1)return v;let p=0;for(;v>=w[p+1];)p++;const x=(v-w[p])/(w[p+1]-w[p]);return k[p]+x*(k[p+1]-k[p])})}}return s=[d,i],N},N.mode=function(h){return arguments.length?(t=h,L(),N):t},N.range=function(h,m){return S(h),N},N.out=function(h){return f=h,N},N.spread=function(h){return arguments.length?(r=h,N):r},N.correctLightness=function(h){return h==null&&(h=!0),u=h,L(),u?R=function(m){const k=$(0,!0).lab()[0],w=$(1,!0).lab()[0],v=k>w;let p=$(m,!0).lab()[0];const x=k+(w-k)*m;let E=p-x,q=0,X=1,F=20;for(;Math.abs(E)>.01&&F-- >0;)(function(){return v&&(E*=-1),E<0?(q=m,m+=(X-m)*.5):(X=m,m+=(q-m)*.5),p=$(m,!0).lab()[0],E=p-x})();return m}:R=m=>m,N},N.padding=function(h){return h!=null?(j(h)==="number"&&(h=[h,h]),a=h,N):a},N.colors=function(h,m){arguments.length<2&&(m="hex");let k=[];if(arguments.length===0)k=o.slice(0);else if(h===1)k=[N(.5)];else if(h>1){const w=s[0],v=s[1]-w;k=gr(0,h).map(p=>N(w+p/(h-1)*v))}else{e=[];let w=[];if(l&&l.length>2)for(let v=1,p=l.length,x=1<=p;x?v<p:v>p;x?v++:v--)w.push((l[v-1]+l[v])*.5);else w=s;k=w.map(v=>N(v))}return A[m]&&(k=k.map(w=>w[m]())),k},N.cache=function(h){return h!=null?(y=h,N):y},N.gamma=function(h){return h!=null?(M=h,N):M},N.nodata=function(h){return h!=null?(n=A(h),N):n},N}function gr(e,t,n){let r=[],s=e<t,c=t;for(let a=e;s?a<c:a>c;s?a++:a--)r.push(a);return r}const yr=function(e){let t=[1,1];for(let n=1;n<e;n++){let r=[1];for(let s=1;s<=t.length;s++)r[s]=(t[s]||0)+t[s-1];t=r}return t},vr=function(e){let t,n,r,s;if(e=e.map(c=>new g(c)),e.length===2)[n,r]=e.map(c=>c.lab()),t=function(c){const a=[0,1,2].map(l=>n[l]+c*(r[l]-n[l]));return new g(a,"lab")};else if(e.length===3)[n,r,s]=e.map(c=>c.lab()),t=function(c){const a=[0,1,2].map(l=>(1-c)*(1-c)*n[l]+2*(1-c)*c*r[l]+c*c*s[l]);return new g(a,"lab")};else if(e.length===4){let c;[n,r,s,c]=e.map(a=>a.lab()),t=function(a){const l=[0,1,2].map(o=>(1-a)*(1-a)*(1-a)*n[o]+3*(1-a)*(1-a)*a*r[o]+3*(1-a)*a*a*s[o]+a*a*a*c[o]);return new g(l,"lab")}}else if(e.length>=5){let c,a,l;c=e.map(o=>o.lab()),l=e.length-1,a=yr(l),t=function(o){const f=1-o,d=[0,1,2].map(i=>c.reduce((u,b,y)=>u+a[y]*f**(l-y)*o**y*b[i],0));return new g(d,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return t},mr=e=>{const t=vr(e);return t.scale=()=>xe(t),t},W=(e,t,n)=>{if(!W[n])throw new Error("unknown blend mode "+n);return W[n](e,t)},J=e=>(t,n)=>{const r=A(n).rgb(),s=A(t).rgb();return A.rgb(e(r,s))},Q=e=>(t,n)=>{const r=[];return r[0]=e(t[0],n[0]),r[1]=e(t[1],n[1]),r[2]=e(t[2],n[2]),r},wr=e=>e,xr=(e,t)=>e*t/255,_r=(e,t)=>e>t?t:e,kr=(e,t)=>e>t?e:t,Sr=(e,t)=>255*(1-(1-e/255)*(1-t/255)),Nr=(e,t)=>t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255)),$r=(e,t)=>255*(1-(1-t/255)/(e/255)),Lr=(e,t)=>e===255?255:(e=255*(t/255)/(1-e/255),e>255?255:e);W.normal=J(Q(wr));W.multiply=J(Q(xr));W.screen=J(Q(Sr));W.overlay=J(Q(Nr));W.darken=J(Q(_r));W.lighten=J(Q(kr));W.dodge=J(Q(Lr));W.burn=J(Q($r));const{pow:Mr,sin:Cr,cos:Ar}=Math;function Er(e=300,t=-1.5,n=1,r=1,s=[0,1]){let c=0,a;j(s)==="array"?a=s[1]-s[0]:(a=0,s=[s,s]);const l=function(o){const f=K*((e+120)/360+t*o),d=Mr(s[0]+a*o,r),u=(c!==0?n[0]+o*c:n)*d*(1-d)/2,b=Ar(f),y=Cr(f),M=d+u*(-.14861*b+1.78277*y),S=d+u*(-.29227*b-.90649*y),_=d+u*(1.97294*b);return A(Ye([M*255,S*255,_*255,1]))};return l.start=function(o){return o==null?e:(e=o,l)},l.rotations=function(o){return o==null?t:(t=o,l)},l.gamma=function(o){return o==null?r:(r=o,l)},l.hue=function(o){return o==null?n:(n=o,j(n)==="array"?(c=n[1]-n[0],c===0&&(n=n[1])):c=0,l)},l.lightness=function(o){return o==null?s:(j(o)==="array"?(s=o,a=o[1]-o[0]):(s=[o,o],a=0),l)},l.scale=()=>A.scale(l),l.hue(n),l}const jr="0123456789abcdef",{floor:Or,random:Rr}=Math,zr=()=>{let e="#";for(let t=0;t<6;t++)e+=jr.charAt(Or(Rr()*16));return new g(e,"hex")},{log:ct,pow:qr,floor:Pr,abs:Ir}=Math;function Pt(e,t=null){const n={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return j(e)==="object"&&(e=Object.values(e)),e.forEach(r=>{t&&j(r)==="object"&&(r=r[t]),r!=null&&!isNaN(r)&&(n.values.push(r),n.sum+=r,r<n.min&&(n.min=r),r>n.max&&(n.max=r),n.count+=1)}),n.domain=[n.min,n.max],n.limits=(r,s)=>It(n,r,s),n}function It(e,t="equal",n=7){j(e)=="array"&&(e=Pt(e));const{min:r,max:s}=e,c=e.values.sort((l,o)=>l-o);if(n===1)return[r,s];const a=[];if(t.substr(0,1)==="c"&&(a.push(r),a.push(s)),t.substr(0,1)==="e"){a.push(r);for(let l=1;l<n;l++)a.push(r+l/n*(s-r));a.push(s)}else if(t.substr(0,1)==="l"){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");const l=Math.LOG10E*ct(r),o=Math.LOG10E*ct(s);a.push(r);for(let f=1;f<n;f++)a.push(qr(10,l+f/n*(o-l)));a.push(s)}else if(t.substr(0,1)==="q"){a.push(r);for(let l=1;l<n;l++){const o=(c.length-1)*l/n,f=Pr(o);if(f===o)a.push(c[f]);else{const d=o-f;a.push(c[f]*(1-d)+c[f+1]*d)}}a.push(s)}else if(t.substr(0,1)==="k"){let l;const o=c.length,f=new Array(o),d=new Array(n);let i=!0,u=0,b=null;b=[],b.push(r);for(let S=1;S<n;S++)b.push(r+S/n*(s-r));for(b.push(s);i;){for(let _=0;_<n;_++)d[_]=0;for(let _=0;_<o;_++){const R=c[_];let z=Number.MAX_VALUE,$;for(let L=0;L<n;L++){const N=Ir(b[L]-R);N<z&&(z=N,$=L),d[$]++,f[_]=$}}const S=new Array(n);for(let _=0;_<n;_++)S[_]=null;for(let _=0;_<o;_++)l=f[_],S[l]===null?S[l]=c[_]:S[l]+=c[_];for(let _=0;_<n;_++)S[_]*=1/d[_];i=!1;for(let _=0;_<n;_++)if(S[_]!==b[_]){i=!0;break}b=S,u++,u>200&&(i=!1)}const y={};for(let S=0;S<n;S++)y[S]=[];for(let S=0;S<o;S++)l=f[S],y[l].push(c[S]);let M=[];for(let S=0;S<n;S++)M.push(y[S][0]),M.push(y[S][y[S].length-1]);M=M.sort((S,_)=>S-_),a.push(M[0]);for(let S=1;S<M.length;S+=2){const _=M[S];!isNaN(_)&&a.indexOf(_)===-1&&a.push(_)}}return a}const Fr=(e,t)=>{e=new g(e),t=new g(t);const n=e.luminance(),r=t.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},{sqrt:Z,pow:I,min:Gr,max:Br,atan2:lt,abs:ft,cos:ge,sin:it,exp:Dr,PI:ut}=Math;function Xr(e,t,n=1,r=1,s=1){var c=function(de){return 360*de/(2*ut)},a=function(de){return 2*ut*de/360};e=new g(e),t=new g(t);const[l,o,f]=Array.from(e.lab()),[d,i,u]=Array.from(t.lab()),b=(l+d)/2,y=Z(I(o,2)+I(f,2)),M=Z(I(i,2)+I(u,2)),S=(y+M)/2,_=.5*(1-Z(I(S,7)/(I(S,7)+I(25,7)))),R=o*(1+_),z=i*(1+_),$=Z(I(R,2)+I(f,2)),L=Z(I(z,2)+I(u,2)),N=($+L)/2,h=c(lt(f,R)),m=c(lt(u,z)),k=h>=0?h:h+360,w=m>=0?m:m+360,v=ft(k-w)>180?(k+w+360)/2:(k+w)/2,p=1-.17*ge(a(v-30))+.24*ge(a(2*v))+.32*ge(a(3*v+6))-.2*ge(a(4*v-63));let x=w-k;x=ft(x)<=180?x:w<=k?x+360:x-360,x=2*Z($*L)*it(a(x)/2);const E=d-l,q=L-$,X=1+.015*I(b-50,2)/Z(20+I(b-50,2)),F=1+.045*N,P=1+.015*N*p,U=30*Dr(-I((v-275)/25,2)),D=-(2*Z(I(N,7)/(I(N,7)+I(25,7))))*it(2*a(U)),Se=Z(I(E/(n*X),2)+I(q/(r*F),2)+I(x/(s*P),2)+D*(q/(r*F))*(x/(s*P)));return Br(0,Gr(100,Se))}function Tr(e,t,n="lab"){e=new g(e),t=new g(t);const r=e.get(n),s=t.get(n);let c=0;for(let a in r){const l=(r[a]||0)-(s[a]||0);c+=l*l}return Math.sqrt(c)}const Yr=(...e)=>{try{return new g(...e),!0}catch{return!1}},Hr={cool(){return xe([A.hsl(180,1,.9),A.hsl(250,.7,.4)])},hot(){return xe(["#000","#f00","#ff0","#fff"]).mode("rgb")}},we={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};for(let e of Object.keys(we))we[e.toLowerCase()]=we[e];Object.assign(A,{average:br,bezier:mr,blend:W,cubehelix:Er,mix:ue,interpolate:ue,random:zr,scale:xe,analyze:Pt,contrast:Fr,deltaE:Xr,distance:Tr,limits:It,valid:Yr,scales:Hr,input:C,colors:le,brewer:we});var Ze={exports:{}};Ze.exports;(function(e){(function(t,n,r){function s(o){var f=this,d=l();f.next=function(){var i=2091639*f.s0+f.c*23283064365386963e-26;return f.s0=f.s1,f.s1=f.s2,f.s2=i-(f.c=i|0)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(o),f.s0<0&&(f.s0+=1),f.s1-=d(o),f.s1<0&&(f.s1+=1),f.s2-=d(o),f.s2<0&&(f.s2+=1),d=null}function c(o,f){return f.c=o.c,f.s0=o.s0,f.s1=o.s1,f.s2=o.s2,f}function a(o,f){var d=new s(o),i=f&&f.state,u=d.next;return u.int32=function(){return d.next()*4294967296|0},u.double=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.quick=u,i&&(typeof i=="object"&&c(i,d),u.state=function(){return c(d,{})}),u}function l(){var o=4022871197,f=function(d){d=String(d);for(var i=0;i<d.length;i++){o+=d.charCodeAt(i);var u=.02519603282416938*o;o=u>>>0,u-=o,u*=o,o=u>>>0,u-=o,o+=u*4294967296}return(o>>>0)*23283064365386963e-26};return f}n&&n.exports?n.exports=a:this.alea=a})(te,e)})(Ze);var Wr=Ze.exports,Ke={exports:{}};Ke.exports;(function(e){(function(t,n,r){function s(l){var o=this,f="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var i=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^i^i>>>8},l===(l|0)?o.x=l:f+=l;for(var d=0;d<f.length+64;d++)o.x^=f.charCodeAt(d)|0,o.next()}function c(l,o){return o.x=l.x,o.y=l.y,o.z=l.z,o.w=l.w,o}function a(l,o){var f=new s(l),d=o&&o.state,i=function(){return(f.next()>>>0)/4294967296};return i.double=function(){do var u=f.next()>>>11,b=(f.next()>>>0)/4294967296,y=(u+b)/(1<<21);while(y===0);return y},i.int32=f.next,i.quick=i,d&&(typeof d=="object"&&c(d,f),i.state=function(){return c(f,{})}),i}n&&n.exports?n.exports=a:this.xor128=a})(te,e)})(Ke);var Ur=Ke.exports,Je={exports:{}};Je.exports;(function(e){(function(t,n,r){function s(l){var o=this,f="";o.next=function(){var i=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(i^i<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,l===(l|0)?o.x=l:f+=l;for(var d=0;d<f.length+64;d++)o.x^=f.charCodeAt(d)|0,d==f.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function c(l,o){return o.x=l.x,o.y=l.y,o.z=l.z,o.w=l.w,o.v=l.v,o.d=l.d,o}function a(l,o){var f=new s(l),d=o&&o.state,i=function(){return(f.next()>>>0)/4294967296};return i.double=function(){do var u=f.next()>>>11,b=(f.next()>>>0)/4294967296,y=(u+b)/(1<<21);while(y===0);return y},i.int32=f.next,i.quick=i,d&&(typeof d=="object"&&c(d,f),i.state=function(){return c(f,{})}),i}n&&n.exports?n.exports=a:this.xorwow=a})(te,e)})(Je);var Zr=Je.exports,Qe={exports:{}};Qe.exports;(function(e){(function(t,n,r){function s(l){var o=this;o.next=function(){var d=o.x,i=o.i,u,b;return u=d[i],u^=u>>>7,b=u^u<<24,u=d[i+1&7],b^=u^u>>>10,u=d[i+3&7],b^=u^u>>>3,u=d[i+4&7],b^=u^u<<7,u=d[i+7&7],u=u^u<<13,b^=u^u<<9,d[i]=b,o.i=i+1&7,b};function f(d,i){var u,b=[];if(i===(i|0))b[0]=i;else for(i=""+i,u=0;u<i.length;++u)b[u&7]=b[u&7]<<15^i.charCodeAt(u)+b[u+1&7]<<13;for(;b.length<8;)b.push(0);for(u=0;u<8&&b[u]===0;++u);for(u==8?b[7]=-1:b[u],d.x=b,d.i=0,u=256;u>0;--u)d.next()}f(o,l)}function c(l,o){return o.x=l.x.slice(),o.i=l.i,o}function a(l,o){l==null&&(l=+new Date);var f=new s(l),d=o&&o.state,i=function(){return(f.next()>>>0)/4294967296};return i.double=function(){do var u=f.next()>>>11,b=(f.next()>>>0)/4294967296,y=(u+b)/(1<<21);while(y===0);return y},i.int32=f.next,i.quick=i,d&&(d.x&&c(d,f),i.state=function(){return c(f,{})}),i}n&&n.exports?n.exports=a:this.xorshift7=a})(te,e)})(Qe);var Kr=Qe.exports,Ve={exports:{}};Ve.exports;(function(e){(function(t,n,r){function s(l){var o=this;o.next=function(){var d=o.w,i=o.X,u=o.i,b,y;return o.w=d=d+1640531527|0,y=i[u+34&127],b=i[u=u+1&127],y^=y<<13,b^=b<<17,y^=y>>>15,b^=b>>>12,y=i[u]=y^b,o.i=u,y+(d^d>>>16)|0};function f(d,i){var u,b,y,M,S,_=[],R=128;for(i===(i|0)?(b=i,i=null):(i=i+"\0",b=0,R=Math.max(R,i.length)),y=0,M=-32;M<R;++M)i&&(b^=i.charCodeAt((M+32)%i.length)),M===0&&(S=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,M>=0&&(S=S+1640531527|0,u=_[M&127]^=b+S,y=u==0?y+1:0);for(y>=128&&(_[(i&&i.length||0)&127]=-1),y=127,M=4*128;M>0;--M)b=_[y+34&127],u=_[y=y+1&127],b^=b<<13,u^=u<<17,b^=b>>>15,u^=u>>>12,_[y]=b^u;d.w=S,d.X=_,d.i=y}f(o,l)}function c(l,o){return o.i=l.i,o.w=l.w,o.X=l.X.slice(),o}function a(l,o){l==null&&(l=+new Date);var f=new s(l),d=o&&o.state,i=function(){return(f.next()>>>0)/4294967296};return i.double=function(){do var u=f.next()>>>11,b=(f.next()>>>0)/4294967296,y=(u+b)/(1<<21);while(y===0);return y},i.int32=f.next,i.quick=i,d&&(d.X&&c(d,f),i.state=function(){return c(f,{})}),i}n&&n.exports?n.exports=a:this.xor4096=a})(te,e)})(Ve);var Jr=Ve.exports,et={exports:{}};et.exports;(function(e){(function(t,n,r){function s(l){var o=this,f="";o.next=function(){var i=o.b,u=o.c,b=o.d,y=o.a;return i=i<<25^i>>>7^u,u=u-b|0,b=b<<24^b>>>8^y,y=y-i|0,o.b=i=i<<20^i>>>12^u,o.c=u=u-b|0,o.d=b<<16^u>>>16^y,o.a=y-i|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,l===Math.floor(l)?(o.a=l/4294967296|0,o.b=l|0):f+=l;for(var d=0;d<f.length+20;d++)o.b^=f.charCodeAt(d)|0,o.next()}function c(l,o){return o.a=l.a,o.b=l.b,o.c=l.c,o.d=l.d,o}function a(l,o){var f=new s(l),d=o&&o.state,i=function(){return(f.next()>>>0)/4294967296};return i.double=function(){do var u=f.next()>>>11,b=(f.next()>>>0)/4294967296,y=(u+b)/(1<<21);while(y===0);return y},i.int32=f.next,i.quick=i,d&&(typeof d=="object"&&c(d,f),i.state=function(){return c(f,{})}),i}n&&n.exports?n.exports=a:this.tychei=a})(te,e)})(et);var Qr=et.exports,Ft={exports:{}};(function(e){(function(t,n,r){var s=256,c=6,a=52,l="random",o=r.pow(s,c),f=r.pow(2,a),d=f*2,i=s-1,u;function b($,L,N){var h=[];L=L==!0?{entropy:!0}:L||{};var m=_(S(L.entropy?[$,z(n)]:$??R(),3),h),k=new y(h),w=function(){for(var v=k.g(c),p=o,x=0;v<f;)v=(v+x)*s,p*=s,x=k.g(1);for(;v>=d;)v/=2,p/=2,x>>>=1;return(v+x)/p};return w.int32=function(){return k.g(4)|0},w.quick=function(){return k.g(4)/4294967296},w.double=w,_(z(k.S),n),(L.pass||N||function(v,p,x,E){return E&&(E.S&&M(E,k),v.state=function(){return M(k,{})}),x?(r[l]=v,p):v})(w,m,"global"in L?L.global:this==r,L.state)}function y($){var L,N=$.length,h=this,m=0,k=h.i=h.j=0,w=h.S=[];for(N||($=[N++]);m<s;)w[m]=m++;for(m=0;m<s;m++)w[m]=w[k=i&k+$[m%N]+(L=w[m])],w[k]=L;(h.g=function(v){for(var p,x=0,E=h.i,q=h.j,X=h.S;v--;)p=X[E=i&E+1],x=x*s+X[i&(X[E]=X[q=i&q+p])+(X[q]=p)];return h.i=E,h.j=q,x})(s)}function M($,L){return L.i=$.i,L.j=$.j,L.S=$.S.slice(),L}function S($,L){var N=[],h=typeof $,m;if(L&&h=="object")for(m in $)try{N.push(S($[m],L-1))}catch{}return N.length?N:h=="string"?$:$+"\0"}function _($,L){for(var N=$+"",h,m=0;m<N.length;)L[i&m]=i&(h^=L[i&m]*19)+N.charCodeAt(m++);return z(L)}function R(){try{var $;return u&&($=u.randomBytes)?$=$(s):($=new Uint8Array(s),(t.crypto||t.msCrypto).getRandomValues($)),z($)}catch{var L=t.navigator,N=L&&L.plugins;return[+new Date,t,N,t.screen,z(n)]}}function z($){return String.fromCharCode.apply(0,$)}if(_(r.random(),n),e.exports){e.exports=b;try{u=Wt}catch{}}else r["seed"+l]=b})(typeof self<"u"?self:te,[],Math)})(Ft);var Vr=Ft.exports,eo=Wr,to=Ur,no=Zr,ro=Kr,oo=Jr,so=Qr,ne=Vr;ne.alea=eo;ne.xor128=to;ne.xorwow=no;ne.xorshift7=ro;ne.xor4096=oo;ne.tychei=so;var ao=ne;const co=Ut(ao),dt=e=>e,bt={selectedFeature:null,maxWidth:10,minWidth:1,numStep:100,scale:"linear",fixScale:!1,minVal:0,maxVal:1,cmap:"OrRd",opacity:100,offset:!1,showNaN:!0,reverseColor:!1,extrusion:!1,padding:[0,100],labels:null};function lo(e){return/^#([0-9A-Fa-f]{3}){1,2}$/i.test(e)}function De(e,t,n,r,s,c){if(typeof e=="string")return c?0:co(e)();if(c){if(e<t?e=t:e>n&&(e=n),e=Math.abs(e),t<0&&n>0)n=Math.max(Math.abs(t),Math.abs(n)),t=0;else if(t<0&&n<=0){const l=Math.abs(n);n=Math.max(Math.abs(t),l),t=Math.min(Math.abs(t),l)}}else{if(e<t)return r?1:0;if(e>n)return r?0:1;t<0&&(e=e-t,n=n-t,t=0)}let a=e;return s==="log"?(t<1&&(n+=1,e+=1,t+=1),t=t>0?Math.log10(t):0,n=n>0?Math.log10(n):0,a=e>0?Math.log10(e):0):s==="sqrt"?(t=Math.sqrt(t),n=Math.sqrt(n),a=Math.sqrt(e)):s==="exp"?(t=t/n,e=e/n,n=1,t=10**t,n=10**n,a=10**e):s==="quad"&&(t=t**2,n=n**2,a=e**2),r?a=(-a+n)/(n-t):a=(a-t)/(n-t),a}function fo(){const e=Te(),t=H(re),n=H(re),r=H(re),s=H("LineString"),c=H([]),a=H(ee.cloneDeep(bt)),l=H(""),o=H([]),f=H(!1),d=H({}),i=H([]),u=H({}),b=H({});function y(){t.value=ee.cloneDeep(re),n.value=ee.cloneDeep(re),r.value=ee.cloneDeep(re),s.value="LineString",c.value=[],a.value=ee.cloneDeep(bt),l.value="",o.value=[],f.value=!1,d.value={},i.value=[],u.value={},b.value=null}function M(v,p,x=null){var E;y(),t.value=ee.cloneDeep(v),s.value=(E=t.value.features[0])==null?void 0:E.geometry.type,s.value=s.value==="MultiPolygon"?"Polygon":s.value,s.value!=="Polygon"&&(a.value.extrusion=!1),f.value=typeof p=="object"&&p!==null,f.value&&S(p),Zt(t.value)?(z(),c.value.includes(x==null?void 0:x.selectedFeature)?a.value.selectedFeature=x==null?void 0:x.selectedFeature:a.value.selectedFeature=null,x!=null&&m(x,!0),$(),L()):e.changeNotification({text:dt("invalid or missing CRS. use CRS84 / EPSG:4326"),autoClose:!0,color:"warning"})}function S(v){Object.keys(v).forEach(p=>{d.value[p+" (OD)"]=v[p]}),i.value=Object.keys(d.value),t.value.features.forEach(p=>p.properties.index=String(p.properties.index)),t.value.features.length>0&&i.value.forEach(p=>{u.value[p]=Object.keys(d.value[p]),t.value.features.forEach(x=>x.properties[p]=null)})}function _(v){const p=a.value.selectedFeature;return i.value.includes(p)?u.value[p].includes(v):!1}function R(v){const p=a.value.selectedFeature;if(i.value.includes(p)&&f.value){b.value=v;const x=d.value[p][b.value];t.value.features.forEach(E=>E.properties[p]=x?x[E.properties.index]:null)}$(),L()}function z(){const v=new Set([]);t.value.features.forEach(p=>{Object.keys(p.properties).forEach(x=>v.add(x))}),c.value=Array.from(v),c.value=c.value.filter(p=>!["display_width","display_color"].includes(p)),l.value=v.has("route_type")?"route_type":v.has("highway")?"highway":c.value[0],o.value=Array.from(new Set(t.value.features.map(p=>p.properties[l.value])))}function $(){const v=new Set(o.value),p=l.value,x=a.value.selectedFeature;n.value.features=t.value.features.filter(E=>v.has(E.properties[p])),a.value.showNaN||(r.value.features=n.value.features.filter(q=>!q.properties[x]),t.value.features.filter(q=>q.properties[x]).length===0&&f.value&&Object.keys(u.value).includes(x)||(n.value.features=n.value.features.filter(q=>q.properties[x])))}function L(){const v=a.value.selectedFeature,p=a.value.maxWidth,x=a.value.minWidth,E=a.value.scale,q=a.value.numStep,X=a.value.cmap,F=n.value.features.filter(G=>G.properties[v]).map(G=>G.properties[v]);if(!a.value.fixScale){const G=Bt=>Bt.reduce(([Dt,Xt],tt)=>[Math.min(Dt,tt),Math.max(Xt,tt)],[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]),[Y,Gt]=G(F);a.value.minVal=Math.round(Y*100)/100,a.value.maxVal=Math.round(Gt*100)/100}const P=a.value.minVal,U=a.value.maxVal,V=a.value.reverseColor;n.value.features.forEach(G=>{let Y=G.properties[v];Y=De(Y,P,U,!1,E,!0),G.properties.display_width=(p-x)*Y+x});let D=ee.cloneDeep(a.value.padding);D=[D[0]/100,1-D[1]/100],D=a.value.reverseColor?D.reverse():D;const Se=A.scale(X).padding(D).domain([0,1],E).classes(q);if(n.value.features.forEach(G=>{const Y=G.properties[v];lo(Y)?G.properties.display_color=Y:G.properties.display_color=Se(De(Y,P,U,V,E,!1)).hex()}),t.value.features.filter(G=>G.properties[v]).length===0&&f.value&&Object.keys(u.value).includes(v)){const G=new Set(u.value[v]);n.value.features.forEach(Y=>{G.has(Y.properties.index)&&(Y.properties.display_width=10,Y.properties.display_color="#4CAF50")}),e.changeNotification({text:dt("Clickable element in green"),autoClose:!0,color:"success"})}}function N(v){l.value=v,o.value=Array.from(new Set(t.value.features.map(p=>p.properties[l.value]))),$()}function h(v){o.value=v,$()}function m(v,p=!1){const x=Object.keys(v);for(const E of x)a.value[E]=v[E];p||($(),L())}const k=ie(()=>{let v=Array.from(new Set(t.value.features.map(p=>p.properties[l.value])));return v=v.sort((p,x)=>p-x),v}),w=ie(()=>{const v=[];let p=a.value.padding;p=[p[0]/100,1-p[1]/100],p=a.value.reverseColor?p.reverse():p;const x=A.scale(a.value.cmap).padding(p).domain([0,1]).classes(a.value.numStep);for(let E=0;E<100;E++)v.push(x(De(E,0,100,a.value.reverseColor,a.value.scale,!1)));return v});return{layer:t,type:s,attributes:c,visibleLayer:n,NaNLayer:r,displaySettings:a,selectedFilter:l,selectedCategory:o,hasOD:f,ODfeatures:i,matAvailableIndex:u,matSelectedIndex:b,changeOD:R,isIndexAvailable:_,loadLayer:M,getLinksProperties:z,refreshVisibleLinks:$,updateSelectedFeature:L,changeSelectedFilter:N,changeSelectedCategory:h,applySettings:m,filteredCategory:k,colorScale:w}}const io={class:"map-legend"},uo={__name:"StaticLayer",props:["preset","map","order","visibleRasters"],setup(e){const{$gettext:t}=Kt(),n=Jt(),r=e,{preset:s,map:c,order:a,visibleRasters:l}=Qt(r),o=Vt(),f=en(),d=tn(),i=Te(),u=s.value.name,b=u+"-source",y=u+"-layer",M=u+"-labels",{visibleLayer:S,type:_,loadLayer:R,displaySettings:z,attributes:$,changeSelectedFilter:L,changeSelectedCategory:N,colorScale:h,isIndexAvailable:m,changeOD:k}=fo(),w=s.value.displaySettings.opacity,v=s.value.displaySettings.offset?-1:1,p=s.value.displaySettings.labels;async function x(F,P=null){switch(F){case"links":await R(o.links,null,P);break;case"rlinks":await R(f.rlinks,null,P);break;case"nodes":await R(o.nodes,null,P);break;case"rnodes":await R(f.rnodes,null,P);break;case"od":await R(d.layer,null,P);break;default:const U=await i.getOtherFile(F,"geojson"),V=await i.getOtherFile(F,"json");await R(U,V,P);break}}nn(async()=>{var F;await x(s.value.layer,s.value.displaySettings),$.value.includes((F=s.value)==null?void 0:F.selectedFilter)?(L(s.value.selectedFilter),Object.keys(s.value).includes("selectedCategory")&&N(s.value.selectedCategory)):Object.keys(s.value).includes("selectedFilter")&&i.changeNotification({text:s.value.selectedFilter+" "+t("filter does not exist. use default one"),autoClose:!0,color:"error"}),Object.keys(s.value).includes("selectedIndex")&&m(s.value.selectedIndex)&&(k(s.value.selectedIndex),i.changeNotification({})),S.value.features=S.value.features.map(P=>({geometry:P.geometry,properties:{display_color:P.properties.display_color,display_width:P.properties.display_width,label:P.properties[p]}})),E(),q()});function E(){c.value.addSource(b,{type:"geojson",data:S.value}),_.value==="LineString"?c.value.addLayer({id:y,type:"line",minzoom:5,source:b,layout:{"line-sort-key":["to-number",["get","display_width"]],"line-cap":"round"},paint:{"line-color":["get","display_color"],"line-opacity":w/100,"line-offset":["*",v*.5,["to-number",["get","display_width"]]],"line-width":["get","display_width"]}}):_.value==="Point"?c.value.addLayer({id:y,type:"circle",minzoom:5,source:b,layout:{"circle-sort-key":["to-number",["get","display_width"]]},paint:{"circle-color":["get","display_color"],"circle-radius":["get","display_width"],"circle-opacity":w/100}}):["MultiPolygon","Polygon"].includes(_.value)&&!z.value.extrusion?c.value.addLayer({id:y,type:"fill",minzoom:5,source:b,paint:{"fill-color":["get","display_color"],"fill-opacity":w/100}}):["MultiPolygon","Polygon"].includes(_.value)&&z.value.extrusion&&c.value.addLayer({id:y,type:"fill-extrusion",minzoom:5,source:b,paint:{"fill-extrusion-color":["get","display_color"],"fill-extrusion-opacity":w/100,"fill-extrusion-height":["*",1e3,["to-number",["get","display_width"]]]}}),p!==null&&c.value.addLayer({id:M,source:b,type:"symbol",layout:{"text-field":["get","label"],"text-variable-anchor":["top"],"text-radial-offset":.6,"text-justify":"auto"},paint:{"text-color":n.current.value.colors.black}})}function q(){const F=c.value.getStyle().layers.map(D=>D.id),P=l.value.indexOf(u);let U=l.value.map(D=>D+"-layer").splice(0,P);U=U.filter(D=>F.includes(D));const V=U.slice(-1)[0];V?c.value.moveLayer(y,V):X()}function X(){c.value.getLayer("results")?c.value.moveLayer(y,"results"):c.value.getLayer("staticrLinks")?c.value.moveLayer(y,"staticrLinks"):c.value.getLayer("links")&&c.value.moveLayer(y,"links")}return rn(()=>{c.value.getLayer(M)&&c.value.removeLayer(M),c.value.getLayer(y)&&(c.value.removeLayer(y),c.value.removeSource(b))}),(F,P)=>(ye(),ve("section",null,[ae("div",io,[on(dn,{"color-scale":Ne(h),"display-settings":Ne(z),"base-offset":350,order:Ne(a)},null,8,["color-scale","display-settings","order"])])]))}},bo=ht(uo,[["__scopeId","data-v-da495d59"]]),po=Object.freeze(Object.defineProperty({__proto__:null,default:bo},Symbol.toStringTag,{value:"Module"}));export{dn as M,bo as S,po as a,A as c,fo as u};
