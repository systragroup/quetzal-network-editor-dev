import{au as W,av as F,r as g,_ as T,u as O,ag as j,p as C,g as k,q as b,y as N,l as I,F as $,E as D,j as w,as as L,aw as U,i as y,ax as V,ay as G,x as B,a3 as M,az as P,aA as A,aa as J,aB as q}from"./index-CI8_pTrc.js";function z(n){return W()?(F(n),!0):!1}const K=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const X=K?window:void 0;function Y(n){return l=>{const r=l.data[0];return Promise.resolve(n.apply(void 0,r)).then(t=>{postMessage(["SUCCESS",t])}).catch(t=>{postMessage(["ERROR",t])})}}function H(n,l){if(n.length===0&&l.length===0)return"";const r=n.map(c=>`'${c}'`).toString(),t=l.filter(c=>typeof c=="function").map(c=>{const e=c.toString();return e.trim().startsWith("function")?e:`const ${c.name} = ${e}`}).join(";"),u=`importScripts(${r});`;return`${r.trim()===""?"":u} ${t}`}function Q(n,l,r){const t=`${H(l,r)}; onmessage=(${Y})(${n})`,u=new Blob([t],{type:"text/javascript"});return URL.createObjectURL(u)}function Z(n,l={}){const{dependencies:r=[],localDependencies:t=[],timeout:u,window:c=X}=l,e=g(),f=g("PENDING"),p=g({}),S=g(),o=(a="PENDING")=>{e.value&&e.value._url&&c&&(e.value.terminate(),URL.revokeObjectURL(e.value._url),p.value={},e.value=void 0,c.clearTimeout(S.value),f.value=a)};o(),z(o);const m=()=>{const a=Q(n,r,t),i=new Worker(a);return i._url=a,i.onmessage=h=>{const{resolve:v=()=>{},reject:E=()=>{}}=p.value,[_,R]=h.data;switch(_){case"SUCCESS":v(R),o(_);break;default:E(R),o("ERROR");break}},i.onerror=h=>{const{reject:v=()=>{}}=p.value;h.preventDefault(),v(h),o("ERROR")},u&&(S.value=setTimeout(()=>o("TIMEOUT_EXPIRED"),u)),i},d=(...a)=>new Promise((i,h)=>{p.value={resolve:i,reject:h},e.value&&e.value.postMessage([[...a]]),f.value="RUNNING"});return{workerFn:(...a)=>f.value==="RUNNING"?(console.error("[useWebWorkerFn] You can only run one instance of the worker at a time."),Promise.reject()):(e.value=m(),d(...a)),workerStatus:f,workerTerminate:o}}const x=n=>n,{workerFn:ee}=Z(q),te={name:"ResultTable",setup(){const n=O(),l=j(),r=g([]),t=g(""),u=g(0),c=g(10),e=40;async function f(){const o=l.scenario+"/",d=n.otherFiles.filter(s=>s.extension==="csv");u.value=d.length;for(const s of d)s.content instanceof Uint8Array||(s.content=await L.readBytes(l.model,o+s.path,e));return d}C(async()=>{n.changeLoading(!0);try{const o=await f();for(const m of o){const d=m.path.slice(0,-4),s=m.content!==null?await ee(m.content.buffer):[{too_large:`cannot display, more than ${e} mb`}],a=[];Object.keys(s[0]).forEach(i=>a.push({title:i,key:i,width:"1%"})),r.value.push({headers:a,items:s.slice(0,c.value),data:s,name:d,totalItems:s.length}),u.value-=1}n.changeLoading(!1),r.value.length===0&&(t.value=x("Nothing to display"))}catch(o){console.error(o),n.changeLoading(!1),u.value=0,t.value=x("Nothing to display")}});function p(o,m,d,s){const a=(m-1)*d,i=a+d;if(s.length>0){const h=s[0].key,v=s[0].order;o=J.orderBy(o,h,v)}return o.slice(a,i)}async function S({key:o,page:m,itemsPerPage:d,sortBy:s}){const a=U(r.value[o].data),i=p(a,m,d,U(s));r.value[o].items=i}return{tables:r,message:t,numItems:c,loadItems:S,skeletons:u}}},oe={class:"layout"},ne={key:0},se={key:1,class:"card elevation-3"};function ae(n,l,r,t,u,c){return k(),b("section",oe,[t.tables.length===0?(k(),b("p",ne,N(n.$gettext(t.message)),1)):I("",!0),(k(!0),b($,null,D(t.tables,(e,f)=>(k(),b("div",{key:f,class:"card elevation-3"},[w(P,{"items-per-page":t.numItems,headers:e.headers,height:e.items.length>=10?"36rem":"auto","items-length":e.totalItems,"fixed-header":"","fixed-footer":"",items:e.items,"onUpdate:options":p=>t.loadItems({key:f,...p})},{top:y(()=>[w(V,{class:"custom-title"},{default:y(()=>[w(G,null,{default:y(()=>[B(N(e.name),1)]),_:2},1024),w(M)]),_:2},1024)]),_:2},1032,["items-per-page","headers","height","items-length","items","onUpdate:options"])]))),128)),t.skeletons>0?(k(),b("div",se,[w(A,{type:"heading,table-thead, table-tbody "})])):I("",!0)])}const ce=T(te,[["render",ae],["__scopeId","data-v-0c259f78"]]);export{ce as default};
