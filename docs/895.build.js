"use strict";(self.webpackChunkquetzal_network_editor=self.webpackChunkquetzal_network_editor||[]).push([[895],{87902:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(87537),a=s.n(i),n=s(23645),o=s.n(n)()(a());o.push([e.id,".gradient[data-v-09c04975]{width:60%;white-space:nowrap;position:relative;display:inline-block;padding-top:10px;padding-bottom:10px}.gradient .domain-title[data-v-09c04975]{position:absolute;padding-left:.5rem;padding-top:.5rem;text-align:center;font-size:16px}.grad-step[data-v-09c04975]{display:inline-block;height:40px;width:1%}.subtitle[data-v-09c04975]{font-size:2em;color:var(--v-secondarydark-base) !important;font-weight:bold;padding:1rem}.setting[data-v-09c04975]{left:98%;width:0px;z-index:2;display:flex;position:relative;align-items:center;justify-content:center;height:50px}.setting-card[data-v-09c04975]{overflow-y:auto}","",{version:3,sources:["webpack://./src/components/results/ResultsSettings.vue"],names:[],mappings:"AAGA,2BACI,SAAA,CACA,kBAAA,CACA,iBAAA,CACA,oBAAA,CACA,gBAAA,CACA,mBAAA,CAIJ,yCACI,iBAAA,CACA,kBAAA,CACA,iBAAA,CACA,iBAAA,CACA,cAAA,CAIJ,4BACI,oBAAA,CACA,WAAA,CACA,QAAA,CAGJ,2BACE,aAAA,CACA,4CAAA,CACA,gBAAA,CACA,YAAA,CAIF,0BACE,QAAA,CACA,SAAA,CACA,SAAA,CACA,YAAA,CACA,iBAAA,CACA,kBAAA,CACA,sBAAA,CACA,WAAA,CAEF,+BACA,eAAA",sourcesContent:['@import "@scss/variables.scss";\n\n\n.gradient {\n    width: 60%;\n    white-space: nowrap;\n    position: relative;\n    display: inline-block;\n    padding-top: 10px;\n    padding-bottom: 10px;\n\n}\n\n.gradient .domain-title {\n    position: absolute;\n    padding-left:0.5rem;\n    padding-top:0.5rem;\n    text-align: center;\n    font-size: 16px;\n\n}\n\n.grad-step {\n    display: inline-block;\n    height: 40px;\n    width: 1%;\n}\n\n.subtitle {\n  font-size: 2em;\n  color:  var(--v-secondarydark-base) !important;\n  font-weight: bold;\n  padding:1rem\n\n}\n\n.setting {\n  left: 98%;\n  width: 0px;\n  z-index: 2;\n  display: flex;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n  height: 50px;\n}\n.setting-card {\noverflow-y:auto;\n}\n\n'],sourceRoot:""}]);const l=o},79769:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(87537),a=s.n(i),n=s(23645),o=s.n(n)()(a());o.push([e.id,".left-panel[data-v-fb5e9fee]{height:100%;background-color:var(--v-primarydark-base);transition:.3s;position:absolute;display:flex;z-index:20}.title[data-v-fb5e9fee]{color:#fff}.left-panel-close[data-v-fb5e9fee]{transition:.3s}.left-panel-content[data-v-fb5e9fee]{display:inline-block;width:100%;flex-direction:column;justify-content:space-between;height:100%;overflow:auto}.v-list__tile[data-v-fb5e9fee]{padding:0}.left-panel-toggle-btn[data-v-fb5e9fee]{left:100%;width:25px;z-index:1;background-color:var(--v-primarydark-base);display:flex;position:relative;align-items:center;justify-content:center;height:50px;transition:.3s;cursor:pointer}.left-panel-title[data-v-fb5e9fee]{height:50px;line-height:55px;padding-left:20px;font-size:1.1em;margin-bottom:10px}.trip-list[data-v-fb5e9fee]{height:height;padding-left:20px}.scrollable[data-v-fb5e9fee]{overflow-y:scroll}.drawer-list-item[data-v-fb5e9fee]{padding:0 13px !important;justify-content:flex-start !important;flex:0;transition:.3s}.list-item-icon[data-v-fb5e9fee]{display:flex !important;flex-flow:row !important;justify-content:center !important;margin:0 !important;color:#fff}","",{version:3,sources:["webpack://./src/components/results/ResultsSidePanel.vue"],names:[],mappings:"AAEA,6BACE,WAAA,CACA,0CAAA,CACA,cAAA,CACA,iBAAA,CACA,YAAA,CACA,UAAA,CAEF,wBACE,UAAA,CAEF,mCACA,cAAA,CAEA,qCACE,oBAAA,CACA,UAAA,CACA,qBAAA,CACA,6BAAA,CACA,WAAA,CAEA,aAAA,CAGF,+BACE,SAAA,CAEF,wCACE,SAAA,CACA,UAAA,CACA,SAAA,CACA,0CAAA,CACA,YAAA,CACA,iBAAA,CACA,kBAAA,CACA,sBAAA,CACA,WAAA,CACA,cAAA,CACA,cAAA,CAEF,mCACE,WAAA,CACA,gBAAA,CACA,iBAAA,CACA,eAAA,CACA,kBAAA,CAEF,4BACE,aAAA,CACA,iBAAA,CAGF,6BACG,iBAAA,CAIH,mCACE,yBAAA,CACA,qCAAA,CACA,MAAA,CACA,cAAA,CAGF,iCACE,uBAAA,CACA,wBAAA,CACA,iCAAA,CACA,mBAAA,CACA,UAAA",sourcesContent:['@import "@scss/variables.scss";\n\n.left-panel {\n  height: 100%;\n  background-color: var(--v-primarydark-base);\n  transition: 0.3s;\n  position: absolute;\n  display: flex;\n  z-index: 20;\n}\n.title  {\n  color:white;\n}\n.left-panel-close {\ntransition:0.3s\n}\n.left-panel-content {\n  display:inline-block;\n  width : 100%;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n  //resize: horizontal;\n  overflow: auto;\n\n}\n.v-list__tile {\n  padding: 0\n}\n.left-panel-toggle-btn {\n  left: 100%;\n  width: 25px;\n  z-index: 1;\n  background-color: var(--v-primarydark-base);\n  display: flex;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n  height: 50px;\n  transition: 0.3s;\n  cursor: pointer;\n}\n.left-panel-title {\n  height: 50px;\n  line-height: 55px;\n  padding-left: 20px;\n  font-size: 1.1em;\n  margin-bottom: 10px;\n}\n.trip-list {\n  height: height;\n  padding-left:20px\n}\n\n.scrollable {\n   overflow-y:scroll;\n\n}\n\n.drawer-list-item {\n  padding: 0 13px !important;\n  justify-content: flex-start !important;\n  flex: 0;\n  transition: 0.3s;\n}\n\n.list-item-icon {\n  display: flex !important;\n  flex-flow: row !important;\n  justify-content: center !important;\n  margin: 0 !important;\n  color: white;\n}\n\n'],sourceRoot:""}]);const l=o},7115:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(87537),a=s.n(i),n=s(23645),o=s.n(n)()(a());o.push([e.id,".gradient[data-v-77d246dd]{width:85%;white-space:nowrap;position:relative;display:inline-block;padding-top:20px;padding-bottom:15px}.gradient .domain-title[data-v-77d246dd]{position:absolute;right:25%;left:25%;text-align:center;font-size:11px;top:6px}.gradient .domain-min[data-v-77d246dd]{position:absolute;left:0;font-size:11px;bottom:5px}.gradient .domain-med[data-v-77d246dd]{position:absolute;right:25%;left:25%;text-align:center;font-size:11px;bottom:5px}.gradient .domain-max[data-v-77d246dd]{position:absolute;right:0;font-size:11px;bottom:5px}.grad-step[data-v-77d246dd]{display:inline-block;height:20px;width:1%}","",{version:3,sources:["webpack://./src/components/utils/MapLegend.vue"],names:[],mappings:"AAGA,2BACI,SAAA,CACA,kBAAA,CACA,iBAAA,CACA,oBAAA,CACA,gBAAA,CACA,mBAAA,CAIJ,yCACI,iBAAA,CACA,SAAA,CACA,QAAA,CACA,iBAAA,CACA,cAAA,CACA,OAAA,CAIJ,uCACI,iBAAA,CACA,MAAA,CACA,cAAA,CACA,UAAA,CAEJ,uCACI,iBAAA,CACA,SAAA,CACA,QAAA,CACA,iBAAA,CACA,cAAA,CACA,UAAA,CAEJ,uCACI,iBAAA,CACA,OAAA,CACA,cAAA,CACA,UAAA,CAGJ,4BACI,oBAAA,CACA,WAAA,CACA,QAAA",sourcesContent:['@import "@scss/variables.scss";\n\n\n.gradient {\n    width: 85%;\n    white-space: nowrap;\n    position: relative;\n    display: inline-block;\n    padding-top: 20px;\n    padding-bottom: 15px;\n\n}\n\n.gradient .domain-title {\n    position: absolute;\n    right: 25%;\n    left: 25%;\n    text-align: center;\n    font-size: 11px;\n    top: 6px;\n\n}\n\n.gradient .domain-min {\n    position: absolute;\n    left: 0;\n    font-size: 11px;\n    bottom: 5px;\n}\n.gradient .domain-med {\n    position: absolute;\n    right: 25%;\n    left: 25%;\n    text-align: center;\n    font-size: 11px;\n    bottom: 5px;\n}\n.gradient .domain-max {\n    position: absolute;\n    right: 0;\n    font-size: 11px;\n    bottom: 5px;\n}\n\n.grad-step {\n    display: inline-block;\n    height: 20px;\n    width: 1%;\n}\n'],sourceRoot:""}]);const l=o},64407:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(87537),a=s.n(i),n=s(23645),o=s.n(n)()(a());o.push([e.id,".map-view[data-v-cda74f8a]{height:calc(100% - 50px);width:100%;display:flex}.left-panel[data-v-cda74f8a]{height:100%;position:absolute}.legend-open[data-v-cda74f8a]{left:350px;width:160px;z-index:3;display:flex;position:relative;align-items:center;justify-content:center;transition:.3s;height:50px;background-color:var(--v-white-base);border:thin solid var(--v-mediumgrey-base)}.legend-close[data-v-cda74f8a]{left:50px;width:160px;z-index:3;display:flex;position:relative;align-items:center;justify-content:center;transition:.3s;height:50px;background-color:var(--v-lightgrey);border:thin solid #c4c4c4}.hist[data-v-cda74f8a]{position:relative;bottom:-10px;flex-grow:1;height:20px;background-color:#e71111;text-align:center;width:10px}","",{version:3,sources:["webpack://./src/pages/ResultMap.vue"],names:[],mappings:"AAEA,2BACE,wBAAA,CACA,UAAA,CACA,YAAA,CAGF,6BACE,WAAA,CACA,iBAAA,CAGF,8BACE,UAAA,CACA,WAAA,CACA,SAAA,CACA,YAAA,CACA,iBAAA,CACA,kBAAA,CACA,sBAAA,CACA,cAAA,CACA,WAAA,CACA,oCAAA,CACA,0CAAA,CAEF,+BACE,SAAA,CACA,WAAA,CACA,SAAA,CACA,YAAA,CACA,iBAAA,CACA,kBAAA,CACA,sBAAA,CACA,cAAA,CACA,WAAA,CACA,mCAAA,CACA,yBAAA,CAGF,uBACE,iBAAA,CACA,YAAA,CACA,WAAA,CACA,WAAA,CACA,wBAAA,CACA,iBAAA,CACA,UAAA",sourcesContent:['@import "@scss/variables.scss";\n\n.map-view {\n  height: calc(100% - 50px);\n  width: 100%;\n  display: flex;\n\n}\n.left-panel {\n  height: 100%;\n  position: absolute;\n\n}\n.legend-open {\n  left: 350px;\n  width: 160px;\n  z-index: 3;\n  display: flex;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n  transition: 0.3s;\n  height: 50px;\n  background-color: var(--v-white-base);\n  border: thin solid var(--v-mediumgrey-base);\n}\n.legend-close {\n  left: 50px;\n  width: 160px;\n  z-index: 3;\n  display: flex;\n  position: relative;\n  align-items: center;\n  justify-content: center;\n  transition: 0.3s;\n  height: 50px;\n  background-color: var(--v-lightgrey);\n  border: thin solid rgb(196, 196, 196);\n}\n\n.hist {\n  position: relative;\n  bottom: -10px;\n  flex-grow: 1;\n  height: 20px;\n  background-color: rgba(231, 17, 17);\n  text-align: center;\n  width:10px;\n}\n\n'],sourceRoot:""}]);const l=o},19895:(e,t,s)=>{s.r(t),s.d(t,{default:()=>V});var i=function(){var e=this,t=e._self._c;return t("section",{staticClass:"map-view"},[t("ResultsSidePanel",{attrs:{"selected-filter":e.selectedFilter,"layer-choices":e.availableLayers,"selected-layer":e.selectedLayer,"filter-choices":e.filterChoices,"filtered-cat":e.filteredCategory},on:{"update-selectedFilter":e.updateSelectedFilter,"select-layer":e.changeLayer},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}}),e._v(" "),t("ResultsSettings",{attrs:{"display-settings":e.displaySettings,"feature-choices":e.filterChoices},on:{submit:e.applySettings},model:{value:e.showSettings,callback:function(t){e.showSettings=t},expression:"showSettings"}}),e._v(" "),t("div",{staticClass:"left-panel"},[t("div",{class:e.$store.getters.showLeftPanel?"legend-open elevation-4":"legend-close elevation-4",style:{top:`${e.windowHeight}px`}},[t("MapLegend",{attrs:{"color-scale":e.colorScale,"display-settings":e.displaySettings}})],1)]),e._v(" "),t("MapResults",{key:e.$store.getters["results/type"],attrs:{links:e.visibleLinks,"selected-feature":e.displaySettings.selectedFeature,opacity:e.displaySettings.opacity,offset:e.displaySettings.offset},on:{selectClick:e.featureClicked}}),e._v(" "),t("v-dialog",{attrs:{scrollable:"",persistent:"","max-width":"300"},on:{keydown:[function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.showDialog=!1},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.showDialog=!1}]},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[t("v-card",{attrs:{"max-height":"60rem"}},[t("v-card-title",{staticClass:"text-h5"},[e._v("\n        "+e._s(e.$gettext("link Properties"))+"\n      ")]),e._v(" "),t("v-divider"),e._v(" "),t("v-card-text",[t("v-list",e._l(e.form,(function(e,s){return t("v-text-field",{key:s,attrs:{value:e,label:s,filled:"",readonly:""}})})),1)],1),e._v(" "),t("v-divider"),e._v(" "),t("v-card-actions",[t("v-spacer"),e._v(" "),t("v-btn",{attrs:{color:"success",text:""},on:{click:function(t){e.showDialog=!1}}},[e._v("\n          "+e._s(e.$gettext("ok"))+"\n        ")])],1)],1)],1)],1)};i._withStripped=!0;var a=function(){var e=this,t=e._self._c;return t("section",{class:e.showLeftPanel?"left-panel elevation-4":"left-panel-close",style:{width:e.showLeftPanel?"350px":"0px"}},[t("div",{staticClass:"left-panel-toggle-btn elevation-4",on:{click:function(t){return e.$store.commit("changeLeftPanel")}}},[t("v-icon",{attrs:{small:"",color:"secondarydark"}},[e._v("\n      "+e._s(e.showLeftPanel?"fas fa-chevron-left":"fas fa-chevron-right")+"\n    ")])],1),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showLeftPanelContent,expression:"showLeftPanelContent"}],staticClass:"left-panel-content"},[t("div",[t("div",{style:{"margin-top":"20px","margin-bottom":"20px","margin-right":"20px"}},[t("v-card-title",{staticClass:"white--text secondary"},[t("v-tooltip",{attrs:{bottom:"","open-delay":"500"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:i}){return[t("v-btn",e._g(e._b({staticClass:"ma-2",style:{color:"white"},attrs:{icon:""},on:{click:function(t){return e.showAll()}}},"v-btn",i,!1),s),[t("v-icon",{staticClass:"list-item-icon"},[e._v("\n                    "+e._s(e.selectedCat.length>0?"fa-eye fa":"fa-eye-slash fa")+"\n                  ")])],1)]}}])},[e._v(" "),t("span",[e._v(e._s(e.selectedCat.length>0?e.$gettext("Hide All"):e.$gettext("Show All")))])]),e._v(" "),t("v-spacer"),e._v(" "),t("v-menu",{attrs:{"close-delay":"100","offset-y":"",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:i}){return[t("span",e._g(e._b({staticClass:"title"},"span",i,!1),s),[e._v(e._s(e.selectedLayer))])]}}]),model:{value:e.openMenu,callback:function(t){e.openMenu=t},expression:"openMenu"}},[e._v(" "),t("v-list",e._l(e.layerChoices,(function(s,i){return t("v-list-item",{key:i,attrs:{link:""},on:{click:()=>e.$emit("select-layer",s)}},[t("v-list-item-title",[e._v("\n                    "+e._s(s)+"\n                  ")])],1)})),1)],1),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"ma-2",style:{color:"white"},attrs:{icon:"",dark:""},on:{click:function(t){e.openMenu=!e.openMenu}}},[t("v-icon",[e._v(" "+e._s(e.openMenu?"fas fa-chevron-left":"fas fa-chevron-down"))])],1)],1),e._v(" "),t("v-card",{staticClass:"mx-auto scrollable",attrs:{"max-width":"100%","min-width":"100%",height:e.windowHeight}},[t("v-list-item",[t("v-select",{attrs:{items:e.filterChoices,"prepend-icon":"fas fa-filter",label:e.$gettext("filter"),"item-color":"secondarydark",color:"secondarydark"},model:{value:e.vmodelSelectedFilter,callback:function(t){e.vmodelSelectedFilter=t},expression:"vmodelSelectedFilter"}})],1),e._v(" "),t("v-virtual-scroll",{attrs:{items:e.filteredCat,"item-height":45,height:e.windowHeight-80},scopedSlots:e._u([{key:"default",fn:function({item:s}){return[t("v-list-item",{key:e.vmodelSelectedFilter.concat(s),staticClass:"pl-2"},[t("v-list-item-action",[t("v-checkbox",{staticClass:"pl-2",attrs:{"on-icon":"fa-eye fa","off-icon":"fa-eye-slash fa",color:"primary",value:s,size:"10","hide-details":""},model:{value:e.selectedCat,callback:function(t){e.selectedCat=t},expression:"selectedCat"}})],1),e._v(" "),t("v-list-item-title",[e._v("\n                    "+e._s(s)+"\n                  ")])],1)]}}])})],1)],1)])])])],1)};a._withStripped=!0;const n={name:"SidePanel",components:{},model:{prop:"selectedCategory",event:"update-selectedCategory"},props:["selectedCategory","selectedFilter","filterChoices","filteredCat","layerChoices","selectedLayer"],events:["update-selectedCategory","select-layer","update-selected-filter"],data:()=>({showLeftPanelContent:!0,height:null,editorTrip:!1,showDialog:!1,openMenu:!1,selectedCat:[],vmodelSelectedFilter:""}),computed:{showLeftPanel(){return this.$store.getters.showLeftPanel},windowHeight(){return this.$store.getters.windowHeight-130},running(){return this.$store.getters["run/running"]}},watch:{showLeftPanel(e){e?setTimeout((()=>{this.showLeftPanelContent=!0}),500):this.showLeftPanelContent=!1},selectedCat(e){this.$emit("update-selectedCategory",e)},selectedFilter(e){e!==this.vmodelSelectedFilter&&(this.vmodelSelectedFilter=e,this.selectedCat=this.selectedCategory)},vmodelSelectedFilter(e,t){t&&(this.$emit("update-selectedFilter",e),this.selectedCat=this.selectedCategory)}},created(){this.selectedCat=this.selectedCategory,this.vmodelSelectedFilter=this.selectedFilter},methods:{showAll(){this.selectedCat.length===this.filteredCat.length?this.selectedCat=[]:this.selectedCat=this.filteredCat}}};var o=s(93379),l=s.n(o),r=s(7795),c=s.n(r),d=s(90569),p=s.n(d),A=s(3565),h=s.n(A),m=s(19216),u=s.n(m),g=s(44589),v=s.n(g),C=s(79769),y={};y.styleTagTransform=v(),y.setAttributes=h(),y.insert=p().bind(null,"head"),y.domAPI=c(),y.insertStyleElement=u(),l()(C.Z,y),C.Z&&C.Z.locals&&C.Z.locals;var f=s(51900);const x=(0,f.Z)(n,a,[],!1,null,"fb5e9fee",null).exports;var b=function(){var e=this,t=e._self._c;return t("MglMap",{key:e.mapStyle,style:{width:"100%"},attrs:{"access-token":e.mapboxPublicKey,"map-style":e.mapStyle,center:e.$store.getters.mapCenter,zoom:e.$store.getters.mapZoom},on:{load:e.onMapLoaded}},[t("MglScaleControl",{attrs:{position:"bottom-right"}}),e._v(" "),t("MglNavigationControl",{attrs:{position:"bottom-right"}}),e._v(" "),"LineString"==e.layerType?t("MglGeojsonLayer",{attrs:{"source-id":"links",source:{type:"geojson",data:e.links,buffer:0,promoteId:"index"},"layer-id":"links",layer:{interactive:!0,type:"line",minzoom:e.minZoom.links,paint:{"line-color":["case",["has","display_color"],["get","display_color"],"#B5E0D6"],"line-offset":["*",.5*e.offsetValue,["to-number",["get","display_width"]]],"line-opacity":e.opacity/100,"line-blur":["case",["boolean",["feature-state","hover"],!1],6,0],"line-width":["case",["has","display_width"],["get","display_width"],4]},layout:{"line-sort-key":["to-number",["get","display_width"]],"line-cap":"round"}}},on:{mouseenter:e.enterLink,mouseleave:e.leaveLink,click:e.zoneClick,contextmenu:e.selectClick}}):e._e(),e._v(" "),"Point"==e.layerType?t("MglGeojsonLayer",{attrs:{"source-id":"nodes",source:{type:"geojson",data:e.links,buffer:0,promoteId:"index"},"layer-id":"nodes",layer:{interactive:!0,type:"circle",minzoom:e.minZoom.links,paint:{"circle-color":["case",["has","display_color"],["get","display_color"],"#B5E0D6"],"circle-radius":["case",["has","display_width"],["get","display_width"],3],"circle-opacity":e.opacity/100},layout:{"circle-sort-key":["to-number",["get","display_width"]]}}},on:{mouseenter:e.enterLink,mouseleave:e.leaveLink,click:e.zoneClick,contextmenu:e.selectClick}}):e._e(),e._v(" "),"LineString"==e.layerType?t("MglImageLayer",{attrs:{"source-id":"links",type:"symbol",source:"links","layer-id":"arrow",layer:{type:"symbol",minzoom:e.minZoom.nodes,layout:{"symbol-placement":"line","symbol-spacing":200,"icon-ignore-placement":!0,"icon-image":"arrow","icon-size":["*",.1,["to-number",["get","display_width"]]],"icon-rotate":90,"icon-offset":[5*e.offsetValue,5]},paint:{"icon-color":["case",["has","display_color"],["get","display_color"],"#B5E0D6"],"icon-opacity":e.opacity/100}}}}):e._e(),e._v(" "),"Polygon"===e.layerType?t("MglGeojsonLayer",{attrs:{"source-id":"polygon",source:{type:"geojson",data:e.links,promoteId:"index"},"layer-id":"zones",layer:{interactive:!0,type:"fill",paint:{"fill-color":["case",["has","display_color"],["get","display_color"],e.$vuetify.theme.currentTheme.linksprimary],"fill-opacity":e.opacity/100}}},on:{click:e.zoneClick,contextmenu:e.selectClick}}):e._e(),e._v(" "),"Polygon"===e.layerType?t("MglGeojsonLayer",{attrs:{"source-id":"NaNPolygon",source:{type:"geojson",data:e.NaNLinks,promoteId:"index"},"layer-id":"NaNZones",layer:{interactive:!0,type:"fill",paint:{"fill-outline-color":"#cccccc","fill-color":"rgba(0, 0, 0, 0)"}}},on:{click:e.zoneClick,contextmenu:e.selectClick}}):e._e()],1)};b._withStripped=!0;var w=s(6158),k=s.n(w),_=s(1963),S=s(22317),L=s(39034),$=s(1449);const B={name:"ResultMap",components:{MglMap:_.Q3,MglNavigationControl:_.RV,MglScaleControl:_.RQ,MglGeojsonLayer:_.tf,MglImageLayer:_.vV},props:["links","selectedFeature","opacity","offset"],events:["selectClick"],data:()=>({mapIsLoaded:!1,mapboxPublicKey:null,selectedLinks:[],minZoom:{nodes:14,links:2}}),computed:{mapStyle(){return this.$store.getters.mapStyle},layerType(){return this.$store.getters["results/type"]},offsetValue(){return this.offset?-1:1},NaNLinks(){return this.$store.getters["results/NaNLinks"]}},watch:{mapStyle(e){this.map&&(this.map.getLayer("arrow")&&this.map.removeLayer("arrow"),this.map.getLayer("links")&&this.map.removeLayer("links"),this.map.getLayer("zones")&&this.map.removeLayer("zones"),this.map.getLayer("nodes")&&this.map.removeLayer("nodes"),this.mapIsLoaded=!1,this.saveMapPosition())}},created(){this.mapboxPublicKey="pk.eyJ1Ijoic2JvaXZpbiIsImEiOiJja3BlMm41cm4xa2QyMnZwZTBqdGx4bHI0In0.11oH2-B2g9J6LarDnoqQfQ"},beforeDestroy(){this.map.getLayer("arrow")&&this.map.removeLayer("arrow"),this.saveMapPosition()},methods:{saveMapPosition(){const e=this.map.getCenter();this.$store.commit("saveMapPosition",{mapCenter:[e.lng,e.lat],mapZoom:this.map.getZoom()})},onMapLoaded(e){this.map&&(this.mapIsLoaded=!1);const t=new(k().LngLatBounds);"Polygon"===this.layerType?this.links.features.forEach((e=>{try{"Polygon"===e.geometry.type?t.extend([e.geometry.coordinates[0][0],e.geometry.coordinates[0][e.geometry.coordinates.length-1]]):t.extend([e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][e.geometry.coordinates.length-1]])}catch(e){}})):this.links.features.forEach((e=>{t.extend([e.geometry.coordinates[0],e.geometry.coordinates[e.geometry.coordinates.length-1]])})),0!==Object.keys(t).length&&e.map.fitBounds(t,{padding:100}),e.map.loadImage(S,(function(t,s){t?console.error("err image",t):e.map.addImage("arrow",s,{sdf:!0})})),this.map=e.map,e.map.dragRotate.disable(),this.mapIsLoaded=!0},enterLink(e){if(e.map.getCanvas().style.cursor="pointer",this.selectedLinks=e.mapboxEvent.features,this.popup?.isOpen()&&this.popup.remove(),this.selectedFeature.length>0&&"Polygon"!==this.layerType){const t=this.selectedLinks[0].properties[this.selectedFeature];this.popup=new(k().Popup)({closeButton:!1}).setLngLat([e.mapboxEvent.lngLat.lng,e.mapboxEvent.lngLat.lat]).setHTML(`${this.selectedFeature}: <br> ${t}`).addTo(e.map)}},leaveLink(e){this.selectedLinks=[],this.popup?.isOpen()&&this.popup.remove(),e.map.getCanvas().style.cursor=""},selectClick(e){this.selectedLinks=e.mapboxEvent.features,this.selectedLinks?.length>0&&this.$emit("selectClick",{feature:this.selectedLinks[0].properties,action:"featureClick"})},zoneClick(e){this.selectedLinks=e.mapboxEvent.features,this.selectedLinks?.length>0&&this.$emit("selectClick",{feature:this.selectedLinks[0].properties,action:"zoneClick"})},zoneHover(e){if(this.selectedLinks[0]?.id!==e.mapboxEvent.features[0].id&&(this.selectedLinks=e.mapboxEvent.features,this.popup?.isOpen()&&this.popup.remove(),this.selectedFeature.length>0)){const t=this.selectedLinks[0].properties[this.selectedFeature];this.popup=new(k().Popup)({closeButton:!1}).setLngLat(function(e,t){void 0===t&&(t={});var s=0,i=0,a=0;return(0,L.pZ)(e,(function(e){s+=e[0],i+=e[1],a++}),!0),(0,$.xm)([s/a,i/a],t.properties)}(this.selectedLinks[0].geometry).geometry.coordinates).setHTML(`${this.selectedFeature}: <br> ${t}`).addTo(e.map)}}}},F=(0,f.Z)(B,b,[],!1,null,"abef94c2",null).exports;var E=function(){var e=this,t=e._self._c;return t("v-menu",{attrs:{"close-on-content-click":!1,"close-on-click":!1,origin:"top right",transition:"scale-transition","position-y":30,"nudge-width":200,"offset-x":"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:i}){return[t("div",{staticClass:"setting"},[t("v-btn",e._g(e._b({attrs:{fab:"",small:""}},"v-btn",i,!1),s),[t("v-icon",{attrs:{color:isFinite(e.displaySettings.maxVal)?"regular":"error"}},[e._v("\n          fa-solid fa-cog\n        ")])],1)],1)]}}]),model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[e._v(" "),t("v-card",{staticClass:"setting-card",attrs:{"max-width":"20rem","max-height":e.windowHeight},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.cancel.apply(null,arguments)}]}},[t("v-card-title",{staticClass:"subtitle"},[e._v("\n      "+e._s(e.$gettext("Settings"))+"\n      "),t("v-spacer"),e._v(" "),t("v-btn",{attrs:{icon:"",small:""},on:{click:e.cancel}},[t("v-icon",{attrs:{color:"regular"}},[e._v("\n          fa-solid fa-times\n        ")])],1)],1),e._v(" "),t("v-card-text",[t("v-form",{ref:"form",attrs:{"lazy-validation":""}},[t("v-container",[t("v-col",[t("v-select",{attrs:{items:e.featureChoices,label:e.$gettext(e.parameters[0].name),hint:e.showHint?e.$gettext(e.parameters[0].hint):"","persistent-hint":e.showHint,required:""},model:{value:e.parameters[0].value,callback:function(t){e.$set(e.parameters[0],"value",t)},expression:"parameters[0].value"}}),e._v(" "),t("v-row",e._l(e.parameters.slice(1,3),(function(s){return t("v-col",{key:s.name},[t("v-text-field",{attrs:{type:s.type,label:e.$gettext(s.name),suffix:s.units,hint:e.showHint?e.$gettext(s.hint):"","persistent-hint":e.showHint,required:""},on:{wheel:()=>{}},model:{value:s.value,callback:function(t){e.$set(s,"value",t)},expression:"item.value"}})],1)})),1),e._v(" "),t("v-text-field",{attrs:{type:e.parameters[3].type,label:e.$gettext(e.parameters[3].name),suffix:e.parameters[3].units,hint:e.showHint?e.$gettext(e.parameters[3].hint):"","persistent-hint":e.showHint,required:""},on:{wheel:()=>{}},model:{value:e.parameters[3].value,callback:function(t){e.$set(e.parameters[3],"value",t)},expression:"parameters[3].value"}}),e._v(" "),t("v-select",{attrs:{items:e.parameters[5].choices,label:e.$gettext(e.parameters[5].name),hint:e.showHint?e.$gettext(e.parameters[5].hint):"","persistent-hint":e.showHint,required:""},model:{value:e.parameters[5].value,callback:function(t){e.$set(e.parameters[5],"value",t)},expression:"parameters[5].value"}}),e._v(" "),t("v-select",{attrs:{items:e.parameters[6].choices,label:e.$gettext(e.parameters[6].name),hint:e.showHint?e.$gettext(e.parameters[6].hint):"","persistent-hint":e.showHint,required:""},scopedSlots:e._u([{key:"item",fn:function({item:s}){return[t("div",{staticClass:"gradient"},[e._l(e.getColor(s),(function(e,s){return t("span",{key:s,staticClass:"grad-step",style:{backgroundColor:e}})})),e._v(" "),t("span",{staticClass:"domain-title"},[e._v(e._s(s))])],2)]}}]),model:{value:e.parameters[6].value,callback:function(t){e.$set(e.parameters[6],"value",t)},expression:"parameters[6].value"}}),e._v(" "),t("v-slider",{staticClass:"align-center",attrs:{"inverse-label":"",label:e.$gettext(e.parameters[4].name),"track-color":"secondary",max:100,"thumb-label":"",min:0,"hide-details":""},scopedSlots:e._u([{key:"thumb-label",fn:function({value:t}){return[e._v("\n                "+e._s(t+"%")+"\n              ")]}}]),model:{value:e.parameters[4].value,callback:function(t){e.$set(e.parameters[4],"value",t)},expression:"parameters[4].value"}}),e._v(" "),t("v-switch",{key:e.parameters[12].name,attrs:{label:e.$gettext(e.parameters[12].name),hint:e.showHint?e.$gettext(e.parameters[12].hint):"","persistent-hint":e.showHint},model:{value:e.parameters[12].value,callback:function(t){e.$set(e.parameters[12],"value",t)},expression:"parameters[12].value"}}),e._v(" "),t("v-switch",{key:e.parameters[7].name,attrs:{label:e.$gettext(e.parameters[7].name),hint:e.showHint?e.$gettext(e.parameters[7].hint):"","persistent-hint":e.showHint},model:{value:e.parameters[7].value,callback:function(t){e.$set(e.parameters[7],"value",t)},expression:"parameters[7].value"}}),e._v(" "),t("v-switch",{key:e.parameters[8].name,attrs:{label:e.$gettext(e.parameters[8].name),hint:e.showHint?e.$gettext(e.parameters[7].hint):"","persistent-hint":e.showHint},model:{value:e.parameters[8].value,callback:function(t){e.$set(e.parameters[8],"value",t)},expression:"parameters[8].value"}}),e._v(" "),t("v-switch",{key:e.parameters[11].name,attrs:{label:e.$gettext(e.parameters[11].name),hint:e.showHint?e.$gettext(e.parameters[11].hint):"","persistent-hint":e.showHint},on:{click:function(t){return e.toggleFixScale(e.parameters[11].name)}},model:{value:e.parameters[11].value,callback:function(t){e.$set(e.parameters[11],"value",t)},expression:"parameters[11].value"}}),e._v(" "),e._l(e.parameters.slice(9,11),(function(s){return t("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.showFixScale,expression:"showFixScale"}],key:s.name,attrs:{type:s.type,label:e.$gettext(s.name),suffix:s.units,hint:e.showHint?e.$gettext(s.hint):"","persistent-hint":e.showHint,required:""},on:{wheel:()=>{}},model:{value:s.value,callback:function(t){e.$set(s,"value",t)},expression:"item.value"}})}))],2)],1)],1)],1),e._v(" "),t("v-card-actions",[t("v-btn",{attrs:{color:"grey",text:""},on:{click:e.cancel}},[e._v("\n        "+e._s(e.$gettext("Cancel"))+"\n      ")]),e._v(" "),t("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.submit}},[e._v("\n        "+e._s(e.$gettext("Save"))+"\n      ")]),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){e.showHint=!e.showHint}}},[t("v-icon",[e._v("far fa-question-circle small")])],1)],1)],1)],1)};E._withStripped=!0;var M=s(28670),z=s.n(M);const H={name:"ResultsSettings",model:{prop:"show",event:"update-show"},props:["show","displaySettings","featureChoices"],events:["update-show","submit"],data(){return{parameters:[{name:"selectedFeature",type:"String",value:this.displaySettings.selectedFeature,units:"",hint:"selectedFeature"},{name:"maxWidth",type:"Number",value:this.displaySettings.maxWidth,units:"a.u.",hint:"maxWidth"},{name:"minWidth",type:"Number",value:this.displaySettings.minWidth,units:"a.u.",hint:"minWidth"},{name:"numStep",type:"Number",value:this.displaySettings.numStep,units:"int",hint:"numStep"},{name:"opacity",type:"Number",value:this.displaySettings.opacity,units:"number",hint:"opacity"},{name:"scale",type:"String",value:this.displaySettings.scale,choices:["linear","sqrt","log"],units:"",hint:"scale"},{name:"color map",type:"String",choices:Object.keys(z().brewer).slice(0,36),value:this.displaySettings.cmap,units:"",hint:"cmap to use"},{name:"show NaN",value:this.displaySettings.showNaN,hint:"Hide NaN on map and color map"},{name:"reverse color",value:this.displaySettings.reverseColor,hint:"reverse color scale"},{name:"scale min",type:"Number",value:this.displaySettings.minVal,units:"a.u.",hint:"mininum value on the color Map"},{name:"scale max",type:"Number",value:this.displaySettings.maxVal,units:"a.u.",hint:"maximum value on the color Map"},{name:"custom scale",value:this.displaySettings.fixScale,hint:"customize to inputs values"},{name:"Left side driving",value:this.displaySettings.offset,hint:"Select which side of the road the links are display"}],errorMessage:null,showHint:!1,showFixScale:!1,shake:!1,rules:{required:e=>!!e||"Required",largerThanZero:e=>e>0||"should be larger than 0",nonNegative:e=>e>=0||"should be larger or equal to 0"},showDialog:!1}},computed:{windowHeight(){return this.$store.getters.windowHeight-100}},watch:{showDialog(e){this.refresh(),this.showFixScale=this.parameters[11].value,this.$emit("update-show",e)},featureChoices(){this.refresh()}},created(){this.showDialog=this.show},methods:{toggleFixScale(){this.parameters[11].value?(this.showFixScale=!0,this.parameters[9].value=this.displaySettings.minVal,this.parameters[10].value=this.displaySettings.maxVal):this.showFixScale=!1},getColor(e){const t=[],s=z().scale(e).padding([.2,0]).domain([0,100]).classes(25);for(let e=0;e<100;e++)t.push(s(e).hex());return t},refresh(){this.parameters[0].value=this.displaySettings.selectedFeature,this.parameters[1].value=this.displaySettings.maxWidth,this.parameters[2].value=this.displaySettings.minWidth,this.parameters[3].value=this.displaySettings.numStep,this.parameters[4].value=this.displaySettings.opacity,this.parameters[5].value=this.displaySettings.scale,this.parameters[6].value=this.displaySettings.cmap,this.parameters[7].value=this.displaySettings.showNaN,this.parameters[8].value=this.displaySettings.reverseColor,this.parameters[9].value=this.displaySettings.minVal,this.parameters[10].value=this.displaySettings.maxVal,this.parameters[11].value=this.displaySettings.fixScale,this.parameters[12].value=this.displaySettings.offset},submit(){this.$refs.form.validate()?this.$emit("submit",{selectedFeature:this.parameters[0].value,maxWidth:Number(this.parameters[1].value),minWidth:Number(this.parameters[2].value),numStep:Number(this.parameters[3].value),opacity:Number(this.parameters[4].value),scale:this.parameters[5].value,cmap:this.parameters[6].value,showNaN:this.parameters[7].value,reverseColor:this.parameters[8].value,minVal:Number(this.parameters[9].value),maxVal:Number(this.parameters[10].value),fixScale:this.parameters[11].value,offset:this.parameters[12].value}):(this.shake=!0,setTimeout((()=>{this.shake=!1}),500))},cancel(){this.showDialog=!1}}};var P=s(87902),Z={};Z.styleTagTransform=v(),Z.setAttributes=h(),Z.insert=p().bind(null,"head"),Z.domAPI=c(),Z.insertStyleElement=u(),l()(P.Z,Z),P.Z&&P.Z.locals&&P.Z.locals;const I=(0,f.Z)(H,E,[],!1,null,"09c04975",null).exports;var N=function(){var e=this,t=e._self._c;return t("div",{staticClass:"gradient"},[e._l(e.colorScale,(function(e,s){return t("span",{key:s,staticClass:"grad-step",style:{backgroundColor:e}})})),e._v(" "),t("span",{staticClass:"domain-title"},[e._v(e._s(e.displaySettings.selectedFeature))]),e._v(" "),t("span",{staticClass:"domain-min"},[e._v(e._s(Math.round(e.displaySettings.minVal)))]),e._v(" "),t("span",{staticClass:"domain-med"},[e._v(e._s(Math.round((e.displaySettings.maxVal+e.displaySettings.minVal)/2)))]),e._v(" "),t("span",{staticClass:"domain-max"},[e._v(e._s(Math.round(e.displaySettings.maxVal)))])],2)};N._withStripped=!0;const j={name:"MapLegend",components:{},props:{colorScale:{type:Array,default:()=>[]},displaySettings:{type:Object,default:()=>{}}},data:()=>({}),watch:{},methods:{}};var T=s(7115),W={};W.styleTagTransform=v(),W.setAttributes=h(),W.insert=p().bind(null,"head"),W.domAPI=c(),W.insertStyleElement=u(),l()(T.Z,W),T.Z&&T.Z.locals&&T.Z.locals;const D={name:"ResultMap",components:{ResultsSidePanel:x,MapResults:F,ResultsSettings:I,MapLegend:(0,f.Z)(j,N,[],!1,null,"77d246dd",null).exports},data:()=>({mapIsLoaded:!1,minZoom:{nodes:14,links:8},showSettings:!1,selectedLayer:"links",selectedCategory:[],form:{},showDialog:!1}),computed:{windowHeight(){return this.$store.getters.windowHeight-100},availableLayers(){return this.$store.getters.availableLayers},links(){return this.$store.getters["results/links"]},visibleLinks(){return this.$store.getters["results/visibleLinks"]},filterChoices(){return this.$store.getters["results/lineAttributes"]},displaySettings(){return this.$store.getters["results/displaySettings"]},selectedFilter(){return this.$store.getters["results/selectedFilter"]},colorScale(){return this.$store.getters["results/colorScale"]},filteredCategory(){return Array.from(new Set(this.links.features.map((e=>e.properties[this.selectedFilter]))))}},watch:{selectedCategory(e){this.$store.commit("results/changeSelectedCategory",e),this.$store.commit("results/updateSelectedFeature")}},created(){this.changeLayer(this.selectedLayer)},beforeDestroy(){this.$store.commit("results/unload")},methods:{applySettings(e){this.$store.commit("results/applySettings",e)},updateSelectedFilter(e){this.$store.commit("results/changeSelectedFilter",e),this.$store.commit("results/updateSelectedFeature")},changeLayer(e){switch(this.selectedLayer=e,e){case"links":this.$store.commit("results/loadLinks",{geojson:this.$store.getters.links,type:"LineString",selectedFeature:"headway"});break;case"rlinks":this.$store.commit("results/loadLinks",{geojson:this.$store.getters.rlinks,type:"LineString",selectedFeature:"speed"});break;case"nodes":this.$store.commit("results/loadLinks",{geojson:this.$store.getters.nodes,type:"Point",selectedFeature:"boardings"});break;case"rnodes":this.$store.commit("results/loadLinks",{geojson:this.$store.getters.rnodes,type:"Point",selectedFeature:"boardings"});break;case"od":this.$store.commit("results/loadLinks",{geojson:this.$store.getters["od/layer"],type:"LineString",selectedFeature:"volume"});break;default:this.$store.commit("results/loadLinks",{geojson:this.$store.getters[`${e}/layer`],type:this.$store.getters[`${e}/type`]})}this.selectedCategory=this.$store.getters["results/selectedCategory"]},featureClicked(e){if("featureClick"===e.action)this.form=e.feature,this.showDialog=!0;else if(this.$store.getters[`${this.selectedLayer}/hasOD`]){const t=this.displaySettings.selectedFeature;this.$store.commit(`${this.selectedLayer}/changeZone`,{index:e.feature.index,selectedProperty:t}),this.$store.commit("results/updateLinks",this.$store.getters[`${this.selectedLayer}/layer`])}}}};var R=s(64407),q={};q.styleTagTransform=v(),q.setAttributes=h(),q.insert=p().bind(null,"head"),q.domAPI=c(),q.insertStyleElement=u(),l()(R.Z,q),R.Z&&R.Z.locals&&R.Z.locals;const V=(0,f.Z)(D,i,[],!1,null,"cda74f8a",null).exports}}]);
//# sourceMappingURL=895.build.js.map